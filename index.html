<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TradeMind</title>
<meta name="description" content="TradeMind - Wolf Discipline System for Indian Traders">
<meta name="theme-color" content="#050a07">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="TradeMind">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet">
<script>
if (!window.TF_CONFIG) {
  window.TF_CONFIG = {
    SUPABASE_URL:  '',
    SUPABASE_ANON: '',
    RAZORPAY_KEY:  ''
  };
}
</script>
<script src="config.js" onerror="console.warn('config.js not found, using inline config')"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<style>
:root {
  --bg:        #050a07;
  --bg2:       #080e0a;
  --surface:   #0c1410;
  --surface2:  #101a14;
  --surface3:  #142019;
  --border:    rgba(0,255,100,.1);
  --border2:   rgba(0,255,100,.06);
  --g1:  #00e87a;
  --g2:  #00c463;
  --g3:  #009f50;
  --g4:  rgba(0,232,122,.07);
  --g5:  rgba(0,232,122,.13);
  --g6:  rgba(0,232,122,.04);
  --text:  #e8f5ee;
  --text2: #8abf9a;
  --muted: #3d6b50;
  --amber: #f5a623;
  --red:   #ff3b3b;
  --blood: #c0392b;
  --gold:  #ffd700;
  --blue:  #3d9bff;
  --purple:#9b59b6;
  --sh:  0 2px 20px rgba(0,0,0,.6);
  --sh2: 0 8px 40px rgba(0,0,0,.8);
  --sh3: 0 20px 80px rgba(0,0,0,.9);
  --wolf-glow: 0 0 40px rgba(0,232,122,.15);
  --fd: 'Bebas Neue', cursive;
  --fb: 'Inter', sans-serif;
  --fm: 'JetBrains Mono', monospace;
  --r1: 6px; --r2: 10px; --r3: 14px; --r4: 18px; --r5: 24px;
}
[data-theme="light"] {
  --bg:        #f0f7f2;
  --bg2:       #e8f2ec;
  --surface:   #ffffff;
  --surface2:  #f5fbf7;
  --surface3:  #eef8f2;
  --border:    rgba(0,140,60,.12);
  --border2:   rgba(0,140,60,.07);
  --g1:  #007a3d;
  --g2:  #006633;
  --g3:  #005228;
  --g4:  rgba(0,140,60,.08);
  --g5:  rgba(0,140,60,.14);
  --g6:  rgba(0,140,60,.04);
  --text:  #0d2a1a;
  --text2: #2d5c40;
  --muted: #6b9678;
  --sh:  0 2px 16px rgba(0,100,40,.08);
  --sh2: 0 6px 32px rgba(0,100,40,.14);
  --sh3: 0 16px 64px rgba(0,100,40,.18);
  --wolf-glow: 0 0 30px rgba(0,140,60,.12);
}

*,*::before,*::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--fb);
  font-size: 14px;
  line-height: 1.6;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  transition: background .3s, color .3s;
}
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
  opacity: .4;
}
::-webkit-scrollbar { width: 3px; }
::-webkit-scrollbar-thumb { background: var(--g1); border-radius: 99px; opacity: .4; }

.screen { display: none; position: relative; z-index: 1; }
.screen.active { display: flex; }

#s-loading {
  position: fixed; inset: 0; background: var(--bg); z-index: 9999;
  flex-direction: column; align-items: center; justify-content: center; gap: 0;
  overflow: hidden;
}
.load-bg-rings { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; }
.load-ring { position: absolute; border-radius: 50%; border: 1px solid transparent; animation: ringExpand 4s ease-out infinite; }
.load-ring:nth-child(1) { width: 200px; height: 200px; border-color: rgba(0,232,122,.3); animation-delay: 0s; }
.load-ring:nth-child(2) { width: 300px; height: 300px; border-color: rgba(0,232,122,.2); animation-delay: .5s; }
.load-ring:nth-child(3) { width: 400px; height: 400px; border-color: rgba(0,232,122,.12); animation-delay: 1s; }
.load-ring:nth-child(4) { width: 520px; height: 520px; border-color: rgba(0,232,122,.06); animation-delay: 1.5s; }
@keyframes ringExpand { 0%{transform:scale(.6);opacity:0;} 30%{opacity:1;} 100%{transform:scale(1.2);opacity:0;} }
.load-content { position: relative; z-index: 10; text-align: center; }
.load-wolf-wrap { position: relative; width: 120px; height: 120px; margin: 0 auto 24px; display: flex; align-items: center; justify-content: center; }
.load-wolf-glow { position: absolute; inset: -20px; border-radius: 50%; background: radial-gradient(circle, rgba(0,232,122,.25), transparent 70%); animation: glowBreathe 2s ease-in-out infinite; }
@keyframes glowBreathe { 0%,100%{transform:scale(1);opacity:.6;} 50%{transform:scale(1.3);opacity:1;} }
.load-wolf-emoji { font-size: 80px; position: relative; z-index: 2; animation: wolfHunt 3s ease-in-out infinite; filter: drop-shadow(0 0 20px rgba(0,232,122,.5)); }
@keyframes wolfHunt { 0%,100%{transform:translateY(0) scale(1);} 40%{transform:translateY(-8px) scale(1.05);} 60%{transform:translateY(-6px) scale(1.02);} }
.load-title { font-family: var(--fd); font-size: 52px; letter-spacing: 4px; color: var(--text); line-height: 1; margin-bottom: 4px; }
.load-title span { color: var(--g1); text-shadow: 0 0 30px rgba(0,232,122,.6); }
.load-tagline { font-size: 11px; letter-spacing: 4px; text-transform: uppercase; color: var(--muted); margin-bottom: 32px; font-family: var(--fm); }
.load-bar-bg { width: 220px; height: 2px; background: var(--border); border-radius: 99px; overflow: hidden; margin: 0 auto 12px; }
.load-bar { height: 100%; background: linear-gradient(90deg, var(--g2), var(--g1), rgba(0,232,122,.4)); border-radius: 99px; width: 0; transition: width .2s; box-shadow: 0 0 12px var(--g1); }
.load-status { font-size: 10px; color: var(--muted); font-family: var(--fm); letter-spacing: 1px; }

#s-reset { align-items: center; justify-content: center; min-height: 100vh; padding: 40px 20px; background: var(--bg); }
.reset-box { width: 100%; max-width: 420px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r5); overflow: hidden; box-shadow: var(--sh3); }
.reset-head { background: linear-gradient(135deg, var(--g3), var(--g2)); padding: 28px; text-align: center; color: #fff; }
.reset-head-wolf { font-size: 48px; display: block; margin-bottom: 8px; }
.reset-head-title { font-family: var(--fd); font-size: 28px; letter-spacing: 2px; }
.reset-head-sub { font-size: 13px; opacity: .85; margin-top: 4px; }
.reset-body { padding: 28px; }
.reset-msg { font-size: 13px; color: var(--text2); margin-bottom: 20px; line-height: 1.7; text-align: center; }
.reset-err { background: rgba(255,59,59,.08); border: 1px solid rgba(255,59,59,.2); border-radius: var(--r2); padding: 9px 12px; font-size: 12px; color: var(--red); display: none; margin-bottom: 12px; }
.reset-err.show { display: block; }
.reset-success { background: var(--g4); border: 1px solid rgba(0,232,122,.25); border-radius: var(--r2); padding: 12px; font-size: 13px; color: var(--g1); display: none; margin-bottom: 12px; text-align: center; }
.reset-success.show { display: block; }

#s-landing { flex-direction: column; min-height: 100vh; }
#s-landing::after { content: ''; position: fixed; top: 0; left: 50%; transform: translateX(-50%); width: 800px; height: 600px; background: radial-gradient(ellipse, rgba(0,232,122,.04), transparent 70%); pointer-events: none; z-index: 0; }

.lnav { display: flex; align-items: center; justify-content: space-between; padding: 14px 48px; position: sticky; top: 0; z-index: 100; background: rgba(5,10,7,.85); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border2); }
[data-theme="light"] .lnav { background: rgba(240,247,242,.9); }
.l-logo { display: flex; align-items: center; gap: 10px; cursor: pointer; text-decoration: none; }
.l-logo-ic { width: 32px; height: 32px; background: linear-gradient(135deg, var(--g1), var(--g3)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 15px; box-shadow: 0 0 20px rgba(0,232,122,.3); }
.l-logo-text { font-family: var(--fd); font-size: 22px; letter-spacing: 2px; color: var(--text); }
.l-logo-text em { color: var(--g1); font-style: normal; text-shadow: 0 0 20px rgba(0,232,122,.5); }
.lnav-links { display: flex; align-items: center; gap: 2px; }
.lnav-a { padding: 7px 14px; font-size: 13px; font-weight: 600; color: var(--text2); cursor: pointer; border-radius: var(--r2); transition: all .15s; border: none; background: none; font-family: var(--fb); }
.lnav-a:hover { color: var(--g1); background: var(--g4); }
.lnav-cta { padding: 8px 20px; background: var(--g1); color: #000; font-family: var(--fb); font-size: 13px; font-weight: 800; border: none; border-radius: var(--r2); cursor: pointer; transition: all .2s; letter-spacing: .5px; }
.lnav-cta:hover { transform: translateY(-1px); box-shadow: 0 4px 20px rgba(0,232,122,.4); }
.theme-btn { padding: 6px 10px; background: var(--g4); border: 1px solid var(--border); border-radius: var(--r2); cursor: pointer; font-size: 15px; transition: all .2s; }
.theme-btn:hover { background: var(--g5); }

.hero { padding: 100px 48px 80px; text-align: center; position: relative; overflow: hidden; z-index: 1; }
.hero-badge { display: inline-flex; align-items: center; gap: 7px; padding: 5px 16px; background: var(--g4); border: 1px solid rgba(0,232,122,.2); border-radius: 99px; font-size: 10px; font-weight: 800; color: var(--g1); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 28px; }
.hero-dot { width: 5px; height: 5px; background: var(--g1); border-radius: 50%; animation: blink 2s infinite; box-shadow: 0 0 8px var(--g1); }
@keyframes blink { 0%,100%{opacity:1;} 50%{opacity:.2;} }
.hero-h1 { font-family: var(--fd); font-size: clamp(52px, 7vw, 100px); color: var(--text); line-height: .95; letter-spacing: 2px; max-width: 900px; margin: 0 auto 20px; }
.hero-h1 .hl { color: var(--g1); text-shadow: 0 0 60px rgba(0,232,122,.4); }
.hero-h1 .dim { color: var(--muted); }
.hero-sub { font-size: 17px; color: var(--text2); max-width: 520px; margin: 0 auto 44px; line-height: 1.75; font-weight: 500; }
.hero-btns { display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 60px; flex-wrap: wrap; }
.hbtn-p { padding: 16px 40px; background: var(--g1); color: #000; font-family: var(--fb); font-size: 15px; font-weight: 900; border: none; border-radius: var(--r3); cursor: pointer; letter-spacing: .5px; box-shadow: 0 4px 30px rgba(0,232,122,.4); transition: all .2s; }
.hbtn-p:hover { transform: translateY(-3px); box-shadow: 0 8px 50px rgba(0,232,122,.6); }
.hbtn-s { padding: 15px 28px; background: transparent; color: var(--text); font-family: var(--fb); font-size: 15px; font-weight: 600; border: 1px solid var(--border); border-radius: var(--r3); cursor: pointer; transition: all .2s; }
.hbtn-s:hover { border-color: var(--g1); color: var(--g1); }
.hero-stats { display: flex; align-items: center; justify-content: center; gap: 40px; padding: 20px 40px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); max-width: 500px; margin: 0 auto; box-shadow: var(--sh); }
.hs-item { text-align: center; }
.hs-val { font-family: var(--fd); font-size: 28px; letter-spacing: 1px; color: var(--g1); text-shadow: 0 0 20px rgba(0,232,122,.4); }
.hs-lbl { font-size: 10px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }
.hs-div { width: 1px; height: 28px; background: var(--border); }

.wolf-sec { padding: 80px 48px; text-align: center; background: var(--bg2); position: relative; z-index: 1; }
.wolf-sec::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--g1), transparent); opacity: .3; }
.sec-eyebrow { font-size: 10px; font-weight: 800; color: var(--g1); letter-spacing: 3px; text-transform: uppercase; margin-bottom: 10px; }
.sec-h2 { font-family: var(--fd); font-size: clamp(36px, 4vw, 64px); color: var(--text); letter-spacing: 2px; margin-bottom: 10px; line-height: 1; }
.sec-sub { font-size: 16px; color: var(--text2); max-width: 500px; margin: 0 auto 48px; line-height: 1.75; }

.wolf-visual { position: relative; height: 300px; display: flex; align-items: center; justify-content: center; margin-bottom: 48px; }
.wolf-ring { position: absolute; border: 1px solid rgba(0,232,122,.15); border-radius: 50%; }
.wolf-ring-1 { width: 280px; height: 280px; animation: ringRot 12s linear infinite; border-style: dashed; }
.wolf-ring-2 { width: 210px; height: 210px; border-color: rgba(0,232,122,.09); animation: ringRot 8s linear infinite reverse; }
.wolf-ring-3 { width: 150px; height: 150px; border-color: rgba(0,232,122,.06); animation: ringRot 5s linear infinite; }
@keyframes ringRot { to { transform: rotate(360deg); } }
.wolf-center-emoji { font-size: 100px; filter: drop-shadow(0 0 30px rgba(0,232,122,.5)); animation: wolfFloat 3s ease-in-out infinite; z-index: 5; position: relative; }
@keyframes wolfFloat { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-14px);} }
.wolf-glow { position: absolute; width: 180px; height: 180px; background: radial-gradient(circle, rgba(0,232,122,.18), transparent 70%); border-radius: 50%; animation: glowPulse 2.5s ease-in-out infinite; }
@keyframes glowPulse { 0%,100%{transform:scale(1);opacity:.5;} 50%{transform:scale(1.4);opacity:1;} }

.wolf-stages { display: flex; align-items: center; justify-content: center; gap: 6px; flex-wrap: wrap; }
.wolf-stage-card { display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 18px 24px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r3); min-width: 110px; transition: all .2s; cursor: default; position: relative; box-shadow: var(--sh); }
.wolf-stage-card:hover { border-color: var(--g1); transform: translateY(-5px); box-shadow: var(--wolf-glow); }
.wsc-emoji { font-size: 36px; }
.wsc-name { font-family: var(--fd); font-size: 14px; letter-spacing: 1px; color: var(--text2); }
.wsc-range { font-size: 10px; color: var(--muted); font-family: var(--fm); }
.wsc-arrow { color: var(--muted); font-size: 20px; }
.legend-badge { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, var(--amber), #e8890a); color: #000; font-size: 9px; font-weight: 900; padding: 2px 10px; border-radius: 99px; white-space: nowrap; letter-spacing: 1px; }
.legend-card { border-color: rgba(255,215,0,.3) !important; animation: legendGlow 2s ease-in-out infinite; }
@keyframes legendGlow { 0%,100%{box-shadow:var(--sh);} 50%{box-shadow:0 0 30px rgba(255,215,0,.15);} }

.feats-sec { padding: 80px 48px; position: relative; z-index: 1; }
.feats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; margin-top: 40px; }
.feat-card { padding: 26px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); transition: all .2s; box-shadow: var(--sh); position: relative; overflow: hidden; }
.feat-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, var(--g1), transparent); opacity: 0; transition: opacity .2s; }
.feat-card:hover { border-color: var(--g1); transform: translateY(-4px); box-shadow: var(--wolf-glow); }
.feat-card:hover::before { opacity: 1; }
.feat-ic { font-size: 32px; margin-bottom: 14px; }
.feat-h { font-family: var(--fd); font-size: 20px; letter-spacing: 1px; color: var(--text); margin-bottom: 8px; }
.feat-p { font-size: 13px; color: var(--text2); line-height: 1.7; }

.ad-banner { margin: 0 48px; padding: 16px 24px; background: var(--g4); border: 1px solid rgba(0,232,122,.2); border-radius: var(--r3); display: flex; align-items: center; justify-content: space-between; position: relative; z-index: 1; }
.ad-label { font-size: 9px; font-weight: 800; color: var(--muted); letter-spacing: 1px; text-transform: uppercase; border: 1px solid var(--border); padding: 2px 6px; border-radius: 4px; }

/* ══ PRICING ══ */
.pricing-sec { padding: 80px 48px; position: relative; z-index: 1; }
.price-cards { display: flex; gap: 20px; justify-content: center; margin-top: 40px; flex-wrap: wrap; }
.price-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r5); padding: 32px; width: 280px; position: relative; transition: all .2s; box-shadow: var(--sh); }
.price-card:hover { border-color: var(--g1); box-shadow: var(--wolf-glow); }
.price-card.featured { border-color: var(--g1); background: linear-gradient(160deg, var(--surface), var(--g6)); box-shadow: var(--wolf-glow); }
.price-card.wolf199 { border-color: rgba(61,155,255,.25); background: linear-gradient(160deg, var(--surface), rgba(61,155,255,.04)); }
.price-card.wolf199:hover { border-color: var(--blue); box-shadow: 0 0 40px rgba(61,155,255,.15); }
.price-tag { font-size: 11px; font-weight: 800; color: var(--muted); letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 12px; }
.price-featured-badge { position: absolute; top: -12px; right: 20px; background: var(--g1); color: #000; font-size: 10px; font-weight: 900; padding: 3px 12px; border-radius: 99px; letter-spacing: 1px; }
.price-popular-badge { position: absolute; top: -12px; right: 20px; background: var(--blue); color: #fff; font-size: 10px; font-weight: 900; padding: 3px 12px; border-radius: 99px; letter-spacing: 1px; }
.price-offer-strip { background: var(--g4); border: 1px solid rgba(0,232,122,.2); border-radius: var(--r2); padding: 6px 12px; font-size: 12px; font-weight: 700; color: var(--g1); margin-bottom: 16px; }
.price-num { font-family: var(--fd); font-size: 72px; letter-spacing: -2px; line-height: 1; color: var(--text); }
.price-num sub { font-size: 28px; vertical-align: top; margin-top: 12px; display: inline-block; }
.price-period { font-size: 13px; color: var(--muted); margin-bottom: 4px; }
.price-then { font-size: 12px; color: var(--text2); margin-bottom: 20px; }
.pf-list { margin-bottom: 24px; }
.pf-row { display: flex; gap: 8px; font-size: 13px; color: var(--text2); padding: 6px 0; border-bottom: 1px solid var(--border2); }
.pf-row:last-child { border: none; }
.pf-ck { color: var(--g1); font-weight: 800; flex-shrink: 0; }
.price-btn { width: 100%; padding: 12px; border: none; border-radius: var(--r3); font-family: var(--fb); font-size: 14px; font-weight: 800; cursor: pointer; transition: all .2s; letter-spacing: .5px; }
.price-btn-p { background: var(--g1); color: #000; box-shadow: 0 4px 20px rgba(0,232,122,.3); }
.price-btn-p:hover { transform: translateY(-2px); box-shadow: 0 8px 40px rgba(0,232,122,.5); }
.price-btn-s { background: var(--g4); color: var(--g1); border: 1px solid rgba(0,232,122,.3); }
.price-btn-s:hover { background: var(--g5); }
.price-btn-b { background: rgba(61,155,255,.12); color: var(--blue); border: 1px solid rgba(61,155,255,.35); }
.price-btn-b:hover { background: rgba(61,155,255,.2); transform: translateY(-2px); }

.testi-sec { padding: 80px 48px; background: var(--bg2); position: relative; z-index: 1; }
.testi-sec::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--g1), transparent); opacity: .2; }
.testis { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 40px; }
.testi-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); padding: 24px; box-shadow: var(--sh); }
.testi-stars { color: var(--amber); font-size: 14px; margin-bottom: 12px; letter-spacing: 2px; }
.testi-text { font-size: 13px; color: var(--text2); line-height: 1.75; margin-bottom: 16px; font-style: italic; }
.testi-auth { display: flex; align-items: center; gap: 10px; }
.testi-av { width: 32px; height: 32px; background: var(--g1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 900; color: #000; font-size: 13px; flex-shrink: 0; }
.testi-name { font-weight: 700; font-size: 13px; color: var(--text); }
.testi-role { font-size: 11px; color: var(--muted); }

.auth-sec { padding: 80px 48px; position: relative; z-index: 1; }
.auth-inner { display: grid; grid-template-columns: 1fr 1fr; gap: 48px; max-width: 860px; margin: 0 auto; align-items: center; }
.auth-list { margin-top: 20px; }
.auth-list-item { display: flex; align-items: center; gap: 10px; padding: 8px 0; font-size: 14px; color: var(--text2); border-bottom: 1px solid var(--border2); }
.auth-list-ck { color: var(--g1); font-weight: 900; font-size: 16px; flex-shrink: 0; }
.auth-box { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r5); overflow: hidden; box-shadow: var(--sh3); }
.auth-tabs { display: flex; border-bottom: 1px solid var(--border); }
.auth-tab { flex: 1; padding: 14px; text-align: center; font-size: 13px; font-weight: 700; color: var(--muted); cursor: pointer; transition: all .15s; }
.auth-tab.active { color: var(--g1); border-bottom: 2px solid var(--g1); background: var(--g4); }
.auth-form { padding: 24px; }
.auth-form.hidden { display: none; }
.fg { margin-bottom: 14px; }
.fg label { font-size: 10px; font-weight: 800; color: var(--muted); letter-spacing: 1px; text-transform: uppercase; display: block; margin-bottom: 6px; }
.iw { position: relative; }
.ic { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); font-size: 14px; }
.fi { width: 100%; background: var(--bg2); border: 1px solid var(--border); color: var(--text); padding: 10px 12px 10px 38px; border-radius: var(--r2); font-family: var(--fb); font-size: 13px; outline: none; transition: all .18s; }
.fi:focus { border-color: var(--g1); background: var(--surface); box-shadow: 0 0 0 3px rgba(0,232,122,.1); }
.auth-btn { width: 100%; padding: 13px; background: var(--g1); color: #000; font-family: var(--fb); font-size: 14px; font-weight: 900; border: none; border-radius: var(--r3); cursor: pointer; transition: all .2s; letter-spacing: .5px; margin-top: 6px; }
.auth-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(0,232,122,.4); }
.auth-btn:disabled { opacity: .5; cursor: not-allowed; transform: none; box-shadow: none; }
.auth-demo { text-align: center; font-size: 11px; color: var(--muted); margin-top: 10px; font-family: var(--fm); }
.err-msg { font-size: 12px; padding: 9px 12px; border-radius: var(--r2); background: rgba(255,59,59,.08); border: 1px solid rgba(255,59,59,.2); color: var(--red); display: none; margin: 0 24px 0; }
.err-msg.show { display: block; margin-bottom: 0; }

.lfoot { padding: 32px 48px; display: flex; align-items: center; justify-content: space-between; border-top: 1px solid var(--border2); position: relative; z-index: 1; }
.lfoot-brand { font-family: var(--fd); font-size: 22px; letter-spacing: 2px; }
.lfoot-brand em { color: var(--g1); font-style: normal; }

/* ══ SUBSCRIPTION ══ */
#s-sub { align-items: center; justify-content: center; min-height: 100vh; background: var(--bg); padding: 40px 20px; }
.sub-box { width: 100%; max-width: 520px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r5); overflow: hidden; box-shadow: var(--sh3); }
.sub-head { background: linear-gradient(135deg, #001a0a, #002d12); padding: 32px; text-align: center; position: relative; overflow: hidden; }
.sub-head::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 50% 0%, rgba(0,232,122,.15), transparent 70%); }
.sub-head-wolf { font-size: 60px; display: block; position: relative; z-index: 1; filter: drop-shadow(0 0 20px rgba(0,232,122,.6)); animation: wolfFloat 3s ease-in-out infinite; }
.sub-head-title { font-family: var(--fd); font-size: 32px; letter-spacing: 2px; color: #fff; position: relative; z-index: 1; }
.sub-head-sub { font-size: 13px; color: var(--text2); position: relative; z-index: 1; margin-top: 4px; }
.sub-body { padding: 24px; }
.offer-banner { text-align: center; padding: 16px; background: var(--g4); border: 1px solid rgba(0,232,122,.2); border-radius: var(--r3); margin-bottom: 20px; }
.offer-big { font-family: var(--fd); font-size: 48px; letter-spacing: 2px; color: var(--g1); line-height: 1; text-shadow: 0 0 20px rgba(0,232,122,.4); }
.offer-big span { font-size: 18px; color: var(--muted); }
.offer-note { font-size: 13px; color: var(--text2); margin-top: 6px; display: flex; gap: 8px; align-items: center; justify-content: center; flex-wrap: wrap; }
.offer-strike { text-decoration: line-through; color: var(--muted); }
.offer-save { background: var(--amber); color: #000; padding: 1px 8px; border-radius: 99px; font-weight: 900; font-size: 11px; }
.pay-methods-title { font-size: 10px; font-weight: 800; color: var(--muted); letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 10px; }
.pay-method { border: 1px solid var(--border); border-radius: var(--r3); margin-bottom: 8px; cursor: pointer; overflow: hidden; transition: all .18s; }
.pay-method:hover { border-color: rgba(0,232,122,.3); }
.pay-method.selected { border-color: var(--g1); background: var(--g6); }
.pay-method.selected.method-199 { border-color: var(--blue); background: rgba(61,155,255,.04); }
.pay-method-header { display: flex; align-items: center; gap: 12px; padding: 14px 16px; }
.pay-method-icon { font-size: 22px; }
.pay-method-name { font-weight: 700; font-size: 13px; color: var(--text); }
.pay-method-sub { font-size: 11px; color: var(--muted); }
.pay-detail { padding: 0 16px 16px; display: none; }
.pay-method.selected .pay-detail { display: block; }
.wa-number-box { background: var(--bg2); border: 1px solid var(--border); border-radius: var(--r2); padding: 10px 14px; margin-bottom: 10px; }
.wa-number { font-family: var(--fm); font-size: 18px; font-weight: 700; color: var(--text); }
.wa-btn { display: block; width: 100%; text-align: center; background: #25d366; color: #fff; padding: 10px; border-radius: var(--r2); font-weight: 800; font-size: 13px; text-decoration: none; margin-bottom: 8px; transition: all .2s; }
.wa-btn:hover { opacity: .85; }
.wa-btn-blue { background: var(--blue) !important; }
.upi-paid-btn { width: 100%; padding: 10px; background: var(--g4); color: var(--g1); border: 1px solid rgba(0,232,122,.3); border-radius: var(--r2); font-family: var(--fb); font-weight: 700; font-size: 12px; cursor: pointer; transition: all .15s; }
.upi-paid-btn:hover { background: var(--g5); }
.upi-number-box { background: var(--bg2); border: 1px solid var(--border); border-radius: var(--r2); padding: 10px 14px; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; }
.upi-number { font-family: var(--fm); font-size: 14px; font-weight: 700; color: var(--text); }
.copy-btn { background: var(--g4); color: var(--g1); border: 1px solid rgba(0,232,122,.3); padding: 4px 10px; border-radius: var(--r1); font-size: 11px; font-weight: 700; cursor: pointer; }
.upi-apps { display: flex; gap: 8px; margin: 8px 0; flex-wrap: wrap; }
.upi-app { display: flex; align-items: center; gap: 5px; padding: 5px 10px; background: var(--bg2); border: 1px solid var(--border2); border-radius: var(--r2); font-size: 11px; font-weight: 600; color: var(--text2); }
.upi-app-ic { font-size: 14px; }
.pay-row { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.pay-input { width: 100%; background: var(--bg2); border: 1px solid var(--border); color: var(--text); padding: 9px 12px; border-radius: var(--r2); font-family: var(--fm); font-size: 13px; outline: none; margin-bottom: 8px; }
.pay-activate-btn { width: 100%; padding: 11px; background: var(--g1); color: #000; border: none; border-radius: var(--r2); font-family: var(--fb); font-weight: 900; font-size: 13px; cursor: pointer; }
.sub-secure { text-align: center; font-size: 11px; color: var(--muted); margin-top: 12px; }
.sub-back { text-align: center; margin-top: 8px; }
.sub-back button { background: none; border: none; color: var(--muted); font-size: 12px; cursor: pointer; font-family: var(--fb); }
.sub-back button:hover { color: var(--text2); }

/* PLAN COMPARISON TABLE IN SUB */
.plan-compare { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 6px; margin-bottom: 16px; }
.plan-col { padding: 10px 8px; border-radius: var(--r2); border: 1px solid var(--border); text-align: center; }
.plan-col.highlight { border-color: rgba(61,155,255,.4); background: rgba(61,155,255,.06); }
.plan-col-name { font-size: 10px; font-weight: 900; color: var(--muted); letter-spacing: 1px; text-transform: uppercase; margin-bottom: 4px; }
.plan-col-price { font-family: var(--fd); font-size: 24px; line-height: 1; }

/* ══ APP ══ */
#s-app { min-height: 100vh; background: var(--bg); }
.app-layout { display: flex; height: 100vh; position: relative; }
.sidebar { width: 220px; min-width: 220px; background: var(--bg2); border-right: 1px solid var(--border2); display: flex; flex-direction: column; padding: 0; position: sticky; top: 0; height: 100vh; overflow-y: auto; }
.sb-brand { padding: 20px 18px 16px; border-bottom: 1px solid var(--border2); display: flex; align-items: center; gap: 10px; }
.sb-brand-ic { width: 30px; height: 30px; background: linear-gradient(135deg, var(--g1), var(--g3)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; box-shadow: 0 0 16px rgba(0,232,122,.3); flex-shrink: 0; }
.sb-brand-text { font-family: var(--fd); font-size: 19px; letter-spacing: 2px; }
.sb-brand-text em { color: var(--g1); font-style: normal; }
.sb-wolf { padding: 14px 16px; background: var(--g6); border-bottom: 1px solid var(--border2); cursor: pointer; transition: background .15s; }
.sb-wolf:hover { background: var(--g4); }
.sb-wolf-top { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
.sb-wolf-emoji { font-size: 22px; filter: drop-shadow(0 0 6px rgba(0,232,122,.4)); }
.sb-wolf-info { flex: 1; min-width: 0; }
.sb-wolf-rank { font-size: 8px; font-weight: 900; color: var(--g1); letter-spacing: 2px; text-transform: uppercase; }
.sb-wolf-name { font-family: var(--fd); font-size: 15px; letter-spacing: 1px; color: var(--text); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.sb-wolf-bar-bg { height: 3px; background: var(--border); border-radius: 99px; overflow: hidden; }
.sb-wolf-bar { height: 100%; background: linear-gradient(90deg, var(--g2), var(--g1)); border-radius: 99px; transition: width 1s cubic-bezier(.4,0,.2,1); box-shadow: 0 0 8px var(--g1); }
.sb-wolf-pct { font-size: 9px; color: var(--muted); font-family: var(--fm); margin-top: 3px; }
.sb-nav { flex: 1; padding: 8px 0; }
.sb-section { font-size: 8px; font-weight: 900; color: var(--muted); letter-spacing: 2px; text-transform: uppercase; padding: 10px 16px 4px; }
.sb-item { display: flex; align-items: center; gap: 10px; padding: 9px 16px; font-size: 13px; font-weight: 600; color: var(--text2); cursor: pointer; border-radius: 0; transition: all .15s; border-left: 2px solid transparent; margin: 1px 0; }
.sb-item:hover { color: var(--text); background: var(--g4); border-left-color: rgba(0,232,122,.3); }
.sb-item.active { color: var(--g1); background: var(--g4); border-left-color: var(--g1); font-weight: 700; }
.sb-item-ic { width: 18px; text-align: center; font-size: 14px; }
.sb-foot { border-top: 1px solid var(--border2); padding: 10px 12px; position: relative; }
.sb-foot-user { display: flex; align-items: center; gap: 8px; padding: 8px; border-radius: var(--r2); cursor: pointer; transition: background .15s; }
.sb-foot-user:hover { background: var(--g4); }
.sb-avatar { width: 30px; height: 30px; background: var(--g1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 900; color: #000; font-size: 12px; flex-shrink: 0; }
.sb-foot-info { flex: 1; min-width: 0; }
.sb-foot-name { font-size: 12px; font-weight: 700; color: var(--text); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.sb-foot-status { font-size: 10px; color: var(--g1); }
.sb-foot-toggle { font-size: 16px; }
.sb-dropdown { position: absolute; bottom: 100%; left: 10px; right: 10px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r3); padding: 6px; box-shadow: var(--sh3); display: none; z-index: 100; }
.sb-dropdown.open { display: block; }
.sb-dd-user { padding: 8px 10px 12px; border-bottom: 1px solid var(--border2); margin-bottom: 4px; }
.sb-dd-name { font-weight: 700; font-size: 13px; color: var(--text); }
.sb-dd-email { font-size: 11px; color: var(--muted); }
.sb-dd-item { display: flex; align-items: center; gap: 8px; padding: 8px 10px; font-size: 13px; color: var(--text2); cursor: pointer; border-radius: var(--r2); transition: background .13s; }
.sb-dd-item:hover { background: var(--g4); color: var(--text); }
.topbar { height: 54px; background: var(--bg2); border-bottom: 1px solid var(--border2); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; position: sticky; top: 0; z-index: 50; flex-shrink: 0; }
.tb-left { display: flex; flex-direction: column; }
.tb-title { font-family: var(--fd); font-size: 20px; letter-spacing: 1px; color: var(--text); line-height: 1.1; }
.tb-sub { font-size: 11px; color: var(--muted); }
.tb-actions { display: flex; align-items: center; gap: 8px; }
.tb-theme-btn { padding: 6px 10px; background: var(--g4); border: 1px solid var(--border); border-radius: var(--r2); cursor: pointer; font-size: 14px; transition: all .2s; }
.tb-log-btn { padding: 7px 16px; background: var(--g1); color: #000; border: none; border-radius: var(--r2); font-family: var(--fb); font-size: 12px; font-weight: 900; cursor: pointer; transition: all .2s; letter-spacing: .5px; }
.tb-log-btn:hover { transform: translateY(-1px); box-shadow: 0 3px 14px rgba(0,232,122,.4); }
.main-content { flex: 1; overflow-y: auto; padding: 20px; }
.main-wrap { display: flex; flex-direction: column; height: 100vh; flex: 1; overflow: hidden; }
.page { display: none; }
.page.active { display: block; }

.btn { display: inline-flex; align-items: center; gap: 5px; padding: 7px 14px; font-family: var(--fb); font-size: 12px; font-weight: 700; border-radius: var(--r2); border: none; cursor: pointer; transition: all .15s; }
.btn-p { background: var(--g1); color: #000; }
.btn-p:hover { transform: translateY(-1px); box-shadow: 0 3px 14px rgba(0,232,122,.3); }
.btn-s { background: var(--g4); color: var(--g1); border: 1px solid rgba(0,232,122,.2); }
.btn-s:hover { background: var(--g5); }
.btn-red { background: rgba(255,59,59,.08); color: var(--red); border: 1px solid rgba(255,59,59,.2); }
.btn-red:hover { background: rgba(255,59,59,.14); }
.btn-sm { padding: 4px 9px; font-size: 11px; }
.card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); padding: 16px 18px; box-shadow: var(--sh); }
.card-title { font-family: var(--fd); font-size: 16px; letter-spacing: .5px; color: var(--text); margin-bottom: 14px; display: flex; align-items: center; justify-content: space-between; }
.ctag { font-family: var(--fm); font-size: 10px; color: var(--muted); background: var(--bg2); padding: 2px 7px; border-radius: 99px; border: 1px solid var(--border2); }
.stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 14px; }
.stat-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); padding: 14px 16px; position: relative; overflow: hidden; transition: all .2s; box-shadow: var(--sh); }
.stat-card:hover { transform: translateY(-2px); box-shadow: var(--sh2); }
.stat-top { position: absolute; top: 0; left: 0; right: 0; height: 2px; }
.stat-ic { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; margin-bottom: 10px; background: var(--g4); }
.stat-lbl { font-size: 9px; font-weight: 800; color: var(--muted); letter-spacing: 1px; text-transform: uppercase; margin-bottom: 4px; }
.stat-val { font-family: var(--fd); font-size: 28px; letter-spacing: -1px; line-height: 1; margin-bottom: 3px; color: var(--text); }
.stat-sub { font-size: 10px; color: var(--muted); }
.g2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px; }
.g31 { display: grid; grid-template-columns: 3fr 1.3fr; gap: 12px; margin-bottom: 12px; }
.tw { overflow-x: auto; border-radius: var(--r3); border: 1px solid var(--border); background: var(--surface); }
table { width: 100%; border-collapse: collapse; }
thead tr { border-bottom: 2px solid var(--border); background: var(--bg2); }
th { text-align: left; padding: 8px 11px; font-size: 9px; font-weight: 900; color: var(--muted); letter-spacing: 1.2px; text-transform: uppercase; white-space: nowrap; }
tbody tr { border-bottom: 1px solid var(--border2); transition: .12s; }
tbody tr:last-child { border: none; }
tbody tr:hover { background: var(--g6); }
td { padding: 9px 11px; font-size: 12px; color: var(--text2); }
td.bold { color: var(--text); font-weight: 700; }
.badge { display: inline-flex; align-items: center; padding: 2px 8px; border-radius: 99px; font-size: 9px; font-weight: 900; letter-spacing: .5px; }
.badge-g { background: rgba(0,232,122,.1); color: var(--g1); border: 1px solid rgba(0,232,122,.2); }
.badge-r { background: rgba(255,59,59,.1); color: var(--red); border: 1px solid rgba(255,59,59,.2); }
.badge-a { background: rgba(245,166,35,.1); color: var(--amber); border: 1px solid rgba(245,166,35,.2); }
.badge-b { background: rgba(61,155,255,.1); color: var(--blue); border: 1px solid rgba(61,155,255,.2); }
.modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.65); z-index: 1000; display: none; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(6px); }
.modal-overlay.open { display: flex; }
.modal { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r5); max-height: 90vh; overflow-y: auto; box-shadow: var(--sh3); width: 100%; }
.modal-sm { max-width: 420px; }
.modal-md { max-width: 560px; }
.modal-lg { max-width: 740px; }
.modal-hd { display: flex; align-items: center; justify-content: space-between; padding: 18px 22px 0; }
.modal-title { font-family: var(--fd); font-size: 22px; letter-spacing: 1px; color: var(--text); }
.close-btn { width: 28px; height: 28px; background: var(--bg2); border: 1px solid var(--border); border-radius: 6px; color: var(--muted); font-size: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all .14s; }
.close-btn:hover { background: rgba(255,59,59,.1); color: var(--red); }
.modal-body { padding: 16px 22px; }
.modal-ft { display: flex; gap: 8px; justify-content: flex-end; padding: 12px 22px 16px; border-top: 1px solid var(--border2); }
.tab-bar { display: flex; gap: 2px; background: var(--bg2); padding: 3px; border-radius: var(--r2); width: fit-content; margin-bottom: 14px; border: 1px solid var(--border2); }
.tab { padding: 6px 14px; font-size: 12px; font-weight: 700; color: var(--muted); cursor: pointer; border-radius: 7px; transition: all .14s; }
.tab.active { background: var(--surface); color: var(--g1); box-shadow: var(--sh); }
.fr { display: grid; gap: 10px; margin-bottom: 10px; }
.fr.c2 { grid-template-columns: 1fr 1fr; }
.fr.c3 { grid-template-columns: 1fr 1fr 1fr; }
.fr.c4 { grid-template-columns: 1fr 1fr 1fr 1fr; }
.fgi { display: flex; flex-direction: column; gap: 5px; }
label { font-size: 10px; font-weight: 800; color: var(--muted); letter-spacing: .6px; text-transform: uppercase; }
input[type=text],input[type=number],input[type=date],input[type=email],input[type=password],select,textarea { background: var(--bg2); border: 1px solid var(--border); color: var(--text); padding: 9px 12px; border-radius: var(--r2); font-family: var(--fb); font-size: 13px; outline: none; transition: all .18s; width: 100%; }
input:focus,select:focus,textarea:focus { border-color: var(--g1); background: var(--surface); box-shadow: 0 0 0 3px rgba(0,232,122,.1); }
select option { background: var(--surface); }
textarea { resize: vertical; min-height: 80px; font-family: var(--fb); }
.req-star { color: var(--red); }
.field-error { border-color: var(--red) !important; }
.field-err-msg { font-size: 11px; color: var(--red); margin-top: 3px; display: none; }
.field-err-msg.show { display: block; }
.checklist { display: flex; flex-direction: column; gap: 5px; }
.chk-item { display: flex; align-items: center; gap: 10px; padding: 9px 12px; background: var(--bg2); border: 1px solid var(--border2); border-radius: var(--r2); cursor: pointer; transition: all .12s; font-size: 13px; color: var(--text2); }
.chk-item:hover { border-color: rgba(0,232,122,.3); background: var(--g4); }
.chk-item.checked { border-color: rgba(0,232,122,.5); background: var(--g4); color: var(--text); }
.chk-box { width: 18px; height: 18px; border: 2px solid var(--border); border-radius: 4px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 10px; background: var(--surface); transition: all .12s; }
.chk-item.checked .chk-box { background: var(--g1); border-color: var(--g1); color: #000; }
.chk-cat { margin-left: auto; font-size: 9px; font-weight: 900; padding: 1px 7px; border-radius: 99px; background: var(--g4); color: var(--g1); flex-shrink: 0; letter-spacing: .5px; }
.psych-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 14px; }
.psych-hd { display: flex; justify-content: space-between; margin-bottom: 6px; }
.psych-lbl { font-size: 13px; font-weight: 600; color: var(--text2); }
.psych-sc { font-family: var(--fd); font-size: 22px; color: var(--g1); }
input[type=range] { -webkit-appearance: none; appearance: none; height: 4px; border-radius: 99px; background: var(--g4); border: none; cursor: pointer; padding: 0; width: 100%; }
input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; border-radius: 50%; background: var(--g1); border: 2px solid var(--surface); box-shadow: 0 0 8px rgba(0,232,122,.4); cursor: pointer; }
.emo-row { display: flex; gap: 6px; flex-wrap: wrap; }
.emo-chip { padding: 5px 12px; border-radius: 99px; font-size: 11px; font-weight: 700; border: 1px solid var(--border); cursor: pointer; transition: all .12s; color: var(--muted); background: var(--bg2); }
.emo-chip:hover { border-color: rgba(0,232,122,.3); }
.emo-chip.sp.selected { background: rgba(0,232,122,.1); color: var(--g1); border-color: rgba(0,232,122,.4); }
.emo-chip.sn.selected { background: rgba(255,59,59,.08); color: var(--red); border-color: rgba(255,59,59,.3); }
.emo-chip.su.selected { background: rgba(245,166,35,.08); color: var(--amber); border-color: rgba(245,166,35,.3); }
.prog-list { display: flex; flex-direction: column; gap: 10px; }
.prog-hd { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px; }
.prog-track { height: 4px; background: var(--bg2); border-radius: 99px; overflow: hidden; }
.prog-fill { height: 100%; border-radius: 99px; transition: width .6s cubic-bezier(.4,0,.2,1); }
.hm-grid { display: grid; grid-template-columns: repeat(7,1fr); gap: 3px; }
.hm-c { aspect-ratio: 1; border-radius: 2px; background: var(--bg2); border: 1px solid var(--border2); cursor: pointer; transition: transform .1s; }
.hm-c:hover { transform: scale(1.5); z-index: 5; }
.hm-c.l1 { background: rgba(0,232,122,.2); } .hm-c.l2 { background: rgba(0,232,122,.4); } .hm-c.l3 { background: rgba(0,232,122,.6); } .hm-c.l4 { background: rgba(0,232,122,.85); box-shadow: 0 0 6px rgba(0,232,122,.4); }
.hm-c.n1 { background: rgba(255,59,59,.25); } .hm-c.n2 { background: rgba(255,59,59,.5); }

/* JOURNAL */
.journal-hero { display: flex; align-items: center; justify-content: space-between; background: linear-gradient(135deg, #020d05 0%, #041a0c 60%, #020d05 100%); border: 1px solid rgba(0,232,122,.2); border-radius: var(--r5); padding: 16px 20px; margin-bottom: 14px; position: relative; overflow: hidden; }
.journal-hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--g1), transparent); }
.journal-hero-left { display: flex; align-items: center; gap: 20px; }
.journal-streak-badge { display: flex; align-items: center; gap: 6px; background: rgba(245,166,35,.1); border: 1px solid rgba(245,166,35,.25); border-radius: var(--r2); padding: 8px 14px; }
.journal-streak-fire { font-size: 20px; animation: flameDance 1.5s ease-in-out infinite; }
@keyframes flameDance { 0%,100%{transform:scaleY(1);} 50%{transform:scaleY(1.1);} }
.journal-hero-stats { display: flex; align-items: center; gap: 16px; }
.jhs-item { text-align: center; }
.jhs-val { font-family: var(--fd); font-size: 22px; color: var(--g1); line-height: 1; }
.jhs-lbl { font-size: 9px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; }
.jhs-div { width: 1px; height: 24px; background: var(--border); }
.journal-hero-actions { display: flex; gap: 8px; }
.journal-controls { display: flex; align-items: center; gap: 10px; margin-bottom: 14px; flex-wrap: wrap; }
.journal-search-wrap { display: flex; align-items: center; gap: 8px; flex: 1; min-width: 180px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r2); padding: 7px 12px; }
.journal-mood-filter { display: flex; gap: 5px; flex-wrap: wrap; }
.jmood-btn { padding: 5px 10px; font-size: 11px; font-weight: 700; border: 1px solid var(--border); border-radius: 99px; cursor: pointer; background: var(--surface); color: var(--muted); transition: all .14s; font-family: var(--fb); }
.jmood-btn:hover { border-color: rgba(0,232,122,.3); color: var(--text); }
.jmood-btn.active { background: var(--g4); color: var(--g1); border-color: rgba(0,232,122,.3); }
.journal-view-toggle { display: flex; gap: 3px; }
.jview-btn { width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r2); cursor: pointer; font-size: 16px; transition: all .14s; color: var(--muted); font-family: var(--fb); }
.jview-btn.active { background: var(--g4); color: var(--g1); border-color: rgba(0,232,122,.3); }
.jcal-days-header { display: grid; grid-template-columns: repeat(7,1fr); gap: 3px; margin-bottom: 5px; }
.jcal-days-header span { font-size: 9px; font-weight: 800; color: var(--muted); text-align: center; text-transform: uppercase; letter-spacing: .5px; }
.jcal-grid { display: grid; grid-template-columns: repeat(7,1fr); gap: 3px; }
.jcal-cell { aspect-ratio: 1; border-radius: 3px; background: var(--surface3); border: 1px solid var(--border2); cursor: default; transition: all .12s; position: relative; }
.jcal-cell.clickable { cursor: pointer; }
.jcal-cell.clickable:hover { transform: scale(1.4); z-index: 5; border-color: var(--g1); }
.jcal-cell.today { box-shadow: 0 0 0 1.5px var(--g1); }
.jcal-cell.jc-confident { background: rgba(0,232,122,.7); border-color: rgba(0,232,122,.5); }
.jcal-cell.jc-calm      { background: rgba(61,155,255,.7); border-color: rgba(61,155,255,.5); }
.jcal-cell.jc-neutral   { background: rgba(245,166,35,.7); border-color: rgba(245,166,35,.5); }
.jcal-cell.jc-anxious   { background: rgba(255,59,59,.7); border-color: rgba(255,59,59,.5); }
.jcal-cell.jc-frustrated{ background: rgba(255,120,50,.7); border-color: rgba(255,120,50,.5); }
.jcal-legend { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border2); }
.jcal-leg-item { display: flex; align-items: center; gap: 5px; font-size: 10px; color: var(--muted); }
.jcal-dot { width: 10px; height: 10px; border-radius: 2px; flex-shrink: 0; }
.journal-cards-view { display: flex; flex-direction: column; gap: 12px; }
.jrnl-card-deep { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); overflow: hidden; transition: all .2s; box-shadow: var(--sh); }
.jrnl-card-deep:hover { box-shadow: var(--sh2); transform: translateY(-2px); border-color: rgba(0,232,122,.15); }
.jrnl-card-header { padding: 14px 16px 12px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid var(--border2); background: linear-gradient(135deg, var(--surface2), var(--surface)); }
.jrnl-mood-orb { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0; border: 2px solid; }
.jrnl-mood-orb.confident { background: rgba(0,232,122,.1); border-color: rgba(0,232,122,.3); }
.jrnl-mood-orb.calm      { background: rgba(61,155,255,.1); border-color: rgba(61,155,255,.3); }
.jrnl-mood-orb.neutral   { background: rgba(245,166,35,.1); border-color: rgba(245,166,35,.3); }
.jrnl-mood-orb.anxious   { background: rgba(255,59,59,.1); border-color: rgba(255,59,59,.3); }
.jrnl-mood-orb.frustrated{ background: rgba(255,120,50,.1); border-color: rgba(255,120,50,.3); }
.jrnl-header-info { flex: 1; min-width: 0; }
.jrnl-entry-title { font-size: 14px; font-weight: 800; color: var(--text); margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.jrnl-meta { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
.jrnl-date { font-size: 11px; color: var(--muted); font-family: var(--fm); }
.jrnl-mood-badge { font-size: 9px; font-weight: 800; padding: 1px 7px; border-radius: 99px; letter-spacing: .5px; }
.jrnl-mood-badge.confident { background: rgba(0,232,122,.1); color: var(--g1); }
.jrnl-mood-badge.calm      { background: rgba(61,155,255,.1); color: var(--blue); }
.jrnl-mood-badge.neutral   { background: rgba(245,166,35,.1); color: var(--amber); }
.jrnl-mood-badge.anxious   { background: rgba(255,59,59,.1); color: var(--red); }
.jrnl-mood-badge.frustrated{ background: rgba(255,120,50,.1); color: #ff7832; }
.jrnl-tags { display: flex; gap: 5px; flex-wrap: wrap; margin-top: 5px; }
.jrnl-tag { font-size: 9px; font-weight: 700; color: var(--muted); background: var(--bg2); border: 1px solid var(--border2); padding: 1px 6px; border-radius: 99px; }
.jrnl-tag.tag-trade { color: var(--g1); background: var(--g6); border-color: rgba(0,232,122,.2); }
.jrnl-tag.tag-mindset{ color: var(--blue); background: rgba(61,155,255,.06); border-color: rgba(61,155,255,.2); }
.jrnl-tag.tag-plan  { color: var(--amber); background: rgba(245,166,35,.06); border-color: rgba(245,166,35,.2); }
.jrnl-card-actions { display: flex; gap: 5px; margin-left: auto; flex-shrink: 0; }
.jrnl-card-body { padding: 14px 16px; }
.jrnl-body-text { font-size: 13px; color: var(--text2); line-height: 1.75; white-space: pre-wrap; word-break: break-word; }
.jrnl-body-clamped { max-height: 72px; overflow: hidden; position: relative; }
.jrnl-body-clamped::after { content:''; position:absolute;bottom:0;left:0;right:0;height:28px;background:linear-gradient(transparent,var(--surface)); }
.jrnl-expand-btn { font-size: 11px; color: var(--g1); cursor: pointer; font-weight: 700; margin-top: 6px; display: inline-block; }
.jrnl-card-extras { padding: 10px 16px; border-top: 1px solid var(--border2); display: flex; gap: 14px; flex-wrap: wrap; background: var(--bg2); }
.jrnl-extra-item { display: flex; align-items: center; gap: 5px; font-size: 11px; color: var(--muted); }
.jrnl-extra-item strong { color: var(--text2); font-weight: 700; }
.journal-timeline-view { position: relative; padding-left: 28px; display: flex; flex-direction: column; gap: 14px; }
.journal-timeline-view::before { content:''; position:absolute;top:0;bottom:0;left:8px;width:2px;background:linear-gradient(to bottom,var(--g1),rgba(0,232,122,.1));border-radius:2px; }
.jtl-item { position: relative; }
.jtl-dot { position:absolute;left:-24px;top:14px;width:12px;height:12px;border-radius:50%;background:var(--g1);border:2px solid var(--bg);box-shadow:0 0 10px rgba(0,232,122,.4); }
.jms-option:hover { border-color: rgba(0,232,122,.2) !important; }
.jrc-item { display: flex; align-items: center; gap: 10px; padding: 8px 12px; background: var(--bg2); border: 1px solid var(--border2); border-radius: var(--r2); cursor: pointer; transition: all .12s; font-size: 12px; color: var(--text2); }
.jrc-item:hover { border-color: rgba(0,232,122,.3); }
.jrc-item.checked { border-color: rgba(0,232,122,.4); background: var(--g4); color: var(--text); }
.jrc-box { width: 16px; height: 16px; border: 1.5px solid var(--border); border-radius: 3px; display: flex; align-items: center; justify-content: center; font-size: 10px; background: var(--surface); flex-shrink: 0; transition: all .12s; font-family: var(--fb); }
.jrc-item.checked .jrc-box { background: var(--g1); border-color: var(--g1); color: #000; font-weight: 900; }
.jtrig-chip { padding: 5px 12px; border-radius: 99px; font-size: 11px; font-weight: 700; border: 1px solid var(--border); cursor: pointer; transition: all .12s; color: var(--muted); background: var(--bg2); font-family: var(--fb); }
.jtrig-chip:hover { border-color: rgba(255,59,59,.3); color: var(--red); }
.jtrig-chip.selected { background: rgba(255,59,59,.08); color: var(--red); border-color: rgba(255,59,59,.3); }
.jtrig-chip.jtrig-none:hover,.jtrig-chip.jtrig-none.selected { background: rgba(0,232,122,.08); color: var(--g1); border-color: rgba(0,232,122,.3); }

/* WOLF DISCIPLINE */
.wolf-hero-card { background: linear-gradient(135deg, #020d05, #041208, #020d05); border: 1px solid rgba(0,232,122,.2); border-radius: var(--r5); padding: 28px; position: relative; overflow: hidden; margin-bottom: 14px; box-shadow: 0 0 60px rgba(0,0,0,.8); }
.wolf-hero-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--g1), transparent); }
.wolf-hero-card::after { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 80% 50%, rgba(0,232,122,.07), transparent 60%); pointer-events: none; }
.wolf-big-emoji { position: absolute; right: 24px; top: 50%; transform: translateY(-50%); font-size: 110px; opacity: .12; animation: wolfFloat 3s ease-in-out infinite; filter: drop-shadow(0 0 40px var(--g1)); }
.wolf-d-rank { font-size: 9px; font-weight: 900; letter-spacing: 3px; text-transform: uppercase; color: var(--g1); margin-bottom: 4px; font-family: var(--fm); }
.wolf-d-title { font-family: var(--fd); font-size: 48px; letter-spacing: 2px; color: var(--text); margin-bottom: 4px; line-height: 1; }
.wolf-d-sub { font-size: 13px; color: var(--text2); margin-bottom: 20px; }
.wolf-d-bar-bg { height: 5px; background: rgba(0,232,122,.1); border-radius: 99px; overflow: hidden; margin-top: 4px; max-width: 380px; }
.wolf-d-bar-fill { height: 100%; border-radius: 99px; background: linear-gradient(90deg, var(--g2), var(--g1), rgba(0,232,122,.6)); transition: width 1.5s cubic-bezier(.4,0,.2,1); box-shadow: 0 0 12px var(--g1); }
.wolf-stages-row { display: flex; gap: 6px; margin-top: 14px; flex-wrap: wrap; }
.wolf-stage-pill { display: flex; align-items: center; gap: 5px; padding: 4px 12px; border-radius: 99px; font-size: 10px; font-weight: 900; border: 1px solid; letter-spacing: .5px; }
.wsp-done { background: rgba(0,232,122,.08); border-color: rgba(0,232,122,.2); color: var(--g1); }
.wsp-current { background: var(--g1); border-color: var(--g1); color: #000; animation: stageGlow 2s ease-in-out infinite; }
.wsp-next { background: transparent; border-color: var(--border); color: var(--muted); }
@keyframes stageGlow { 0%,100%{box-shadow:none;} 50%{box-shadow:0 0 16px rgba(0,232,122,.5);} }
.trifecta { display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; margin-bottom: 12px; }
.tri-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); padding: 16px; text-align: center; position: relative; overflow: hidden; transition: all .2s; box-shadow: var(--sh); }
.tri-card:hover { transform: translateY(-3px); box-shadow: var(--sh2); }
.tri-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; }
.tri-g::before { background: linear-gradient(90deg, var(--g1), var(--g2)); }
.tri-b::before { background: linear-gradient(90deg, var(--blue), #5ba8e8); }
.tri-a::before { background: linear-gradient(90deg, var(--amber), #f0c040); }
.tri-icon { font-size: 24px; margin-bottom: 6px; }
.tri-lbl { font-size: 9px; font-weight: 900; color: var(--muted); letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 5px; }
.tri-val { font-family: var(--fd); font-size: 42px; letter-spacing: -1px; line-height: 1; }
.ai-card { background: var(--surface); border: 1px solid rgba(0,232,122,.15); border-radius: var(--r5); padding: 20px; margin-bottom: 14px; box-shadow: var(--sh); position: relative; overflow: hidden; }
.ai-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--g1), transparent); opacity: .4; }
.ai-header { display: flex; align-items: center; gap: 12px; margin-bottom: 14px; }
.ai-icon { width: 42px; height: 42px; background: var(--g4); border: 1px solid rgba(0,232,122,.2); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; }
.ai-meta-label { font-size: 9px; font-weight: 900; letter-spacing: 2px; text-transform: uppercase; color: var(--muted); }
.ai-meta-title { font-family: var(--fd); font-size: 20px; letter-spacing: 1px; color: var(--text); }
.ai-acts { display: flex; gap: 8px; margin-left: auto; }
.ai-btn { padding: 7px 14px; border: none; border-radius: var(--r2); font-family: var(--fb); font-size: 12px; font-weight: 800; cursor: pointer; transition: all .18s; }
.ai-btn-p { background: var(--g1); color: #000; box-shadow: 0 2px 10px rgba(0,232,122,.3); }
.ai-btn-s { background: var(--g4); color: var(--g1); border: 1px solid rgba(0,232,122,.2); }
.ai-btn:disabled { opacity: .5; cursor: not-allowed; }
.ai-output { background: var(--bg2); border: 1px solid var(--border); border-radius: var(--r3); padding: 16px; font-size: 13px; line-height: 1.8; color: var(--text2); max-height: 420px; overflow-y: auto; }
.ai-output h3 { font-family: var(--fd); font-size: 18px; letter-spacing: .5px; color: var(--text); margin: 12px 0 6px; }
.ai-output h3:first-child { margin-top: 0; }
.ai-output .hl-box { background: var(--g4); border: 1px solid rgba(0,232,122,.2); border-radius: 8px; padding: 9px 12px; margin: 6px 0; color: var(--text2); }
.ai-output .warn-box { background: rgba(255,59,59,.05); border: 1px solid rgba(255,59,59,.15); border-radius: 8px; padding: 9px 12px; margin: 6px 0; color: var(--red); }
.ai-output .ok-box { background: var(--g4); border: 1px solid rgba(0,232,122,.25); border-radius: 8px; padding: 9px 12px; margin: 6px 0; }
.ai-spinner { display: inline-block; width: 13px; height: 13px; border: 2px solid var(--border); border-top-color: var(--g1); border-radius: 50%; animation: spin .7s linear infinite; vertical-align: middle; margin-right: 6px; }
@keyframes spin { to { transform: rotate(360deg); } }
.ai-empty { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 30px; text-align: center; color: var(--muted); }
.sec-title { font-size: 9px; font-weight: 900; color: var(--muted); letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
.sec-title::after { content: ''; flex: 1; height: 1px; background: var(--border2); }
.empty { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 28px; text-align: center; }
.empty-ic { font-size: 28px; margin-bottom: 7px; opacity: .3; }
.empty-txt { font-size: 13px; color: var(--muted); max-width: 200px; line-height: 1.6; }
.kv-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border2); font-size: 13px; }
.kv-row:last-child { border: none; }
.kv-key { color: var(--muted); }
.kv-val { color: var(--text); font-weight: 700; font-family: var(--fm); font-size: 12px; }
.jrnl-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r3); padding: 13px 16px; margin-bottom: 8px; border-left: 2px solid transparent; transition: all .14s; }
.jrnl-card:hover { border-left-color: var(--g1); box-shadow: var(--sh); }
.rule-card { display: flex; align-items: flex-start; gap: 10px; padding: 11px 13px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r2); margin-bottom: 7px; transition: all .13s; }
.rule-card:hover { border-color: rgba(0,232,122,.3); }
.viol { display: flex; align-items: center; gap: 8px; padding: 8px 12px; border-radius: var(--r2); font-size: 12px; margin-bottom: 6px; border: 1px solid; }
.viol.bad { background: rgba(255,59,59,.05); color: var(--red); border-color: rgba(255,59,59,.2); }
.viol.good { background: var(--g4); color: var(--g1); border-color: rgba(0,232,122,.25); }
.toast { position: fixed; bottom: 20px; right: 20px; background: var(--surface); border: 1px solid rgba(0,232,122,.3); color: var(--text); padding: 10px 16px; border-radius: var(--r3); font-size: 13px; font-weight: 600; z-index: 9999; transform: translateY(60px); opacity: 0; transition: all .28s cubic-bezier(.4,0,.2,1); box-shadow: var(--sh3); min-width: 200px; }
.toast.show { transform: translateY(0); opacity: 1; }
.focus-breakdown { display: grid; grid-template-columns: repeat(4,1fr); gap: 8px; margin-top: 10px; }
.focus-item { text-align: center; padding: 10px 6px; background: var(--g4); border-radius: var(--r3); border: 1px solid rgba(0,232,122,.12); }
.focus-item-val { font-family: var(--fd); font-size: 28px; letter-spacing: -1px; color: var(--g1); }
.focus-item-lbl { font-size: 10px; color: var(--muted); font-weight: 700; text-transform: uppercase; letter-spacing: .5px; }
.settings-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); padding: 18px; margin-bottom: 12px; box-shadow: var(--sh); }
.settings-title { font-family: var(--fd); font-size: 16px; letter-spacing: .5px; color: var(--text); margin-bottom: 14px; }
.wolf-quote-bar { background: var(--g6); border: 1px solid rgba(0,232,122,.1); border-radius: var(--r3); padding: 10px 16px; margin-bottom: 14px; display: flex; align-items: center; gap: 12px; overflow: hidden; position: relative; }
.wolf-quote-bar::before { content: '🐺'; font-size: 24px; flex-shrink: 0; filter: drop-shadow(0 0 8px rgba(0,232,122,.5)); }
.wolf-quote-text { font-size: 12px; color: var(--text2); font-style: italic; flex: 1; animation: quoteSlide .4s ease; }
@keyframes quoteSlide { 0%{transform:translateY(6px);opacity:0;} 100%{transform:translateY(0);opacity:1;} }
.streak-card { background: linear-gradient(135deg, var(--surface), var(--g6)); border: 1px solid rgba(0,232,122,.2); border-radius: var(--r4); padding: 16px 20px; display: flex; align-items: center; gap: 16px; box-shadow: var(--sh); margin-bottom: 12px; position: relative; overflow: hidden; }
.streak-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, var(--g1), var(--amber), var(--g1)); background-size: 200% 100%; animation: shimmer 3s linear infinite; }
@keyframes shimmer { 0%{background-position:200% 0;} 100%{background-position:-200% 0;} }
.streak-fire { font-size: 36px; filter: drop-shadow(0 0 10px rgba(245,166,35,.6)); animation: fireGlow 1.5s ease-in-out infinite; }
@keyframes fireGlow { 0%,100%{transform:scale(1);} 50%{transform:scale(1.08);} }
.streak-info { flex: 1; }
.streak-label { font-size: 9px; font-weight: 900; color: var(--muted); letter-spacing: 2px; text-transform: uppercase; }
.streak-num { font-family: var(--fd); font-size: 48px; letter-spacing: -2px; line-height: 1; color: var(--amber); text-shadow: 0 0 20px rgba(245,166,35,.4); }
.streak-sub { font-size: 12px; color: var(--text2); }
.trade-modal-header { background: linear-gradient(135deg, #020d05, #041208); border-bottom: 1px solid var(--border); padding: 16px 22px; display: flex; align-items: center; gap: 12px; }
.trade-modal-wolf { font-size: 28px; filter: drop-shadow(0 0 10px rgba(0,232,122,.5)); }
.trade-pnl-live { background: var(--g6); border: 1px solid rgba(0,232,122,.1); border-radius: var(--r3); padding: 10px 16px; margin-bottom: 12px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; text-align: center; }
.tpl-item-lbl { font-size: 9px; font-weight: 900; color: var(--muted); letter-spacing: 1px; text-transform: uppercase; margin-bottom: 3px; }
.tpl-item-val { font-family: var(--fd); font-size: 24px; letter-spacing: -1px; line-height: 1; }
.lb-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); overflow: hidden; box-shadow: var(--sh); margin-bottom: 12px; }
.lb-head { background: linear-gradient(135deg, #020d05, #041208); padding: 14px 16px; border-bottom: 1px solid var(--border); }
.lb-head-title { font-family: var(--fd); font-size: 18px; letter-spacing: 1px; color: var(--text); }
.lb-item { display: flex; align-items: center; gap: 12px; padding: 10px 16px; border-bottom: 1px solid var(--border2); transition: background .12s; }
.lb-item:last-child { border: none; }
.lb-item:hover { background: var(--g6); }
.lb-rank { font-family: var(--fd); font-size: 20px; width: 28px; text-align: center; }
.lb-rank.gold { color: var(--gold); text-shadow: 0 0 10px rgba(255,215,0,.4); }
.lb-rank.silver { color: #c0c0c0; }
.lb-rank.bronze { color: #cd7f32; }
.lb-av { width: 28px; height: 28px; background: var(--g1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 900; color: #000; font-size: 11px; flex-shrink: 0; }
.lb-info { flex: 1; }
.lb-name { font-weight: 700; font-size: 13px; color: var(--text); }
.lb-stage { font-size: 10px; color: var(--muted); }
.lb-score { font-family: var(--fd); font-size: 20px; letter-spacing: -1px; color: var(--g1); }
.challenge-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); padding: 14px 16px; margin-bottom: 8px; display: flex; align-items: center; gap: 12px; transition: all .15s; box-shadow: var(--sh); }
.challenge-card:hover { border-color: rgba(0,232,122,.3); transform: translateX(3px); }
.challenge-card.done { opacity: .6; border-color: rgba(0,232,122,.2); }
.challenge-ic { font-size: 24px; flex-shrink: 0; }
.challenge-info { flex: 1; }
.challenge-title { font-weight: 700; font-size: 13px; color: var(--text); }
.challenge-sub { font-size: 11px; color: var(--muted); margin-top: 2px; }
.challenge-xp { background: var(--g4); border: 1px solid rgba(0,232,122,.2); color: var(--g1); font-size: 10px; font-weight: 900; padding: 3px 10px; border-radius: 99px; flex-shrink: 0; }
.challenge-done-ic { font-size: 20px; flex-shrink: 0; }
.insight-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r4); padding: 14px 16px; margin-bottom: 8px; border-left: 2px solid var(--g1); box-shadow: var(--sh); }
.insight-icon { font-size: 18px; margin-right: 8px; }
.insight-text { font-size: 13px; color: var(--text2); line-height: 1.6; }
.insight-text strong { color: var(--text); }
.risk-calc-card { background: linear-gradient(135deg, #020d05, #041208); border: 1px solid rgba(0,232,122,.2); border-radius: var(--r4); padding: 18px; margin-bottom: 12px; box-shadow: var(--sh); }
.risk-result-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; margin-top: 14px; }
.risk-result-item { background: var(--g4); border: 1px solid rgba(0,232,122,.15); border-radius: var(--r3); padding: 12px; text-align: center; }
.risk-result-lbl { font-size: 9px; font-weight: 900; color: var(--muted); letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 4px; }
.risk-result-val { font-family: var(--fd); font-size: 26px; letter-spacing: -1px; color: var(--g1); }
.pretrade-card { background: var(--surface); border: 1px solid rgba(0,232,122,.2); border-radius: var(--r4); padding: 18px; margin-bottom: 12px; position: relative; overflow: hidden; }
.pretrade-verdict { padding: 14px; border-radius: var(--r3); margin-top: 12px; font-size: 13px; line-height: 1.7; }
.pretrade-go { background: rgba(0,232,122,.1); border: 1px solid rgba(0,232,122,.3); color: var(--g1); }
.pretrade-wait { background: rgba(245,166,35,.08); border: 1px solid rgba(245,166,35,.3); color: var(--amber); }
.pretrade-no { background: rgba(255,59,59,.08); border: 1px solid rgba(255,59,59,.2); color: var(--red); }
.voice-btn { display: flex; align-items: center; gap: 8px; padding: 10px 18px; background: rgba(61,155,255,.1); border: 1px solid rgba(61,155,255,.3); border-radius: var(--r3); color: var(--blue); font-family: var(--fb); font-size: 13px; font-weight: 700; cursor: pointer; transition: all .2s; width: 100%; justify-content: center; margin-bottom: 12px; }
.voice-btn:hover { background: rgba(61,155,255,.2); }
.voice-btn.listening { background: rgba(255,59,59,.1); border-color: rgba(255,59,59,.4); color: var(--red); animation: voicePulse 1s ease-in-out infinite; }
@keyframes voicePulse { 0%,100%{transform:scale(1);} 50%{transform:scale(1.02);} }
.pwa-banner { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: var(--surface); border: 1px solid rgba(0,232,122,.3); border-radius: var(--r4); padding: 12px 20px; z-index: 9998; display: flex; align-items: center; gap: 12px; box-shadow: var(--sh3); min-width: 280px; }
.pwa-banner.hidden { display: none; }
.pwa-install-btn { padding: 7px 16px; background: var(--g1); color: #000; border: none; border-radius: var(--r2); font-weight: 800; font-size: 12px; cursor: pointer; }
.pwa-dismiss { background: none; border: none; color: var(--muted); cursor: pointer; font-size: 18px; margin-left: auto; }
.wolf-modal-inner { text-align: center; padding: 32px; position: relative; overflow: hidden; }
.wolf-modal-inner::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 50% 30%, rgba(0,232,122,.1), transparent 70%); }
.wolf-evo-emoji { font-size: 80px; display: block; margin-bottom: 16px; position: relative; animation: wolfEvoEntrance 1s cubic-bezier(.34,1.56,.64,1); filter: drop-shadow(0 0 30px rgba(0,232,122,.6)); }
@keyframes wolfEvoEntrance { 0%{transform:scale(0) rotate(-15deg);opacity:0;} 100%{transform:scale(1) rotate(0);opacity:1;} }
.wolf-evo-badge { display: inline-block; background: var(--g1); color: #000; font-size: 9px; font-weight: 900; letter-spacing: 2px; padding: 4px 14px; border-radius: 99px; margin-bottom: 12px; }
.wolf-evo-title { font-family: var(--fd); font-size: 40px; letter-spacing: 2px; color: var(--text); margin-bottom: 8px; line-height: 1; }
.wolf-evo-msg { font-size: 14px; color: var(--text2); line-height: 1.7; max-width: 320px; margin: 0 auto 20px; }
.wolf-evo-particles { position: absolute; inset: 0; pointer-events: none; overflow: hidden; }
.wolf-particle { position: absolute; font-size: 12px; animation: particleFly 2s ease-out forwards; }
@keyframes particleFly { 0%{transform:translateY(0) scale(0);opacity:1;} 100%{transform:translateY(-120px) scale(1) rotate(180deg);opacity:0;} }

@media (max-width: 768px) {
  .feats-grid { grid-template-columns: 1fr; }
  .testis { grid-template-columns: 1fr; }
  .auth-inner { grid-template-columns: 1fr; }
  .hero { padding: 60px 20px 50px; }
  .wolf-sec,.feats-sec,.pricing-sec,.testi-sec,.auth-sec { padding: 50px 20px; }
  .lnav { padding: 12px 20px; }
  .lnav-links { display: none; }
  .stats-row { grid-template-columns: repeat(2,1fr); }
  .trifecta { grid-template-columns: 1fr 1fr 1fr; }
  .g31,.g2 { grid-template-columns: 1fr; }
  .sidebar { display: none; }
  .price-cards { flex-direction: column; align-items: center; }
}
</style>
</head>
<body>

<!-- LOADING -->
<div id="s-loading" class="screen active">
  <div class="load-bg-rings">
    <div class="load-ring"></div><div class="load-ring"></div><div class="load-ring"></div><div class="load-ring"></div>
  </div>
  <div class="load-content">
    <div class="load-wolf-wrap">
      <div class="load-wolf-glow"></div>
      <div class="load-wolf-emoji">🐺</div>
    </div>
    <div class="load-title">TRADE<span>FLOW</span></div>
    <div class="load-tagline">Wolf Discipline System</div>
    <div class="load-bar-bg"><div class="load-bar" id="loadBar"></div></div>
    <div class="load-status" id="loadStatus">Initialising wolf pack...</div>
  </div>
</div>

<!-- PASSWORD RESET -->
<div id="s-reset" class="screen">
  <div class="reset-box">
    <div class="reset-head">
      <span class="reset-head-wolf">🔐</span>
      <div class="reset-head-title">NEW PASSWORD</div>
      <div class="reset-head-sub">Set a strong new password for your account</div>
    </div>
    <div class="reset-body">
      <p class="reset-msg">Enter your new password below. The wolf never forgets.</p>
      <div class="reset-err" id="reset-err"></div>
      <div class="reset-success" id="reset-success"></div>
      <div class="fgi" style="margin-bottom:12px;"><label>New Password</label><input type="password" id="reset-pass" placeholder="Min 6 characters"></div>
      <div class="fgi" style="margin-bottom:18px;"><label>Confirm Password</label><input type="password" id="reset-pass2" placeholder="Repeat password"></div>
      <button class="auth-btn" id="resetBtn" onclick="doResetPassword()">✅ Set New Password</button>
    </div>
  </div>
</div>

<!-- LANDING -->
<div id="s-landing" class="screen">
  <nav class="lnav">
    <a class="l-logo" onclick="scrollToSec('hero')">
      <div class="l-logo-ic">🐺</div>
      <span class="l-logo-text">TRADE<em>MIND</em></span>
    </a>
    <div class="lnav-links">
      <button class="lnav-a" onclick="scrollToSec('wolf-sec')">Wolf System</button>
      <button class="lnav-a" onclick="scrollToSec('features')">Features</button>
      <button class="lnav-a" onclick="scrollToSec('pricing')">Pricing</button>
    </div>
    <div style="display:flex;align-items:center;gap:8px;">
      <button class="theme-btn" id="landingThemeBtn" onclick="toggleTheme()">☀️</button>
      <button class="lnav-cta" onclick="scrollToSec('auth')">Join the Pack →</button>
    </div>
  </nav>

  <div class="hero" id="hero">
    <div class="hero-badge"><span class="hero-dot"></span>WOLF PACK · 4,200+ TRADERS</div>
    <h1 class="hero-h1">TRADE LIKE<br><span class="hl">A WOLF.</span><br><span class="dim">NOT PREY.</span></h1>
    <p class="hero-sub">The only trading journal that turns your psychology into your edge. Track discipline, evolve your mindset, dominate the market.</p>
    <div class="hero-btns">
      <button class="hbtn-p" onclick="scrollToSec('auth')">🐺 Begin Your Hunt →</button>
      <button class="hbtn-s" onclick="scrollToSec('wolf-sec')">See Wolf System</button>
    </div>
    <div class="hero-stats">
      <div class="hs-item"><div class="hs-val">4,200+</div><div class="hs-lbl">Wolf Traders</div></div>
      <div class="hs-div"></div>
      <div class="hs-item"><div class="hs-val">₹2.4Cr</div><div class="hs-lbl">P&L Tracked</div></div>
      <div class="hs-div"></div>
      <div class="hs-item"><div class="hs-val">89%</div><div class="hs-lbl">Improved Discipline</div></div>
    </div>
  </div>

  <section class="wolf-sec" id="wolf-sec">
    <div class="sec-eyebrow">🐺 The Wolf System</div>
    <h2 class="sec-h2">EVOLVE OR GET EATEN</h2>
    <p class="sec-sub">Your trading discipline determines your rank. Every decision shapes your evolution from Cub to Legendary Wolf.</p>
    <div class="wolf-visual">
      <div class="wolf-glow"></div>
      <div class="wolf-ring wolf-ring-1"></div><div class="wolf-ring wolf-ring-2"></div><div class="wolf-ring wolf-ring-3"></div>
      <div class="wolf-center-emoji">🐺</div>
    </div>
    <div class="wolf-stages">
      <div class="wolf-stage-card"><div class="wsc-emoji">🐾</div><div class="wsc-name">CUB</div><div class="wsc-range">0–40%</div></div>
      <div class="wsc-arrow">→</div>
      <div class="wolf-stage-card"><div class="wsc-emoji">🐺</div><div class="wsc-name">WOLF</div><div class="wsc-range">40–65%</div></div>
      <div class="wsc-arrow">→</div>
      <div class="wolf-stage-card"><div class="wsc-emoji">⚡</div><div class="wsc-name">ALPHA</div><div class="wsc-range">65–85%</div></div>
      <div class="wsc-arrow">→</div>
      <div class="wolf-stage-card legend-card"><div class="legend-badge">APEX</div><div class="wsc-emoji">🏆</div><div class="wsc-name">LEGENDARY</div><div class="wsc-range">85–100%</div></div>
    </div>
  </section>

  <section class="feats-sec" id="features">
    <div class="sec-eyebrow" style="text-align:center;">⚡ Features</div>
    <h2 class="sec-h2" style="text-align:center;">YOUR COMPLETE EDGE</h2>
    <div class="feats-grid">
      <div class="feat-card"><div class="feat-ic">🐺</div><div class="feat-h">WOLF EVOLUTION</div><div class="feat-p">4-stage evolution system based on real discipline metrics. Cub → Wolf → Alpha → Legendary. Each stage unlocks psychological identity shifts.</div></div>
      <div class="feat-card"><div class="feat-ic">📊</div><div class="feat-h">BATTLE LOG</div><div class="feat-p">11-point execution checklist. Every trade tracked like a predator stalking prey. No sloppy entries. Full post-trade analysis mandatory.</div></div>
      <div class="feat-card"><div class="feat-ic">🧠</div><div class="feat-h">MIND ANALYSIS</div><div class="feat-p">Psychology sliders: Confidence, Focus, Patience, Calm. Discover your emotional patterns. Fix what kills your P&L.</div></div>
      <div class="feat-card"><div class="feat-ic">🤖</div><div class="feat-h">AI WOLF COACH</div><div class="feat-p">Claude AI analyses your trading patterns in Hinglish. Personalized action plans. Weekly insights. Catches your blind spots.</div></div>
      <div class="feat-card"><div class="feat-ic">🔥</div><div class="feat-h">STREAK SYSTEM</div><div class="feat-p">Build discipline streaks. Consecutive high-score days compound your wolf ranking. Break the streak, feel the pain. That's the point.</div></div>
      <div class="feat-card"><div class="feat-ic">🎯</div><div class="feat-h">DAILY CHALLENGES</div><div class="feat-p">Wolf-designed daily missions to push your discipline. Complete challenges, earn XP, evolve faster. Gamification that drives real results.</div></div>
    </div>
  </section>

  <div class="ad-banner">
    <div class="ad-label">Advertisement</div>
    <div>
      <a href="https://wa.me/919987961609?text=TradeMind%20Pro%20subscribe%20karna%20hai" target="_blank" style="display:inline-block;background:var(--g1);color:#000;padding:9px 24px;border-radius:10px;font-size:13px;font-weight:900;text-decoration:none;letter-spacing:.5px;">
        🐺 Join 4,200+ Wolf Traders — Start for ₹99 →
      </a>
    </div>
  </div>

  <!-- ══ PRICING SECTION — 3 PLANS ══ -->
  <section class="pricing-sec" id="pricing">
    <div class="sec-eyebrow" style="text-align:center;">💎 Pricing</div>
    <h2 class="sec-h2" style="text-align:center;">INVEST IN YOUR EDGE</h2>
    <p style="text-align:center;font-size:14px;color:var(--text2);margin-top:-6px;margin-bottom:8px;">3 plans · All include Wolf Evolution System · Cancel anytime</p>
    <div class="price-cards">

      <!-- ₹99 STARTER -->
      <div class="price-card">
        <div class="price-tag">STARTER OFFER</div>
        <div class="price-offer-strip">🎉 67% OFF — First Month Only</div>
        <div class="price-num"><sub>₹</sub>99</div>
        <div class="price-period">First month only</div>
        <div class="price-then">Then ₹299/month · Cancel anytime</div>
        <div class="pf-list">
          <div class="pf-row"><div class="pf-ck">✓</div>All Wolf features included</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Wolf Evolution System</div>
          <div class="pf-row"><div class="pf-ck">✓</div>AI Wolf Coach Reports</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Cancel anytime</div>
        </div>
        <button class="price-btn price-btn-s" onclick="scrollToSec('auth')">Begin Hunt — ₹99</button>
      </div>

      <!-- ₹199 WOLF PLAN — NEW -->
      <div class="price-card wolf199">
        <div class="price-popular-badge">🐺 POPULAR</div>
        <div class="price-tag" style="color:var(--blue);">WOLF MONTHLY PLAN</div>
        <div class="price-num" style="color:var(--blue);"><sub style="color:var(--blue);">₹</sub>199</div>
        <div class="price-period">per month · Cancel anytime</div>
        <div class="price-then">Full Wolf System — Best value for daily hunters</div>
        <div class="pf-list">
          <div class="pf-row"><div class="pf-ck">✓</div>Unlimited trade logging</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Wolf Evolution System</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Full analytics dashboard</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Daily Wolf Challenges</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Psychology tracking</div>
          <div class="pf-row"><div class="pf-ck" style="color:var(--muted);">—</div>AI Reports (Alpha Pro only)</div>
        </div>
        <button class="price-btn price-btn-b" onclick="scrollToSec('auth')">Join Wolf Plan — ₹199</button>
      </div>

      <!-- ₹299 ALPHA PRO -->
      <div class="price-card featured">
        <div class="price-featured-badge">ALPHA VALUE</div>
        <div class="price-tag">ALPHA PRO PLAN</div>
        <div class="price-num"><sub>₹</sub>299</div>
        <div class="price-period">per month · Cancel anytime</div>
        <div class="price-then">Full predator toolkit — Discipline + Psychology + AI</div>
        <div class="pf-list">
          <div class="pf-row"><div class="pf-ck">✓</div>Unlimited trade logging</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Wolf Pack Evolution</div>
          <div class="pf-row"><div class="pf-ck">✓</div>AI Reports (Claude-powered)</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Full analytics dashboard</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Daily Wolf Challenges</div>
          <div class="pf-row"><div class="pf-ck">✓</div>Pre-Trade AI Coach</div>
        </div>
        <button class="price-btn price-btn-p" onclick="scrollToSec('auth')">Join the Pack — ₹299</button>
      </div>

    </div>

    <!-- PLAN COMPARISON TABLE -->
    <div style="max-width:700px;margin:32px auto 0;background:var(--surface);border:1px solid var(--border);border-radius:var(--r4);overflow:hidden;box-shadow:var(--sh);">
      <div style="background:var(--bg2);padding:12px 16px;font-family:var(--fd);font-size:18px;letter-spacing:1px;border-bottom:1px solid var(--border);">📊 Plan Comparison</div>
      <table style="width:100%;">
        <thead>
          <tr style="background:var(--bg2);">
            <th style="text-align:left;padding:10px 16px;">Feature</th>
            <th style="text-align:center;padding:10px;">₹99 Starter</th>
            <th style="text-align:center;padding:10px;color:var(--blue);">₹199 Wolf</th>
            <th style="text-align:center;padding:10px;color:var(--g1);">₹299 Alpha</th>
          </tr>
        </thead>
        <tbody>
          <tr><td style="padding:9px 16px;font-size:12px;">Trade Journal</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td></tr>
          <tr style="background:var(--bg2);"><td style="padding:9px 16px;font-size:12px;">Wolf Evolution</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td></tr>
          <tr><td style="padding:9px 16px;font-size:12px;">Analytics Dashboard</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td></tr>
          <tr style="background:var(--bg2);"><td style="padding:9px 16px;font-size:12px;">Daily Challenges</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td></tr>
          <tr><td style="padding:9px 16px;font-size:12px;">Psychology Tracking</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td></tr>
          <tr style="background:var(--bg2);"><td style="padding:9px 16px;font-size:12px;">AI Wolf Coach Reports</td><td style="text-align:center;color:var(--muted);">—</td><td style="text-align:center;color:var(--muted);">—</td><td style="text-align:center;">✅</td></tr>
          <tr><td style="padding:9px 16px;font-size:12px;">Pre-Trade AI Coach</td><td style="text-align:center;color:var(--muted);">—</td><td style="text-align:center;color:var(--muted);">—</td><td style="text-align:center;">✅</td></tr>
        </tbody>
      </table>
    </div>
  </section>

  <section class="testi-sec">
    <div class="sec-eyebrow" style="text-align:center;">⭐ The Pack Speaks</div>
    <h2 class="sec-h2" style="text-align:center;">WOLF TESTIMONIALS</h2>
    <div class="testis">
      <div class="testi-card"><div class="testi-stars">★★★★★</div><div class="testi-text">"Wolf system ne mera trading badal diya. Ab discipline maintain karta hoon. Alpha stage pe hun!"</div><div class="testi-auth"><div class="testi-av">R</div><div><div class="testi-name">Rahul Deshmukh</div><div class="testi-role">F&O Trader, Pune · ⚡ Alpha Wolf</div></div></div></div>
      <div class="testi-card"><div class="testi-stars">★★★★★</div><div class="testi-text">"₹199 Wolf plan liya — full value! AI reports nahi par baki sab mila. Journey suru ho gayi."</div><div class="testi-auth"><div class="testi-av">P</div><div><div class="testi-name">Priya Nair</div><div class="testi-role">Equity Trader, Mumbai · 🐺 Wolf Plan</div></div></div></div>
      <div class="testi-card"><div class="testi-stars">★★★★★</div><div class="testi-text">"Daily challenges ne mujhe accountable rakha. Pehle ₹99, ab ₹199 pe hoon — growing with the pack!"</div><div class="testi-auth"><div class="testi-av">A</div><div><div class="testi-name">Aakash Sharma</div><div class="testi-role">Commodity Trader, Delhi · 🐾 Cub → 🐺 Wolf</div></div></div></div>
    </div>
  </section>

  <section class="auth-sec" id="auth">
    <div class="auth-inner">
      <div>
        <div class="sec-eyebrow">🚀 Join the Pack</div>
        <h2 class="sec-h2">START YOUR<br>WOLF JOURNEY</h2>
        <div class="auth-list">
          <div class="auth-list-item"><span class="auth-list-ck">✓</span>Hunt begins in under 2 minutes</div>
          <div class="auth-list-item"><span class="auth-list-ck">✓</span>Wolf system activates from first trade</div>
          <div class="auth-list-item"><span class="auth-list-ck">✓</span>Plans from ₹99 · ₹199 · ₹299 per month</div>
          <div class="auth-list-item"><span class="auth-list-ck">✓</span>Pay via WhatsApp, Paytm, GPay, PhonePe</div>
          <div class="auth-list-item"><span class="auth-list-ck">✓</span>Cancel anytime — no questions asked</div>
        </div>
      </div>
      <div class="auth-box">
        <div class="auth-tabs">
          <div class="auth-tab active" onclick="switchAuthTab('login')">Login</div>
          <div class="auth-tab" onclick="switchAuthTab('register')">Join Pack</div>
        </div>
        <div id="auth-err" class="err-msg"></div>
        <form class="auth-form" id="form-login" onsubmit="return false;">
          <div class="fg"><label>Email</label><div class="iw"><span class="ic"></span><input class="fi" id="li-email" type="email" placeholder="your@email.com"></div></div>
          <div class="fg"><label>Password</label><div class="iw"><span class="ic"></span><input class="fi" id="li-pass" type="password" placeholder="••••••••"></div></div>
          <button class="auth-btn" onclick="doLogin()">🐺 Enter the Pack</button>
         <div style="text-align:center;margin-top:8px;"><button type="button" style="background:none;border:none;color:var(--muted);font-size:11px;cursor:pointer;font-family:var(--fb);text-decoration:underline;" onclick="openForgotPassword()">Password विसरलात?</button></div>
        </form>
        <form class="auth-form hidden" id="form-register" onsubmit="return false;">
          <div class="fg"><label>Full Name</label><div class="iw"><span class="ic"></span><input class="fi" id="reg-name" type="text" placeholder="Wolf Name"></div></div>
          <div class="fg"><label>Email</label><div class="iw"><span class="ic"></span><input class="fi" id="reg-email" type="email" placeholder="your@email.com"></div></div>
          <div class="fg"><label>Password</label><div class="iw"><span class="ic"></span><input class="fi" id="reg-pass" type="password" placeholder="Min 6 characters"></div></div>
          <button class="auth-btn" onclick="doRegister()">🐺 Create Wolf Account</button>
        </form>
      </div>
    </div>
  </section>

  <footer class="lfoot">
    <div class="lfoot-brand">TRADE<em>MIND</em></div>
    <div style="font-size:12px;color:var(--muted);">© 2026 TradeMind · Made for Indian Wolves 🇮🇳</div>
    <div style="display:flex;gap:14px;font-size:12px;color:var(--muted);"><span style="cursor:pointer;">Privacy</span><span style="cursor:pointer;">Terms</span><span style="cursor:pointer;">Support</span></div>
  </footer>
</div>

<!-- SUBSCRIPTION SCREEN -->
<div id="s-sub" class="screen">
  <div class="sub-box">
    <div class="sub-head">
      <span class="sub-head-wolf">🐺</span>
      <div class="sub-head-title">ACTIVATE YOUR PACK</div>
      <div class="sub-head-sub">Join 4,200+ wolves on the hunt</div>
    </div>
    <div class="sub-body">

      <!-- 3 PLAN PRICE DISPLAY -->
      <div class="offer-banner">
        <div style="display:flex;align-items:center;justify-content:center;gap:16px;flex-wrap:wrap;">
          <div style="text-align:center;">
            <div style="font-family:var(--fd);font-size:30px;color:var(--g1);line-height:1;">₹99<span style="font-size:13px;color:var(--muted);"> 1st mo</span></div>
            <div style="font-size:10px;color:var(--muted);margin-top:2px;">Starter</div>
          </div>
          <div style="width:1px;height:36px;background:var(--border);"></div>
          <div style="text-align:center;">
            <div style="font-family:var(--fd);font-size:30px;color:var(--blue);line-height:1;">₹199<span style="font-size:13px;color:var(--muted);"> /mo</span></div>
            <div style="font-size:10px;color:var(--blue);font-weight:800;margin-top:2px;">🐺 Wolf Plan</div>
          </div>
          <div style="width:1px;height:36px;background:var(--border);"></div>
          <div style="text-align:center;">
            <div style="font-family:var(--fd);font-size:30px;color:var(--g1);line-height:1;">₹299<span style="font-size:13px;color:var(--muted);"> /mo</span></div>
            <div style="font-size:10px;color:var(--muted);margin-top:2px;">Alpha Pro + AI</div>
          </div>
        </div>
        <div class="offer-note" style="margin-top:10px;"><span class="offer-save">NEW</span><span>₹199 Wolf Plan — Full system, save ₹100 vs Pro!</span></div>
      </div>

      <div class="pay-methods-title">Choose Your Plan & Payment Method</div>

      <!-- WhatsApp ₹99 -->
      <div class="pay-method selected" id="pm-wa" onclick="selectPayMethod('wa')">
        <div class="pay-method-header"><div class="pay-method-icon">💬</div><div><div class="pay-method-name">WhatsApp Pay — ₹99 Starter</div><div class="pay-method-sub">First month offer · then ₹299/mo</div></div></div>
        <div class="pay-detail">
          <div class="wa-number-box"><div style="font-size:11px;color:var(--muted);margin-bottom:4px;">WhatsApp Business</div><div class="wa-number">+91 9987961609</div></div>
          <div style="font-size:12px;color:var(--text2);margin-bottom:10px;">Send ₹99 via WhatsApp Pay and message: <strong>"TradeMind ₹99 activated - [your email]"</strong></div>
          <a class="wa-btn" href="https://wa.me/919987961609?text=TradeMind%20%E2%82%B999%20payment%20done%20-%20please%20activate%20my%20account" target="_blank">💬 Open WhatsApp to Pay</a>
          <button class="upi-paid-btn" onclick="upiPaid()">✅ I've Paid — Activate Now</button>
        </div>
      </div>

      <!-- ₹199 WOLF PLAN — NEW -->
      <div class="pay-method method-199" id="pm-199" onclick="selectPayMethod('199')">
        <div class="pay-method-header">
          <div class="pay-method-icon">🐺</div>
          <div>
            <div class="pay-method-name">Wolf Plan — ₹199/month</div>
            <div class="pay-method-sub">Full Wolf System · Save ₹100 vs Alpha Pro</div>
          </div>
          <div style="margin-left:auto;font-size:9px;font-weight:900;padding:3px 10px;background:rgba(61,155,255,.15);color:var(--blue);border:1px solid rgba(61,155,255,.35);border-radius:99px;flex-shrink:0;letter-spacing:1px;">POPULAR</div>
        </div>
        <div class="pay-detail">
          <div style="background:rgba(61,155,255,.08);border:1px solid rgba(61,155,255,.2);border-radius:var(--r2);padding:8px 12px;margin-bottom:10px;font-size:11px;color:var(--text2);">
            ✅ Unlimited Trades &nbsp;|&nbsp; ✅ Wolf Evolution &nbsp;|&nbsp; ✅ Analytics &nbsp;|&nbsp; ✅ Challenges &nbsp;|&nbsp; ❌ AI Reports
          </div>
          <div class="upi-number-box"><div class="upi-number">9987961609@paytm</div><button class="copy-btn" onclick="copyUPI()">Copy</button></div>
          <div class="upi-apps">
            <div class="upi-app"><span class="upi-app-ic">💙</span>Paytm</div>
            <div class="upi-app"><span class="upi-app-ic">🟢</span>PhonePe</div>
            <div class="upi-app"><span class="upi-app-ic">🔵</span>GPay</div>
            <div class="upi-app"><span class="upi-app-ic">🟠</span>BHIM</div>
          </div>
          <div style="font-size:11px;color:var(--text2);margin:8px 0;">₹199 send karo aur message karo: <strong>"TradeMind Wolf ₹199 - [your email]"</strong></div>
          <a class="wa-btn wa-btn-blue" href="https://wa.me/919987961609?text=TradeMind%20Wolf%20Plan%20%E2%82%B9199%20payment%20done%20-%20please%20activate%20my%20account" target="_blank" style="background:var(--blue);">💬 Confirm on WhatsApp</a>
          <button class="upi-paid-btn" onclick="upiPaid()">✅ I've Paid ₹199 — Activate Now</button>
        </div>
      </div>

      <!-- UPI ₹299 -->
      <div class="pay-method" id="pm-upi" onclick="selectPayMethod('upi')">
        <div class="pay-method-header"><div class="pay-method-icon">📱</div><div><div class="pay-method-name">UPI — Alpha Pro ₹299/month</div><div class="pay-method-sub">Paytm / GPay / PhonePe · Includes AI Reports</div></div></div>
        <div class="pay-detail">
          <div class="upi-number-box"><div class="upi-number">9987961609@paytm</div><button class="copy-btn" onclick="copyUPI()">Copy</button></div>
          <div class="upi-apps"><div class="upi-app"><span class="upi-app-ic">💙</span>Paytm</div><div class="upi-app"><span class="upi-app-ic">🟢</span>PhonePe</div><div class="upi-app"><span class="upi-app-ic">🔵</span>Google Pay</div><div class="upi-app"><span class="upi-app-ic">🟠</span>BHIM</div></div>
          <div style="font-size:11px;color:var(--muted);margin-top:8px;">₹299 send karo and message: "TradeMind Alpha Pro ₹299 - [email]". Admin 24hrs mein activate karega.</div>
          <button class="upi-paid-btn" onclick="upiPaid()">✅ I've Paid ₹299 — Activate Now</button>
        </div>
      </div>

      <!-- Card -->
      <div class="pay-method" id="pm-card" onclick="selectPayMethod('card')">
        <div class="pay-method-header"><div class="pay-method-icon">💳</div><div><div class="pay-method-name">Debit / Credit Card</div><div class="pay-method-sub">Visa, Mastercard, RuPay</div></div></div>
        <div class="pay-detail">
          <div class="fgi" style="margin-bottom:8px;"><label>Card Number</label><input class="pay-input" id="cardNum" type="text" placeholder="1234 5678 9012 3456" maxlength="19" oninput="fmtCard(this)"></div>
          <div class="pay-row"><div class="fgi"><label>Expiry</label><input class="pay-input" id="cardExp" type="text" placeholder="MM/YY" maxlength="5" oninput="fmtExp(this)"></div><div class="fgi"><label>CVV</label><input class="pay-input" id="cardCvv" type="text" placeholder="123" maxlength="3"></div></div>
          <button class="pay-activate-btn" id="payBtn" onclick="processCard()">Pay & Activate →</button>
        </div>
      </div>

      <div class="sub-secure">🔒 Secure · Cancel anytime · Plans from ₹99/mo</div>
      <div class="sub-back"><button onclick="goScreen('s-landing')">← Back to home</button></div>
    </div>
  </div>
</div>

<!-- MAIN APP -->
<div id="s-app" class="screen">
  <div class="app-layout">
    <aside class="sidebar">
      <div class="sb-brand"><div class="sb-brand-ic">🐺</div><span class="sb-brand-text">TRADE<em>MIND</em></span></div>
      <div class="sb-wolf" onclick="goPage('discipline')">
        <div class="sb-wolf-top"><div class="sb-wolf-emoji" id="sbWolfEmoji">🐾</div><div class="sb-wolf-info"><div class="sb-wolf-rank" id="sbWolfRank">CUB TRADER</div><div class="sb-wolf-name">Loading...</div></div></div>
        <div class="sb-wolf-bar-bg"><div class="sb-wolf-bar" id="sbWolfFill" style="width:0%"></div></div>
        <div class="sb-wolf-pct" id="sbWolfPct">0% discipline</div>
      </div>
      <nav class="sb-nav">
        <div class="sb-section">Hunt</div>
        <div class="sb-item active" onclick="goPage('dashboard')"><span class="sb-item-ic">📊</span>Dashboard</div>
        <div class="sb-item" onclick="goPage('trades')"><span class="sb-item-ic">📋</span>Trade Log</div>
        <div class="sb-section">Evolve</div>
        <div class="sb-item" onclick="goPage('discipline')"><span class="sb-item-ic">🐺</span>Wolf Discipline</div>
        <div class="sb-item" onclick="goPage('challenges')"><span class="sb-item-ic">🎯</span>Daily Challenges</div>
        <div class="sb-section">Analyse</div>
        <div class="sb-item" onclick="goPage('analytics')"><span class="sb-item-ic">📈</span>Analytics</div>
        <div class="sb-item" onclick="goPage('reports')"><span class="sb-item-ic">🤖</span>AI Reports</div>
        <div class="sb-section">Mind</div>
        <div class="sb-item" onclick="goPage('journal')"><span class="sb-item-ic">📓</span>Journal</div>
        <div class="sb-item" onclick="goPage('rules')"><span class="sb-item-ic">📌</span>Wolf Rules</div>
        <div class="sb-section">Pack</div>
        <div class="sb-item" onclick="goPage('risk')"><span class="sb-item-ic">⚖️</span>Risk Calculator</div>
        <div class="sb-item" onclick="goPage('pretrade')"><span class="sb-item-ic">🤖</span>Pre-Trade Coach</div>
        <div class="sb-item" onclick="goPage('settings')"><span class="sb-item-ic">⚙️</span>Settings</div>
      </nav>
      <div class="sb-foot">
        <div class="sb-foot-user" onclick="toggleDropdown()">
          <div class="sb-avatar" id="sbAvatar">W</div>
          <div class="sb-foot-info"><div class="sb-foot-name" id="sbName">Wolf Trader</div><div class="sb-foot-status">🟢 Pro Active</div></div>
          <div class="sb-foot-toggle">⋯</div>
        </div>
        <div class="sb-dropdown" id="sbDropdown">
          <div class="sb-dd-user"><div class="sb-dd-name" id="ddName">Wolf</div><div class="sb-dd-email" id="ddEmail">wolf@pack.in</div></div>
          <div class="sb-dd-item" onclick="toggleTheme()"><span id="themeIc">☀️</span><span id="themeLabel">Light Mode</span></div>
          <div class="sb-dd-item" onclick="goPage('settings')">⚙️ Settings</div>
          <div class="sb-dd-item" onclick="doLogout()" style="color:var(--red);">🚪 Logout</div>
        </div>
      </div>
    </aside>

    <div class="main-wrap">
      <header class="topbar">
        <div class="tb-left"><div class="tb-title" id="tbTitle">Dashboard</div><div class="tb-sub" id="tbSub">Your trading overview</div></div>
        <div class="tb-actions">
          <button class="tb-theme-btn" onclick="toggleTheme()">🌙</button>
          <button class="tb-log-btn" onclick="openTradeModal()">⚔️ LOG TRADE</button>
        </div>
      </header>
      <div class="main-content">

        <!-- DASHBOARD -->
        <div class="page active" id="pg-dashboard">
          <div class="wolf-quote-bar"><div class="wolf-quote-text" id="wolfQuote">Loading your wolf mindset...</div></div>
          <div class="stats-row">
            <div class="stat-card"><div class="stat-top" style="background:linear-gradient(90deg,var(--g1),var(--g2))"></div><div class="stat-ic">💰</div><div class="stat-lbl">Total P&L</div><div class="stat-val" id="db-pnl">₹0</div><div class="stat-sub" id="db-pnl-sub">all time</div></div>
            <div class="stat-card"><div class="stat-top" style="background:linear-gradient(90deg,var(--blue),#5ba8e8)"></div><div class="stat-ic">🎯</div><div class="stat-lbl">Win Rate</div><div class="stat-val" id="db-wr">0%</div><div class="stat-sub" id="db-wr-sub">0 trades</div></div>
            <div class="stat-card"><div class="stat-top" style="background:linear-gradient(90deg,var(--amber),#f0c040)"></div><div class="stat-ic">🐺</div><div class="stat-lbl">Discipline</div><div class="stat-val" id="db-disc">0%</div><div class="stat-sub" id="db-disc-sub">avg score</div></div>
            <div class="stat-card"><div class="stat-top" style="background:linear-gradient(90deg,var(--purple),#a855f7)"></div><div class="stat-ic">📅</div><div class="stat-lbl">This Month</div><div class="stat-val" id="db-month">0</div><div class="stat-sub">trades logged</div></div>
          </div>
          <div class="g31">
            <div class="card"><div class="card-title">Equity Curve <span class="ctag" id="dbEqTag">All time</span></div><canvas id="eqChart" height="150" style="width:100%;"></canvas></div>
            <div class="card"><div class="card-title">P&L Heatmap</div><div class="hm-grid" id="hmGrid"></div></div>
          </div>
          <div class="g2">
            <div class="card"><div class="card-title">Recent Trades</div><div class="tw"><table><thead><tr><th>Symbol</th><th>Date</th><th>P&L</th><th>Disc</th><th>Result</th></tr></thead><tbody id="recentTrades"></tbody></table></div></div>
            <div class="card"><div class="card-title">Performance</div>
              <div class="kv-row"><span class="kv-key">Profit Factor</span><span class="kv-val" id="perf-pf">—</span></div>
              <div class="kv-row"><span class="kv-key">Avg Win</span><span class="kv-val" id="perf-aw" style="color:var(--g1);">—</span></div>
              <div class="kv-row"><span class="kv-key">Avg Loss</span><span class="kv-val" id="perf-al" style="color:var(--red);">—</span></div>
              <div class="kv-row"><span class="kv-key">Best Trade</span><span class="kv-val" id="perf-bt" style="color:var(--g1);">—</span></div>
              <div class="kv-row"><span class="kv-key">Worst Trade</span><span class="kv-val" id="perf-wt" style="color:var(--red);">—</span></div>
            </div>
          </div>
        </div>

        <!-- TRADES -->
        <div class="page" id="pg-trades">
          <div class="tw"><table><thead><tr><th>Date</th><th>Symbol</th><th>Setup</th><th>Side</th><th>Entry</th><th>Exit</th><th>Qty</th><th>P&L</th><th>Disc</th><th>Emotion</th><th>Actions</th></tr></thead><tbody id="tradesList"></tbody></table></div>
        </div>

        <!-- ANALYTICS -->
        <div class="page" id="pg-analytics">
          <div class="trifecta">
            <div class="tri-card tri-g"><div class="tri-icon">🐺</div><div class="tri-lbl">Avg Discipline</div><div class="tri-val" id="an-disc" style="color:var(--g1)">0%</div></div>
            <div class="tri-card tri-b"><div class="tri-icon">📋</div><div class="tri-lbl">Avg Execution</div><div class="tri-val" id="an-exec" style="color:var(--blue)">0%</div></div>
            <div class="tri-card tri-a"><div class="tri-icon">🎯</div><div class="tri-lbl">Avg Focus</div><div class="tri-val" id="an-focus" style="color:var(--amber)">0</div></div>
          </div>
          <div class="card" style="margin-bottom:12px;"><div class="card-title">Focus Breakdown</div><div class="focus-breakdown"><div class="focus-item"><div class="focus-item-val" id="fc-conf">0</div><div class="focus-item-lbl">Confidence</div></div><div class="focus-item"><div class="focus-item-val" id="fc-focus">0</div><div class="focus-item-lbl">Focus</div></div><div class="focus-item"><div class="focus-item-val" id="fc-pat">0</div><div class="focus-item-lbl">Patience</div></div><div class="focus-item"><div class="focus-item-val" id="fc-calm">0</div><div class="focus-item-lbl">Calm</div></div></div></div>
          <div class="g2">
            <div class="card"><div class="card-title">Discipline Trend <span class="ctag">Last 20</span></div><canvas id="discChart" height="150" style="width:100%;"></canvas></div>
            <div class="card"><div class="card-title">Setup Performance</div><div id="setupPerf"></div></div>
          </div>
          <div class="g2">
            <div class="card"><div class="card-title">Session Performance</div><div id="sessionPerf"></div></div>
            <div class="card"><div class="card-title">Emotion vs P&L</div><div id="emoPerf"></div></div>
          </div>
          <div class="card"><div class="card-title">Execution Trend</div><canvas id="execChart" height="130" style="width:100%;"></canvas></div>
        </div>

        <!-- WOLF DISCIPLINE -->
        <div class="page" id="pg-discipline">
          <div class="wolf-hero-card">
            <div class="wolf-big-emoji" id="wolfBigEmoji">🐺</div>
            <div style="position:relative;z-index:1;">
              <div class="wolf-d-rank" id="wd-rank">RANK · CUB TRADER</div>
              <div class="wolf-d-title" id="wd-title">You Are a Cub</div>
              <div class="wolf-d-sub" id="wd-sub">Every legend starts here. Log trades consistently.</div>
              <div style="max-width:380px;"><div style="display:flex;justify-content:space-between;font-size:11px;color:var(--muted);margin-bottom:4px;"><span>Discipline Progress</span><span id="wd-pct">0%</span></div><div class="wolf-d-bar-bg"><div class="wolf-d-bar-fill" id="wdBar" style="width:0%"></div></div></div>
              <div class="wolf-stages-row" id="wolfStagesRow"></div>
            </div>
          </div>
          <div class="streak-card" id="streakCard">
            <div class="streak-fire">🔥</div>
            <div class="streak-info"><div class="streak-label">Current Streak</div><div class="streak-num" id="streakNum">0</div><div class="streak-sub" id="streakSub">consecutive high-discipline days</div></div>
            <div style="text-align:right;"><div style="font-size:10px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;font-weight:900;">Best</div><div style="font-family:var(--fd);font-size:28px;color:var(--amber);" id="bestStreakNum">0</div></div>
          </div>
          <div class="trifecta">
            <div class="tri-card tri-g"><div class="tri-icon">🐺</div><div class="tri-lbl">Discipline</div><div class="tri-val" id="dd-disc" style="color:var(--g1)">0%</div><div style="font-size:10px;color:var(--muted);">avg per trade</div></div>
            <div class="tri-card tri-b"><div class="tri-icon">⚡</div><div class="tri-lbl">Total Trades</div><div class="tri-val" id="dd-total" style="color:var(--blue)">0</div><div style="font-size:10px;color:var(--muted);">logged</div></div>
            <div class="tri-card tri-a"><div class="tri-icon">🎯</div><div class="tri-lbl">Next Goal</div><div class="tri-val" id="dd-next" style="color:var(--amber)">40%</div><div style="font-size:10px;color:var(--muted);">to next stage</div></div>
          </div>
          <div class="card" style="margin-bottom:12px;"><div class="card-title">🧠 Wolf Insights <span class="ctag">Pattern Analysis</span></div><div id="wolfInsights"><div class="empty"><div class="empty-ic">🐺</div><div class="empty-txt">Log more trades to unlock wolf insights</div></div></div></div>
          <div class="g2">
            <div class="card"><div class="card-title">11-Point Checklist Performance</div><div id="checkPerf"></div></div>
            <div class="card"><div class="card-title">Rule Violations</div><div id="violTracker"></div></div>
          </div>
        </div>

        <!-- DAILY CHALLENGES -->
        <div class="page" id="pg-challenges">
          <div class="wolf-quote-bar" style="margin-bottom:16px;"><div class="wolf-quote-text">Daily challenges forge the wolf. Complete missions. Earn XP. Evolve faster.</div></div>
          <div class="card" style="margin-bottom:14px;"><div class="card-title">Today's Wolf Missions <span class="ctag" id="challengeDate"></span></div><div id="challengeList"></div></div>
          <div class="card"><div class="card-title">🏆 Wolf XP <span class="ctag" id="xpDisplay">0 XP</span></div><div style="background:var(--bg2);border-radius:var(--r2);height:8px;overflow:hidden;margin-bottom:10px;"><div id="xpBar" style="height:100%;background:linear-gradient(90deg,var(--amber),var(--g1));border-radius:var(--r2);width:0%;transition:width 1s;box-shadow:0 0 10px var(--g1);"></div></div><div style="font-size:11px;color:var(--muted);">Complete daily challenges to earn XP and accelerate wolf evolution</div></div>
        </div>

        <!-- JOURNAL -->
        <div class="page" id="pg-journal">
          <div class="journal-hero">
            <div class="journal-hero-left">
              <div class="journal-streak-badge"><span class="journal-streak-fire">🔥</span><span id="jStreakCount" style="font-family:var(--fd);font-size:28px;color:var(--amber);line-height:1;">0</span><span style="font-size:10px;font-weight:700;color:var(--amber);letter-spacing:.5px;">day streak</span></div>
              <div class="journal-hero-stats">
                <div class="jhs-item"><div class="jhs-val" id="j-total-count">0</div><div class="jhs-lbl">Entries</div></div>
                <div class="jhs-div"></div>
                <div class="jhs-item"><div class="jhs-val" id="j-this-week">0</div><div class="jhs-lbl">This Week</div></div>
                <div class="jhs-div"></div>
                <div class="jhs-item"><div class="jhs-val" id="j-avg-mood">—</div><div class="jhs-lbl">Mood Avg</div></div>
              </div>
            </div>
            <div class="journal-hero-actions">
              <button class="btn btn-s" onclick="openAIJournalCoach()">🤖 AI Coach</button>
              <button class="btn btn-p" onclick="openJournalModal()">📓 New Entry</button>
            </div>
          </div>
          <div class="wolf-quote-bar" style="margin-bottom:14px;"><div class="wolf-quote-text" id="journalWolfQuote">The wolf who journals daily evolves fastest. Your mind is your most powerful weapon.</div></div>
          <div class="journal-controls">
            <div class="journal-search-wrap"><span style="font-size:14px;flex-shrink:0;">🔍</span><input type="text" id="journalSearch" placeholder="Search entries, moods, lessons..." oninput="filterJournal()" style="background:none;border:none;padding:0;font-size:13px;color:var(--text);outline:none;width:100%;"></div>
            <div class="journal-mood-filter">
              <button class="jmood-btn active" onclick="filterByMood('all',this)">All</button>
              <button class="jmood-btn" onclick="filterByMood('Confident',this)">🟢 Confident</button>
              <button class="jmood-btn" onclick="filterByMood('Neutral',this)">🟡 Neutral</button>
              <button class="jmood-btn" onclick="filterByMood('Anxious',this)">🔴 Anxious</button>
              <button class="jmood-btn" onclick="filterByMood('Calm',this)">🔵 Calm</button>
              <button class="jmood-btn" onclick="filterByMood('Frustrated',this)">🟠 Frustrated</button>
            </div>
            <div class="journal-view-toggle">
              <button class="jview-btn active" id="jview-cards" onclick="setJournalView('cards',this)" title="Cards">☰</button>
              <button class="jview-btn" id="jview-timeline" onclick="setJournalView('timeline',this)" title="Timeline">≡</button>
            </div>
          </div>
          <div class="card" style="margin-bottom:14px;">
            <div class="card-title">📅 Mood Calendar — 7 Weeks <span class="ctag">Click cell to view entry</span></div>
            <div class="jcal-days-header"><span>Sun</span><span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span></div>
            <div class="jcal-grid" id="jCalGrid"></div>
            <div class="jcal-legend">
              <span class="jcal-leg-item"><span class="jcal-dot" style="background:rgba(0,232,122,0.8)"></span>Confident</span>
              <span class="jcal-leg-item"><span class="jcal-dot" style="background:rgba(61,155,255,0.8)"></span>Calm</span>
              <span class="jcal-leg-item"><span class="jcal-dot" style="background:rgba(245,166,35,0.8)"></span>Neutral</span>
              <span class="jcal-leg-item"><span class="jcal-dot" style="background:rgba(255,59,59,0.8)"></span>Anxious</span>
              <span class="jcal-leg-item"><span class="jcal-dot" style="background:rgba(255,120,50,0.8)"></span>Frustrated</span>
            </div>
          </div>
          <div class="ai-card" id="jAiInsightsCard" style="margin-bottom:14px;display:none;">
            <div class="ai-header"><div class="ai-icon">🤖</div><div><div class="ai-meta-label">AI Wolf Coach</div><div class="ai-meta-title">Journal Analysis</div></div><div class="ai-acts"><button class="ai-btn ai-btn-s" onclick="document.getElementById('jAiInsightsCard').style.display='none'">✕ Close</button></div></div>
            <div class="ai-output" id="jAiInsightsOutput" style="min-height:60px;"></div>
          </div>
          <div id="journalList" class="journal-cards-view"></div>
          <div id="journalEmpty" style="display:none;"><div class="empty" style="padding:80px 20px;"><div class="empty-ic">📓</div><div class="empty-txt">No journal entries yet.</div><button class="btn btn-p" style="margin-top:16px;" onclick="openJournalModal()">📓 Write First Entry</button></div></div>
        </div>

        <!-- RULES -->
        <div class="page" id="pg-rules">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;"><h3 style="font-family:var(--fd);font-size:24px;letter-spacing:1px;color:var(--text);">Wolf Rules</h3><button class="btn btn-p" onclick="openRuleModal()">+ Add Rule</button></div>
          <div id="rulesList"></div>
        </div>

        <!-- AI REPORTS -->
        <div class="page" id="pg-reports">
          <div class="ai-card">
            <div class="ai-header"><div class="ai-icon">🤖</div><div><div class="ai-meta-label">AI Wolf Coach</div><div class="ai-meta-title">Performance Analysis</div></div><div class="ai-acts"><button class="ai-btn ai-btn-p" id="genReportBtn" onclick="generateAIReport()">⚡ Analyse</button><button class="ai-btn ai-btn-s" onclick="clearReports()">🗑 Clear</button></div></div>
            <div class="ai-output" id="aiReportOutput"><div class="ai-empty"><div style="font-size:36px;margin-bottom:10px;">🤖</div><div style="font-size:13px;font-weight:700;color:var(--muted);margin-bottom:4px;">No analysis yet</div><div style="font-size:12px;color:var(--muted);">Log 3+ trades, then click Analyse.</div></div></div>
          </div>
          <div class="card"><div class="card-title">Report History <span class="ctag" id="reportHistCount">0 reports</span></div><div id="reportHistory"></div></div>
        </div>

        <!-- RISK CALCULATOR -->
        <div class="page" id="pg-risk">
          <div class="wolf-quote-bar"><div class="wolf-quote-text">A wolf calculates before striking. Know your risk. Protect the hunt.</div></div>
          <div class="risk-calc-card">
            <div class="card-title" style="color:var(--g1);font-family:var(--fd);font-size:20px;margin-bottom:16px;">⚖️ Smart Risk Calculator</div>
            <div class="fr c3">
              <div class="fgi"><label>Capital (₹)</label><input type="number" id="rc-capital" placeholder="500000" oninput="calcRisk()"></div>
              <div class="fgi"><label>Risk % per trade</label><input type="number" id="rc-riskpct" placeholder="1" step="0.1" value="1" oninput="calcRisk()"></div>
              <div class="fgi"><label>Entry Price</label><input type="number" id="rc-entry" placeholder="0.00" oninput="calcRisk()"></div>
            </div>
            <div class="fr c3">
              <div class="fgi"><label>Stop Loss</label><input type="number" id="rc-sl" placeholder="0.00" oninput="calcRisk()"></div>
              <div class="fgi"><label>Target</label><input type="number" id="rc-target" placeholder="0.00" oninput="calcRisk()"></div>
              <div class="fgi"><label>Instrument</label><select id="rc-inst" onchange="calcRisk()"><option value="1">Equity (1x)</option><option value="50">NIFTY F&O (50 lot)</option><option value="25">BANKNIFTY (25 lot)</option><option value="15">FINNIFTY (15 lot)</option></select></div>
            </div>
            <div class="risk-result-grid" id="riskResults">
              <div class="risk-result-item"><div class="risk-result-lbl">Max Risk Amount</div><div class="risk-result-val" id="rr-amount">₹0</div></div>
              <div class="risk-result-item"><div class="risk-result-lbl">Recommended Qty</div><div class="risk-result-val" id="rr-qty">0</div></div>
              <div class="risk-result-item"><div class="risk-result-lbl">R:R Ratio</div><div class="risk-result-val" id="rr-ratio">—</div></div>
              <div class="risk-result-item"><div class="risk-result-lbl">Potential Profit</div><div class="risk-result-val" id="rr-profit" style="color:var(--g1);">₹0</div></div>
              <div class="risk-result-item"><div class="risk-result-lbl">Max Loss</div><div class="risk-result-val" id="rr-loss" style="color:var(--red);">₹0</div></div>
              <div class="risk-result-item"><div class="risk-result-lbl">Verdict</div><div class="risk-result-val" id="rr-verdict" style="font-size:14px;">—</div></div>
            </div>
          </div>
          <div class="card">
            <div class="card-title">📊 Risk Rules — Wolf Code</div>
            <div class="kv-row"><span class="kv-key">Max daily loss limit</span><span class="kv-val" id="rr-daily">—</span></div>
            <div class="kv-row"><span class="kv-key">Max weekly drawdown</span><span class="kv-val" id="rr-weekly">—</span></div>
            <div class="kv-row"><span class="kv-key">Trades to recover 1% loss</span><span class="kv-val" id="rr-recover">—</span></div>
            <div style="margin-top:12px;padding:12px;background:var(--g6);border-radius:var(--r2);font-size:12px;color:var(--text2);line-height:1.7;">🐺 <strong>Wolf Risk Rule:</strong> Never risk more than 1% per trade. After 3 losses in a day, STOP. The wolf lives to hunt tomorrow.</div>
          </div>
        </div>

        <!-- PRE-TRADE COACH -->
        <div class="page" id="pg-pretrade">
          <div class="wolf-quote-bar"><div class="wolf-quote-text">Before you strike — ask the Wolf. AI checks your setup against your history.</div></div>
          <div class="pretrade-card">
            <div class="ai-header" style="margin-bottom:14px;"><div class="ai-icon">🤖</div><div><div class="ai-meta-label">Pre-Trade Analysis</div><div class="ai-meta-title">Should I Take This Trade?</div></div></div>
            <div class="fr c2">
              <div class="fgi"><label>Symbol</label><input type="text" id="pt-symbol" placeholder="NIFTY, RELIANCE..." oninput="this.value=this.value.toUpperCase()"></div>
              <div class="fgi"><label>Setup Type</label><select id="pt-setup"><option>Breakout</option><option>Pullback</option><option>Reversal</option><option>Momentum</option><option>Range</option><option>Gap Fill</option></select></div>
            </div>
            <div class="fr c3">
              <div class="fgi"><label>Entry</label><input type="number" id="pt-entry" placeholder="0.00"></div>
              <div class="fgi"><label>Stop Loss</label><input type="number" id="pt-sl" placeholder="0.00"></div>
              <div class="fgi"><label>Target</label><input type="number" id="pt-target" placeholder="0.00"></div>
            </div>
            <div class="fr c2">
              <div class="fgi"><label>Current Emotion</label><select id="pt-emotion"><option>Confident</option><option>Calm</option><option>Focused</option><option>FOMO</option><option>Fearful</option><option>Greedy</option><option>Revenge</option></select></div>
              <div class="fgi"><label>Market Mood</label><select id="pt-market"><option>Bullish 📈</option><option>Bearish 📉</option><option>Sideways ↔️</option><option>Volatile ⚡</option></select></div>
            </div>
            <div style="display:flex;gap:8px;margin-top:4px;">
              <button class="btn btn-p" style="flex:1;" onclick="runPreTradeAI()">🤖 Ask Wolf AI — Should I Trade?</button>
              <button class="btn btn-s" onclick="clearPreTrade()">Clear</button>
            </div>
            <div id="preTradeResult" style="display:none;"></div>
          </div>
          <div class="card"><div class="card-title">📈 Your Setup Win Rates</div><div id="setupWinRates"></div></div>
        </div>

        <!-- SETTINGS -->
        <div class="page" id="pg-settings">
          <div class="g2">
            <div>
              <div class="settings-card">
                <div class="settings-title">👤 Wolf Identity</div>
                <div class="kv-row"><span class="kv-key">Name</span><span class="kv-val" id="set-name">—</span></div>
                <div class="kv-row"><span class="kv-key">Email</span><span class="kv-val" id="set-email">—</span></div>
                <div class="kv-row"><span class="kv-key">Plan</span><span class="kv-val" style="color:var(--g1);">Pro Wolf</span></div>
                <div class="kv-row"><span class="kv-key">Wolf Rank</span><span class="kv-val" id="set-rank">—</span></div>
              </div>
              <div class="settings-card">
                <div class="settings-title">📊 Hunt Stats</div>
                <div class="kv-row"><span class="kv-key">Total Trades</span><span class="kv-val" id="set-trades">0</span></div>
                <div class="kv-row"><span class="kv-key">Win Rate</span><span class="kv-val" id="set-wr">0%</span></div>
                <div class="kv-row"><span class="kv-key">Total P&L</span><span class="kv-val" id="set-pnl">₹0</span></div>
                <div class="kv-row"><span class="kv-key">AI Reports</span><span class="kv-val" id="set-reports">0</span></div>
              </div>
            </div>
            <div>
              <div class="settings-card">
                <div class="settings-title">⚙️ Preferences</div>
                <div style="display:flex;flex-direction:column;gap:8px;">
                  <button class="btn btn-s" onclick="toggleTheme()" style="justify-content:flex-start;"><span id="themeIc2">🌙</span><span id="themeLabel2">Switch to Light</span></button>
                  <button class="btn btn-red" onclick="clearAllTrades()" style="justify-content:flex-start;">🗑 Clear All Trades</button>
                  <button class="btn btn-red" onclick="doLogout()" style="justify-content:flex-start;">🚪 Logout</button>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- TRADE MODAL -->
<div class="modal-overlay" id="tradeModal">
  <div class="modal modal-lg">
    <div class="trade-modal-header">
      <div class="trade-modal-wolf">🐺</div>
      <div><div class="modal-title" id="tradeModalTitle">⚔️ Log New Trade</div><div style="font-size:11px;color:var(--muted);">Every trade shapes your wolf</div></div>
      <button class="close-btn" style="margin-left:auto;" onclick="closeModal('tradeModal')">✕</button>
    </div>
    <div class="modal-body">
      <button class="voice-btn" id="voiceEntryBtn" onclick="startVoiceEntry()">🎤 Voice Entry — बोलून trade log करा (Beta)</button>
      <div class="trade-pnl-live">
        <div class="tpl-item"><div class="tpl-item-lbl">Live P&L</div><div class="tpl-item-val" id="pnlPreview" style="color:var(--g1)">₹0</div></div>
        <div class="tpl-item"><div class="tpl-item-lbl">Disc Score</div><div class="tpl-item-val" id="discPreview" style="color:var(--amber)">0%</div></div>
        <div class="tpl-item"><div class="tpl-item-lbl">Exec Points</div><div class="tpl-item-val" id="execScore" style="color:var(--blue)">0</div><div style="font-size:10px;color:var(--muted);">of 11</div></div>
      </div>
      <div class="tab-bar">
        <div class="tab active" onclick="switchTradeTab('basic',this)">📊 Basic</div>
        <div class="tab" onclick="switchTradeTab('exec',this)">✅ Execution</div>
        <div class="tab" onclick="switchTradeTab('psych',this)">🧠 Psychology</div>
      </div>
      <div id="tt-basic">
        <div class="fr c2">
          <div class="fgi"><label>Date <span class="req-star">*</span></label><input type="date" id="t-date"><div class="field-err-msg" id="err-date">Required</div></div>
          <div class="fgi"><label>Symbol <span class="req-star">*</span></label><input type="text" id="t-symbol" placeholder="NIFTY, RELIANCE..." oninput="this.value=this.value.toUpperCase()"><div class="field-err-msg" id="err-symbol">Required</div></div>
        </div>
        <div class="fr c3">
          <div class="fgi"><label>Setup</label><select id="t-setup"><option value="">Select</option><option>Breakout</option><option>Pullback</option><option>Reversal</option><option>Momentum</option><option>Range</option><option>Gap Fill</option><option>VWAP Bounce</option><option>OB Retest</option></select></div>
          <div class="fgi"><label>Side</label><select id="t-side"><option value="LONG">LONG 📈</option><option value="SHORT">SHORT 📉</option></select></div>
          <div class="fgi"><label>Session</label><select id="t-session"><option value="">Select</option><option>Morning (9:15-11:30)</option><option>Midday (11:30-1:30)</option><option>Afternoon (1:30-3:30)</option></select></div>
        </div>
        <div class="fr c4">
          <div class="fgi"><label>Entry <span class="req-star">*</span></label><input type="number" id="t-entry" placeholder="0.00" step="0.05" oninput="updatePNLPreview()"><div class="field-err-msg" id="err-entry">Required</div></div>
          <div class="fgi"><label>Exit <span class="req-star">*</span></label><input type="number" id="t-exit" placeholder="0.00" step="0.05" oninput="updatePNLPreview()"><div class="field-err-msg" id="err-exit">Required</div></div>
          <div class="fgi"><label>Stop Loss</label><input type="number" id="t-sl" placeholder="0.00" step="0.05"></div>
          <div class="fgi"><label>Target</label><input type="number" id="t-target" placeholder="0.00" step="0.05"></div>
        </div>
        <div class="fr c2">
          <div class="fgi"><label>Qty / Lots <span class="req-star">*</span></label><input type="number" id="t-qty" placeholder="1" oninput="updatePNLPreview()"><div class="field-err-msg" id="err-qty">Required</div></div>
          <div class="fgi"><label>Instrument</label><select id="t-inst"><option value="Equity">Equity</option><option value="F&O">F&O</option><option value="Commodity">Commodity</option><option value="Currency">Currency</option><option value="Crypto">Crypto</option></select></div>
        </div>
        <div class="fgi"><label>Trade Notes</label><textarea id="t-notes" placeholder="Setup rationale, market context..." rows="2"></textarea></div>
      </div>
      <div id="tt-exec" style="display:none;">
        <div style="font-size:12px;color:var(--text2);margin-bottom:10px;padding:8px 12px;background:var(--g6);border-radius:var(--r2);border:1px solid rgba(0,232,122,.1);">⚠️ Min 6/11 required to save. A wolf does not enter without a plan.</div>
        <div class="checklist" id="execChecklist"></div>
        <div class="fgi" style="margin-top:12px;"><label>Execution Notes</label><textarea id="t-execNotes" placeholder="What worked in your execution?" rows="2"></textarea></div>
      </div>
      <div id="tt-psych" style="display:none;">
        <div class="psych-grid">
          <div><div class="psych-hd"><span class="psych-lbl">Confidence</span><span class="psych-sc" id="sc-conf">5</span></div><input type="range" id="r-conf" min="1" max="10" value="5" oninput="updateRange('conf')"></div>
          <div><div class="psych-hd"><span class="psych-lbl">Focus</span><span class="psych-sc" id="sc-focus">5</span></div><input type="range" id="r-focus" min="1" max="10" value="5" oninput="updateRange('focus')"></div>
          <div><div class="psych-hd"><span class="psych-lbl">Patience</span><span class="psych-sc" id="sc-pat">5</span></div><input type="range" id="r-pat" min="1" max="10" value="5" oninput="updateRange('pat')"></div>
          <div><div class="psych-hd"><span class="psych-lbl">Calm</span><span class="psych-sc" id="sc-calm">5</span></div><input type="range" id="r-calm" min="1" max="10" value="5" oninput="updateRange('calm')"></div>
        </div>
        <div class="fgi" style="margin-bottom:12px;"><label>Emotion <span class="req-star">*</span></label><div class="emo-row" id="emoRow"></div><div class="field-err-msg" id="err-emotion">Select an emotion</div></div>
        <div class="fgi" style="margin-bottom:10px;"><label>Psychological Notes</label><textarea id="t-psychNotes" placeholder="How were you feeling? Any mental blocks?" rows="2"></textarea></div>
        <div class="fgi"><label>Lesson Learned</label><textarea id="t-lesson" placeholder="What does this trade teach you?" rows="2"></textarea></div>
      </div>
    </div>
    <div class="modal-ft">
      <button class="btn btn-s" onclick="closeModal('tradeModal')">Cancel</button>
      <button class="btn btn-p" onclick="saveTrade()">🐺 Save Trade</button>
    </div>
  </div>
</div>

<!-- JOURNAL MODAL -->
<div class="modal-overlay" id="journalModal">
  <div class="modal" style="max-width:680px;width:100%;">
    <div style="padding:20px 22px 0;display:flex;align-items:flex-start;gap:12px;background:linear-gradient(135deg,rgba(0,232,122,.04),transparent);position:relative;overflow:hidden;">
      <div style="position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--g1),transparent);opacity:.4;"></div>
      <div style="flex:1;"><div style="font-size:10px;font-weight:900;color:var(--g1);letter-spacing:3px;text-transform:uppercase;margin-bottom:4px;font-family:var(--fm);">🐺 Wolf Reflection</div><div class="modal-title" id="journalModalTitle">📓 New Journal Entry</div><div style="font-size:11px;color:var(--muted);">The wolf who reflects daily evolves fastest.</div></div>
      <button class="close-btn" style="margin-left:auto;" onclick="closeModal('journalModal')">✕</button>
    </div>
    <div class="modal-body" style="padding-top:16px;">
      <div class="fr c2" style="margin-bottom:14px;">
        <div class="fgi"><label>Date</label><input type="date" id="j-date"></div>
        <div class="fgi">
          <label>Trading Mood</label>
          <div id="jMoodSelector" style="display:grid;grid-template-columns:repeat(5,1fr);gap:5px;margin-top:4px;">
            <div class="jms-option active" data-mood="🟢 Confident" onclick="selectJournalMood(this)" style="display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 4px;border-radius:var(--r2);border:1px solid var(--border2);cursor:pointer;background:var(--g4);border-color:rgba(0,232,122,.4);transition:all .14s;"><span style="font-size:16px;">🟢</span><span style="font-size:9px;font-weight:700;color:var(--g1);">Confident</span></div>
            <div class="jms-option" data-mood="🔵 Calm" onclick="selectJournalMood(this)" style="display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 4px;border-radius:var(--r2);border:1px solid var(--border2);cursor:pointer;background:var(--bg2);transition:all .14s;"><span style="font-size:16px;">🔵</span><span style="font-size:9px;font-weight:700;color:var(--muted);">Calm</span></div>
            <div class="jms-option" data-mood="🟡 Neutral" onclick="selectJournalMood(this)" style="display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 4px;border-radius:var(--r2);border:1px solid var(--border2);cursor:pointer;background:var(--bg2);transition:all .14s;"><span style="font-size:16px;">🟡</span><span style="font-size:9px;font-weight:700;color:var(--muted);">Neutral</span></div>
            <div class="jms-option" data-mood="🟠 Frustrated" onclick="selectJournalMood(this)" style="display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 4px;border-radius:var(--r2);border:1px solid var(--border2);cursor:pointer;background:var(--bg2);transition:all .14s;"><span style="font-size:16px;">🟠</span><span style="font-size:9px;font-weight:700;color:var(--muted);">Frustrated</span></div>
            <div class="jms-option" data-mood="🔴 Anxious" onclick="selectJournalMood(this)" style="display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 4px;border-radius:var(--r2);border:1px solid var(--border2);cursor:pointer;background:var(--bg2);transition:all .14s;"><span style="font-size:16px;">🔴</span><span style="font-size:9px;font-weight:700;color:var(--muted);">Anxious</span></div>
          </div>
          <input type="hidden" id="j-mood" value="🟢 Confident">
        </div>
      </div>
      <div class="tab-bar" style="margin-bottom:14px;">
        <div class="tab active" onclick="switchJournalTab('reflect',this)">🪞 Reflect</div>
        <div class="tab" onclick="switchJournalTab('trade',this)">⚔️ Trade Day</div>
        <div class="tab" onclick="switchJournalTab('mindset',this)">🧠 Mindset</div>
        <div class="tab" onclick="switchJournalTab('tomorrow',this)">🎯 Tomorrow</div>
      </div>
      <div id="jt-reflect">
        <div class="fgi" style="margin-bottom:12px;"><label>Entry Title</label><input type="text" id="j-title" placeholder="e.g. Day of discipline, Revenge trade avoided..."></div>
        <div class="fgi" style="margin-bottom:6px;"><label>Free Reflection ✍️</label><textarea id="j-body" rows="7" placeholder="Aaj kya hua? Kaise feel kiya? Market ne kya sikhaaya?" oninput="updateJournalCharCount()"></textarea></div>
        <div style="font-size:10px;color:var(--muted);text-align:right;font-family:var(--fm);margin-bottom:4px;"><span id="jCharCount">0</span> chars · <span id="jWordCount">0</span> words</div>
      </div>
      <div id="jt-trade" style="display:none;">
        <div class="fr c2" style="margin-bottom:12px;">
          <div class="fgi"><label>Market Condition</label><select id="j-market"><option value="">Select...</option><option>Trending Up 📈</option><option>Trending Down 📉</option><option>Range Bound ↔️</option><option>High Volatile ⚡</option><option>Choppy — No Direction</option></select></div>
          <div class="fgi"><label>P&L Feel</label><select id="j-pnl-feel"><option value="">Select...</option><option>🟢 Strong Profit Day</option><option>🟡 Small Win</option><option>⚪ Breakeven</option><option>🟠 Small Loss</option><option>🔴 Heavy Loss Day</option><option>⛔ No Trades Today</option></select></div>
        </div>
        <div class="fgi" style="margin-bottom:12px;"><label>Best Trade / Best Moment</label><textarea id="j-best-trade" rows="2" placeholder="What went RIGHT?"></textarea></div>
        <div class="fgi" style="margin-bottom:12px;"><label>Worst Trade / Mistake</label><textarea id="j-worst-trade" rows="2" placeholder="What went WRONG? Brutal honesty."></textarea></div>
        <div class="fgi">
          <label>Rules Followed Today?</label>
          <div id="jRulesCheck" style="display:flex;flex-direction:column;gap:6px;">
            <div class="jrc-item" onclick="toggleJRC(this)"><div class="jrc-box">□</div><span>Followed my trade plan completely</span></div>
            <div class="jrc-item" onclick="toggleJRC(this)"><div class="jrc-box">□</div><span>Respected all stop losses</span></div>
            <div class="jrc-item" onclick="toggleJRC(this)"><div class="jrc-box">□</div><span>No revenge trades today</span></div>
            <div class="jrc-item" onclick="toggleJRC(this)"><div class="jrc-box">□</div><span>No FOMO entries</span></div>
            <div class="jrc-item" onclick="toggleJRC(this)"><div class="jrc-box">□</div><span>Proper position sizing maintained</span></div>
          </div>
        </div>
      </div>
      <div id="jt-mindset" style="display:none;">
        <div style="margin-bottom:14px;">
          <label>Mental Energy Level Today</label>
          <div style="display:flex;align-items:center;gap:12px;margin-top:8px;margin-bottom:4px;">
            <input type="range" id="j-energy" min="1" max="10" value="7" oninput="updateJEnergy()" style="flex:1;">
            <div style="display:flex;align-items:baseline;gap:2px;min-width:40px;"><span id="jEnergyVal" style="font-family:var(--fd);font-size:32px;color:var(--g1);line-height:1;">7</span><span style="font-size:10px;color:var(--muted);">/10</span></div>
          </div>
        </div>
        <div class="fgi" style="margin-bottom:12px;">
          <label>Emotional Triggers Today</label>
          <div id="jTriggerGrid" style="display:flex;flex-wrap:wrap;gap:7px;margin-top:4px;">
            <div class="jtrig-chip" onclick="toggleTrigger(this)">FOMO</div>
            <div class="jtrig-chip" onclick="toggleTrigger(this)">Revenge Impulse</div>
            <div class="jtrig-chip" onclick="toggleTrigger(this)">Overconfidence</div>
            <div class="jtrig-chip" onclick="toggleTrigger(this)">Analysis Paralysis</div>
            <div class="jtrig-chip" onclick="toggleTrigger(this)">Early Exit Fear</div>
            <div class="jtrig-chip" onclick="toggleTrigger(this)">Loss Aversion</div>
            <div class="jtrig-chip" onclick="toggleTrigger(this)">Impatience</div>
            <div class="jtrig-chip" onclick="toggleTrigger(this)">Market Distraction</div>
            <div class="jtrig-chip jtrig-none" onclick="toggleTrigger(this)">✅ None Today</div>
          </div>
        </div>
        <div class="fgi" style="margin-bottom:12px;"><label>Biggest Mental Lesson Today</label><textarea id="j-mental-lesson" rows="3" placeholder="Apni psychology mein kya discover kiya aaj?"></textarea></div>
        <div class="fgi"><label>Wolf Gratitude 🙏</label><textarea id="j-gratitude" rows="2" placeholder="Ek cheez jiske liye grateful ho aaj as a trader..."></textarea></div>
      </div>
      <div id="jt-tomorrow" style="display:none;">
        <div class="fgi" style="margin-bottom:12px;"><label>Tomorrow's Key Intention</label><input type="text" id="j-intention" placeholder="e.g. Only 2 high-quality setups..."></div>
        <div class="fgi" style="margin-bottom:12px;"><label>Watchlist / Setups to Scout</label><textarea id="j-watchlist" rows="2" placeholder="e.g. NIFTY 22000 support zone..."></textarea></div>
        <div class="fgi" style="margin-bottom:14px;"><label>One Wolf Rule to Focus On Tomorrow</label><input type="text" id="j-rule-focus" placeholder="e.g. Wait for 5 min confirmation candle before entry."></div>
        <div style="background:linear-gradient(135deg,#020d05,#041208);border:1px solid rgba(0,232,122,.2);border-radius:var(--r3);padding:16px;text-align:center;">
          <div style="font-size:10px;font-weight:900;color:var(--g1);letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;font-family:var(--fm);">🐺 Wolf Affirmation</div>
          <div id="jAffirmationText" style="font-family:var(--fd);font-size:18px;color:var(--text);line-height:1.4;letter-spacing:.5px;margin-bottom:10px;">Loading...</div>
          <button onclick="refreshAffirmation()" style="background:none;border:1px solid rgba(0,232,122,.2);border-radius:99px;padding:4px 12px;font-size:11px;font-weight:700;color:var(--g1);cursor:pointer;font-family:var(--fb);">↻ New Affirmation</button>
        </div>
      </div>
    </div>
    <div class="modal-ft" style="justify-content:space-between;flex-wrap:wrap;gap:8px;">
      <button class="btn btn-s" onclick="closeModal('journalModal')">Cancel</button>
      <div style="display:flex;gap:8px;">
        <button class="btn btn-s" onclick="getAIJournalHint()">🤖 AI Hint</button>
        <button class="btn btn-p" onclick="saveJournal()">📓 Save Entry</button>
      </div>
    </div>
    <div id="jAiHint" style="display:none;padding:0 22px 16px;"><div style="background:rgba(0,232,122,.05);border:1px solid rgba(0,232,122,.15);border-radius:var(--r3);padding:12px;font-size:12px;color:var(--text2);line-height:1.75;" id="jAiHintText"></div></div>
  </div>
</div>

<!-- RULE MODAL -->
<div class="modal-overlay" id="ruleModal">
  <div class="modal modal-sm">
    <div class="modal-hd"><div class="modal-title">📌 Wolf Rule</div><button class="close-btn" onclick="closeModal('ruleModal')">✕</button></div>
    <div class="modal-body">
      <div class="fgi" style="margin-bottom:10px;"><label>Rule</label><textarea id="r-rule" rows="3" placeholder="e.g. Never trade after 2 consecutive losses."></textarea></div>
      <div class="fgi"><label>Category</label><select id="r-cat"><option value="Entry">Entry Rules</option><option value="Exit">Exit Rules</option><option value="Risk">Risk Management</option><option value="Psychology">Psychology</option><option value="Setup">Setup Rules</option></select></div>
    </div>
    <div class="modal-ft"><button class="btn btn-s" onclick="closeModal('ruleModal')">Cancel</button><button class="btn btn-p" onclick="saveRule()">📌 Add Rule</button></div>
  </div>
</div>

<!-- FORGOT PASSWORD MODAL -->
<div class="modal-overlay" id="forgotModal">
  <div class="modal modal-sm">
    <div class="modal-hd"><div class="modal-title">🔑 Reset Password</div><button class="close-btn" onclick="closeModal('forgotModal')">✕</button></div>
    <div class="modal-body">
      <p style="font-size:13px;color:var(--text2);margin-bottom:14px;line-height:1.6;">Email टाका. Reset link पाठवतो.</p>
      <div class="fgi" style="margin-bottom:10px;"><label>Email</label><input type="email" id="forgot-email" placeholder="your@email.com"></div>
      <div id="forgot-msg" style="font-size:12px;display:none;margin-bottom:10px;"></div>
    </div>
    <div class="modal-ft"><button class="btn btn-s" onclick="closeModal('forgotModal')">Cancel</button><button class="btn btn-p" onclick="sendForgotEmail()" id="forgotBtn">📧 Send Reset Link</button></div>
  </div>
</div>

<!-- WOLF EVOLUTION MODAL -->
<div class="modal-overlay" id="wolfModal">
  <div class="modal modal-sm">
    <div class="wolf-modal-inner">
      <div class="wolf-evo-particles" id="wolfParticles"></div>
      <span class="wolf-evo-emoji" id="wolfModalEmoji">🐺</span>
      <div class="wolf-evo-badge">EVOLUTION UNLOCKED</div>
      <div class="wolf-evo-title" id="wolfModalTitle">You Are a Wolf</div>
      <p class="wolf-evo-msg" id="wolfModalMsg">The hunt has begun. Stay disciplined.</p>
      <button class="btn btn-p" style="width:100%;" onclick="closeModal('wolfModal')">🐺 Continue Hunting</button>
    </div>
  </div>
</div>

<div class="pwa-banner hidden" id="pwaBanner">
  <span style="font-size:24px;">🐺</span>
  <div><div style="font-weight:800;font-size:13px;">Install TradeMind App</div><div style="font-size:11px;color:var(--muted);">Phone वर install करा!</div></div>
  <button class="pwa-install-btn" onclick="installPWA()">Install</button>
  <button class="pwa-dismiss" onclick="dismissPWA()">×</button>
</div>
<div class="toast" id="toast"></div>

<script>
window.TF_CONFIG = window.TF_CONFIG || { SUPABASE_URL:'', SUPABASE_ANON:'', RAZORPAY_KEY:'' };
const SB_URL=TF_CONFIG.SUPABASE_URL, SB_ANON=TF_CONFIG.SUPABASE_ANON, RAZORPAY_KEY=TF_CONFIG.RAZORPAY_KEY||'';
const {createClient}=supabase;
const sb=(SB_URL&&!SB_URL.includes('YOUR_SUPABASE'))?createClient(SB_URL,SB_ANON):createClient('https://placeholder.supabase.co','placeholder');
let CU=null,CUD=null,editTradeId=null,selectedEmo='';

const WOLF_QUOTES=['The weak trader asks "Should I enter?" The wolf already knows.','Every loss is tuition. Every win is proof. Log both with honesty.','A wolf doesn\'t FOMO. It waits. Then strikes.','Discipline today. Freedom forever.','Your P&L is just a mirror. What does it show you?','The market is not your enemy. Your emotions are.','Stop-losses are not failure. They are wisdom.','A wolf who breaks his own rules becomes prey.','Trade the plan. Judge the execution. Not the result.','One bad trade never destroyed a trader. A hundred impulsive ones did.','Patience is not passive. It is the sharpest edge.','The alpha doesn\'t trade for excitement. He trades for edge.','Revenge trading is the prey\'s instinct. Rise above it.','Your journal is your evolution map. Write in it every day.','Consistency in small things builds mastery in big ones.'];

const CHECKS=[{id:'trend',label:'Trend confirmed on higher timeframe',cat:'Setup'},{id:'support',label:'Key S/R level identified',cat:'Setup'},{id:'volume',label:'Volume confirmation present',cat:'Confirm'},{id:'candle',label:'Entry candle pattern valid',cat:'Confirm'},{id:'sl_placed',label:'Stop loss placed before entry',cat:'Risk'},{id:'risk1pct',label:'Risk ≤ 1% of capital',cat:'Risk'},{id:'rr_min',label:'R:R ratio ≥ 1.5',cat:'Risk'},{id:'no_news',label:'No major news at entry time',cat:'Market'},{id:'session_ok',label:'Traded in preferred session',cat:'Market'},{id:'no_revenge',label:'Not a revenge/FOMO trade',cat:'Psych'},{id:'plan_followed',label:'Followed predefined trade plan',cat:'Psych'}];

const EMOTIONS=[{label:'Confident',cls:'sp'},{label:'Calm',cls:'sp'},{label:'Patient',cls:'sp'},{label:'Focused',cls:'sp'},{label:'Greedy',cls:'sn'},{label:'Fearful',cls:'sn'},{label:'FOMO',cls:'sn'},{label:'Revenge',cls:'sn'},{label:'Bored',cls:'su'},{label:'Neutral',cls:'su'},{label:'Excited',cls:'su'}];

const WOLF_STAGES=[{min:0,max:40,name:'Cub',emoji:'🐾',title:'You Are a Cub',sub:'Every legend starts here. Log trades. Build the habit.',rank:'CUB TRADER'},{min:40,max:65,name:'Wolf',emoji:'🐺',title:'You Are a Wolf',sub:'You have found your path. The hunt has begun.',rank:'WOLF TRADER'},{min:65,max:85,name:'Alpha',emoji:'⚡',title:'You Are an Alpha',sub:'Leading the pack. Sharp and consistent.',rank:'ALPHA WOLF'},{min:85,max:101,name:'Legendary',emoji:'🏆',title:'You Are Legendary',sub:'Apex predator. Only the elite reach here.',rank:'LEGENDARY WOLF'}];

const DAILY_CHALLENGES=[{id:'log_trade',ic:'📊',title:'Log a Trade',sub:'Record at least one trade today',xp:50,check:d=>d.trades.filter(t=>t.date===new Date().toISOString().split('T')[0]).length>0},{id:'journal_entry',ic:'📓',title:'Write Journal Entry',sub:'Reflect on today\'s trading session',xp:30,check:d=>d.journals.filter(j=>j.date===new Date().toISOString().split('T')[0]).length>0},{id:'full_checklist',ic:'✅',title:'Complete Full Checklist',sub:'Log a trade with all 11 points checked',xp:80,check:d=>{const today=new Date().toISOString().split('T')[0];return d.trades.filter(t=>t.date===today&&(t.violated||[]).length===0).length>0;}},{id:'high_disc',ic:'🐺',title:'Achieve 80%+ Discipline',sub:'Log a trade with discipline score ≥ 80%',xp:100,check:d=>{const today=new Date().toISOString().split('T')[0];return d.trades.filter(t=>t.date===today&&t.discScore>=80).length>0;}},{id:'add_rule',ic:'📌',title:'Define a Rule',sub:'Add a personal trading rule',xp:40,check:d=>d.rules.length>0}];

const getWolfStage=sc=>WOLF_STAGES.find(s=>sc>=s.min&&sc<s.max)||WOLF_STAGES[0];
const fmt=v=>'₹'+Math.abs(v).toLocaleString('en-IN');

function generateWolfInsights(trades){const insights=[];if(!trades.length)return insights;const emoMap={};trades.forEach(t=>{if(!emoMap[t.emotion])emoMap[t.emotion]={pnl:0,count:0};emoMap[t.emotion].pnl+=t.pnl;emoMap[t.emotion].count++;});const worstEmo=Object.entries(emoMap).sort((a,b)=>a[1].pnl-b[1].pnl)[0];if(worstEmo&&worstEmo[1].pnl<0)insights.push({ic:'🧠',text:`When you feel <strong>${worstEmo[0]}</strong>, avg P&L is ₹${Math.round(worstEmo[1].pnl/worstEmo[1].count).toLocaleString('en-IN')}. The wolf knows when not to hunt.`});const sesMap={};trades.forEach(t=>{if(!sesMap[t.session])sesMap[t.session]={pnl:0,count:0};sesMap[t.session].pnl+=t.pnl;sesMap[t.session].count++;});const worstSes=Object.entries(sesMap).filter(([k])=>k).sort((a,b)=>a[1].pnl-b[1].pnl)[0];if(worstSes&&worstSes[1].pnl<0)insights.push({ic:'⏰',text:`Your <strong>${worstSes[0]}</strong> session is bleeding money. Consider hunting in better conditions.`});const lowDiscLoss=trades.filter(t=>t.discScore<60&&t.pnl<0).length;const totalLow=trades.filter(t=>t.discScore<60).length;if(totalLow>2){const pct=Math.round(lowDiscLoss/totalLow*100);insights.push({ic:'⚠️',text:`<strong>${pct}%</strong> of your low-discipline trades result in losses. The checklist is not decoration.`});}const wr=Math.round(trades.filter(t=>t.pnl>0).length/trades.length*100);if(wr>=60)insights.push({ic:'🟢',text:`<strong>${wr}% win rate</strong> — excellent. Focus on maximizing R:R on winners.`});return insights.slice(0,4);}

async function sbProfile(uid){const{data}=await sb.from('profiles').select('*').eq('id',uid).single();return data;}
async function sbUpdateProfile(uid,obj){const{data}=await sb.from('profiles').update(obj).eq('id',uid).select().single();return data;}
function parseJournal(x){let body=x.body||'';let ext={};const m=body.match(/<!--\s*ext:([\s\S]*?)-->/);if(m){try{ext=JSON.parse(m[1].trim());}catch(e){}body=body.replace(/<!--\s*ext:[\s\S]*?-->/,'').trim();}return{id:x.id,date:x.date,mood:x.mood,title:x.title,body,_ext:ext};}
async function sbLoadData(uid){const[t,j,r]=await Promise.all([sb.from('trades').select('*').eq('user_id',uid).order('date',{ascending:false}),sb.from('journals').select('*').eq('user_id',uid).order('date',{ascending:false}),sb.from('rules').select('*').eq('user_id',uid).order('created_at')]);return{trades:(t.data||[]).map(dbToTrade),journals:(j.data||[]).map(parseJournal),rules:(r.data||[]).map(x=>({id:x.id,rule:x.rule,cat:x.category})),aiReports:[]};}
function dbToTrade(t){return{id:t.id,date:t.date,symbol:t.symbol,setup:t.setup,side:t.side,entry:parseFloat(t.entry),exit:parseFloat(t.exit),qty:parseFloat(t.qty),sl:parseFloat(t.sl||0),target:parseFloat(t.target||0),pnl:Math.round(parseFloat(t.pnl||0)),session:t.session,inst:t.instrument,notes:t.notes,discScore:parseFloat(t.disc_score||0),violated:t.violated||[],execNotes:t.exec_notes,confidence:t.confidence||5,focus:t.focus||5,patience:t.patience||5,calm:t.calm||5,emotion:t.emotion,psychNotes:t.psych_notes,lesson:t.lesson};}
function tradeToDb(uid,t){return{user_id:uid,date:t.date,symbol:t.symbol,setup:t.setup,side:t.side,entry:t.entry,exit:t.exit,qty:t.qty,sl:t.sl||null,target:t.target||null,pnl:t.pnl,session:t.session,instrument:t.inst,notes:t.notes,disc_score:t.discScore,violated:t.violated||[],exec_notes:t.execNotes,confidence:t.confidence,focus:t.focus,patience:t.patience,calm:t.calm,emotion:t.emotion,psych_notes:t.psychNotes,lesson:t.lesson};}

window.addEventListener('DOMContentLoaded',async()=>{
  const failsafeTimer=setTimeout(()=>{const l=document.getElementById('s-loading');if(l&&l.classList.contains('active')){l.classList.remove('active');document.getElementById('s-landing').classList.add('active');}},7000);
  const saved=localStorage.getItem('tf_theme')||'dark';document.documentElement.setAttribute('data-theme',saved);updateThemeUI(saved);
  let p=0;const bar=document.getElementById('loadBar');const statuses=['Awakening the wolf...','Loading discipline system...','Connecting to pack...','Almost ready...'];let si=0;
  const t=setInterval(()=>{p=Math.min(p+12,85);if(bar)bar.style.width=p+'%';if(p%25===0&&si<statuses.length){const el=document.getElementById('loadStatus');if(el)el.textContent=statuses[si++];}},80);
  const hash=window.location.hash;
  if(hash&&hash.includes('access_token')&&hash.includes('type=recovery')){clearTimeout(failsafeTimer);clearInterval(t);if(bar)bar.style.width='100%';await new Promise(r=>setTimeout(r,800));document.getElementById('s-loading').classList.remove('active');document.getElementById('s-reset').classList.add('active');history.replaceState(null,'',window.location.pathname);return;}
  sb.auth.onAuthStateChange(async(event,session)=>{if(event==='SIGNED_OUT'||event==='TOKEN_REFRESH_ERROR'){CU=null;CUD=null;goScreen('s-landing');return;}if(event==='USER_UPDATED'&&session){try{CU=await sbProfile(session.user.id);}catch(e){}}});
  try{
    const sessionPromise=sb.auth.getSession();const timeoutPromise=new Promise(r=>setTimeout(()=>r({data:{session:null},error:null}),5000));
    const{data:{session},error}=await Promise.race([sessionPromise,timeoutPromise]);clearTimeout(failsafeTimer);clearInterval(t);if(bar)bar.style.width='100%';await new Promise(r=>setTimeout(r,300));
    if(error||!session){goScreen('s-landing');return;}
    const profile=await sbProfile(session.user.id);if(!profile){await sb.auth.signOut();goScreen('s-landing');return;}
    CU=profile;CUD=await sbLoadData(session.user.id);
    initApp();
  } catch(e) {
    clearTimeout(failsafeTimer);
    goScreen('s-landing');
  }
});

function initApp() {
  renderWolfEvolution();
  renderDashboard();
  renderTradeList();
  renderAnalytics();
  renderJournal();
  renderRules();
  renderChallenges();
  renderReports();
  renderRiskCalc();
  renderPreTrade();
  renderSettings();
  renderLeaderboard();
  updateSidebar();
  renderWolfQuote();
  renderHeatmap();
  setInterval(renderWolfQuote, 30000);
  showPWABanner();
}

function goScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  const el = document.getElementById(id);
  if(el) el.classList.add('active');
}

function goPage(page) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.sb-item').forEach(i => i.classList.remove('active'));
  const pg = document.getElementById('pg-'+page);
  if(pg) pg.classList.add('active');
  const pages = {dashboard:'Dashboard',trades:'Trade Log',discipline:'Wolf Discipline',challenges:'Daily Challenges',analytics:'Analytics',reports:'AI Reports',journal:'Journal',rules:'Wolf Rules',risk:'Risk Calculator',pretrade:'Pre-Trade Coach',settings:'Settings'};
  const subs = {dashboard:'Your trading overview',trades:'Complete battle log',discipline:'Wolf evolution system',challenges:'Daily wolf missions',analytics:'Deep performance analysis',reports:'AI-powered insights',journal:'Mindset & reflections',rules:'Your personal trading code',risk:'Position size calculator',pretrade:'AI pre-trade analysis',settings:'Account & preferences'};
  document.getElementById('tbTitle').textContent = pages[page]||page;
  document.getElementById('tbSub').textContent = subs[page]||'';
  document.querySelectorAll('.sb-item').forEach(item => {
    if(item.getAttribute('onclick') && item.getAttribute('onclick').includes("'"+page+"'")) item.classList.add('active');
  });
  if(page==='journal') renderJournal();
  if(page==='analytics') renderAnalytics();
  if(page==='discipline') renderWolfEvolution();
  if(page==='challenges') renderChallenges();
  if(page==='pretrade') renderPreTrade();
}

function scrollToSec(id) {
  const el = document.getElementById(id);
  if(el) el.scrollIntoView({behavior:'smooth'});
}

function toggleTheme() {
  const curr = document.documentElement.getAttribute('data-theme')||'dark';
  const next = curr==='dark'?'light':'dark';
  document.documentElement.setAttribute('data-theme',next);
  localStorage.setItem('tf_theme',next);
  updateThemeUI(next);
}

function updateThemeUI(theme) {
  const ic = theme==='dark'?'🌙':'☀️';
  const lb = theme==='dark'?'Light Mode':'Dark Mode';
  ['landingThemeBtn'].forEach(id=>{const el=document.getElementById(id);if(el)el.textContent=theme==='dark'?'☀️':'🌙';});
  const ti=document.getElementById('themeIc');if(ti)ti.textContent=ic;
  const tl=document.getElementById('themeLabel');if(tl)tl.textContent=lb;
  const ti2=document.getElementById('themeIc2');if(ti2)ti2.textContent=theme==='dark'?'🌙':'☀️';
  const tl2=document.getElementById('themeLabel2');if(tl2)tl2.textContent=theme==='dark'?'Switch to Light':'Switch to Dark';
}

function showToast(msg, dur=3000) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), dur);
}

function openModal(id) { document.getElementById(id).classList.add('open'); }
function closeModal(id) { document.getElementById(id).classList.remove('open'); }

function toggleDropdown() {
  document.getElementById('sbDropdown').classList.toggle('open');
}

document.addEventListener('click', e => {
  if(!e.target.closest('.sb-foot')) {
    const d = document.getElementById('sbDropdown');
    if(d) d.classList.remove('open');
  }
});

// AUTH
function switchAuthTab(tab) {
  document.querySelectorAll('.auth-tab').forEach((t,i)=>t.classList.toggle('active', (i===0&&tab==='login')||(i===1&&tab==='register')));
  document.getElementById('form-login').classList.toggle('hidden', tab!=='login');
  document.getElementById('form-register').classList.toggle('hidden', tab!=='register');
  document.getElementById('auth-err').classList.remove('show');
}

function showAuthErr(msg) {
  const e = document.getElementById('auth-err');
  e.textContent = msg;
  e.classList.add('show');
}

async function doLogin() {
  const email = document.getElementById('li-email').value.trim();
  const pass = document.getElementById('li-pass').value;
  if(!email||!pass) return showAuthErr('Email aur password daalo');
  const btn = document.querySelector('#form-login .auth-btn');
  btn.disabled = true; btn.textContent = '🐺 Entering...';
  const{error}=await sb.auth.signInWithPassword({email,password:pass});
  btn.disabled = false; btn.textContent = '🐺 Enter the Pack';
  if(error) { showAuthErr(error.message); return; }
  const{data:{user}}=await sb.auth.getUser();
  CU=await sbProfile(user.id);
  if(!CU){await sb.auth.signOut();showAuthErr('Profile not found');return;}
  CUD=await sbLoadData(user.id);
  goScreen('s-app');
  initApp();
}

async function doRegister() {
  const name = document.getElementById('reg-name').value.trim();
  const email = document.getElementById('reg-email').value.trim();
  const pass = document.getElementById('reg-pass').value;
  if(!name||!email||!pass) return showAuthErr('Sab fields bharo');
  if(pass.length<6) return showAuthErr('Password min 6 characters');
  const btn = document.querySelector('#form-register .auth-btn');
  btn.disabled=true; btn.textContent='Creating...';
  const{data,error}=await sb.auth.signUp({email,password:pass,options:{data:{full_name:name}}});
  if(error){btn.disabled=false;btn.textContent='🐺 Create Wolf Account';showAuthErr(error.message);return;}
  if(data.user){
    await sb.from('profiles').upsert({id:data.user.id,email,full_name:name,plan:'trial',wolf_rank:'Cub',wolf_xp:0,streak:0,best_streak:0},{ onConflict:'id'});
    CU=await sbProfile(data.user.id);
    CUD=await sbLoadData(data.user.id);
    btn.disabled=false;btn.textContent='🐺 Create Wolf Account';
    goScreen('s-sub');
  }
}

async function doLogout() {
  await sb.auth.signOut();
  CU=null; CUD=null;
  goScreen('s-landing');
}

function openForgotPassword() { openModal('forgotModal'); }

async function sendForgotEmail() {
  const email = document.getElementById('forgot-email').value.trim();
  if(!email) return;
  const btn = document.getElementById('forgotBtn');
  btn.disabled=true; btn.textContent='Sending...';
  const{error}=await sb.auth.resetPasswordForEmail(email,{redirectTo:window.location.origin+window.location.pathname});
  btn.disabled=false; btn.textContent='📧 Send Reset Link';
  const msg = document.getElementById('forgot-msg');
  msg.style.display='block';
  if(error){msg.style.color='var(--red)';msg.textContent=error.message;}
  else{msg.style.color='var(--g1)';msg.textContent='✅ Reset link sent! Check your email.';}
}

async function doResetPassword() {
  const pass = document.getElementById('reset-pass').value;
  const pass2 = document.getElementById('reset-pass2').value;
  const errEl = document.getElementById('reset-err');
  const sucEl = document.getElementById('reset-success');
  if(pass.length<6){errEl.textContent='Min 6 characters';errEl.classList.add('show');return;}
  if(pass!==pass2){errEl.textContent='Passwords do not match';errEl.classList.add('show');return;}
  const{error}=await sb.auth.updateUser({password:pass});
  if(error){errEl.textContent=error.message;errEl.classList.add('show');}
  else{sucEl.textContent='✅ Password updated! Login karo.';sucEl.classList.add('show');errEl.classList.remove('show');setTimeout(()=>goScreen('s-landing'),2000);}
}

// SUBSCRIPTION
function selectPayMethod(m) {
  ['wa','199','upi','card'].forEach(id=>{
    const el=document.getElementById('pm-'+id);
    if(el) el.classList.toggle('selected', id===m);
  });
}

function copyUPI() {
  navigator.clipboard.writeText('9987961609@paytm').then(()=>showToast('UPI copied! ✅'));
}

async function upiPaid() {
  showToast('✅ Request noted! Admin 24hrs mein activate karega. WhatsApp: +91 9987961609');
  if(CU) {
    await sb.from('profiles').update({plan:'pending_activation'}).eq('id',CU.id);
  }
}

function processCard() {
  const num=document.getElementById('cardNum').value.replace(/\s/g,'');
  const exp=document.getElementById('cardExp').value;
  const cvv=document.getElementById('cardCvv').value;
  if(num.length<16||!exp||cvv.length<3){showToast('❌ Card details incomplete');return;}
  showToast('💳 Card payment - contact support for activation');
}

function fmtCard(el) {
  let v=el.value.replace(/\D/g,'').substring(0,16);
  el.value=v.replace(/(\d{4})/g,'$1 ').trim();
}

function fmtExp(el) {
  let v=el.value.replace(/\D/g,'');
  if(v.length>=2) v=v.substring(0,2)+'/'+v.substring(2,4);
  el.value=v;
}

// TRADE MODAL
let editTradeId2=null;
function openTradeModal(id=null) {
  editTradeId2=id;
  document.getElementById('tradeModalTitle').textContent=id?'✏️ Edit Trade':'⚔️ Log New Trade';
  if(!id) resetTradeForm();
  else loadTradeForEdit(id);
  buildExecChecklist();
  buildEmoRow();
  openModal('tradeModal');
  document.getElementById('t-date').value=new Date().toISOString().split('T')[0];
}

function resetTradeForm() {
  ['t-date','t-symbol','t-setup','t-side','t-session','t-entry','t-exit','t-sl','t-target','t-qty','t-inst','t-notes','t-execNotes','t-psychNotes','t-lesson'].forEach(id=>{
    const el=document.getElementById(id);if(el){if(el.tagName==='SELECT')el.selectedIndex=0;else el.value='';}
  });
  ['r-conf','r-focus','r-pat','r-calm'].forEach(id=>{const el=document.getElementById(id);if(el){el.value=5;updateRange(id.replace('r-',''));}});
  selectedEmo='';
  document.querySelectorAll('.emo-chip').forEach(c=>c.classList.remove('selected'));
  document.querySelectorAll('.chk-item').forEach(c=>c.classList.remove('checked'));
  document.getElementById('pnlPreview').textContent='₹0';
  document.getElementById('discPreview').textContent='0%';
  document.getElementById('execScore').textContent='0';
  editTradeId=null;
}

function loadTradeForEdit(id) {
  const t=CUD.trades.find(x=>x.id===id);
  if(!t) return;
  const set=(i,v)=>{const el=document.getElementById(i);if(el)el.value=v||'';};
  set('t-date',t.date);set('t-symbol',t.symbol);set('t-setup',t.setup);set('t-side',t.side);set('t-session',t.session);
  set('t-entry',t.entry);set('t-exit',t.exit);set('t-sl',t.sl);set('t-target',t.target);set('t-qty',t.qty);
  set('t-inst',t.inst);set('t-notes',t.notes);set('t-execNotes',t.execNotes);set('t-psychNotes',t.psychNotes);set('t-lesson',t.lesson);
  ['conf','focus','pat','calm'].forEach(k=>{const el=document.getElementById('r-'+k);if(el){el.value=t[k]||5;updateRange(k);}});
  selectedEmo=t.emotion||'';
  setTimeout(()=>{document.querySelectorAll('.emo-chip').forEach(c=>{if(c.textContent===selectedEmo)c.classList.add('selected');});},100);
  updatePNLPreview();
}

function buildExecChecklist() {
  const container=document.getElementById('execChecklist');
  container.innerHTML=CHECKS.map(c=>`<div class="chk-item" onclick="toggleCheck(this,'${c.id}')"><div class="chk-box">□</div><span>${c.label}</span><span class="chk-cat">${c.cat}</span></div>`).join('');
}

function buildEmoRow() {
  const container=document.getElementById('emoRow');
  container.innerHTML=EMOTIONS.map(e=>`<div class="emo-chip ${e.cls}" onclick="selectEmo(this,'${e.label}')">${e.label}</div>`).join('');
}

function toggleCheck(el, id) {
  el.classList.toggle('checked');
  el.querySelector('.chk-box').textContent=el.classList.contains('checked')?'✓':'□';
  updateDiscPreview();
}

function updateDiscPreview() {
  const checked=document.querySelectorAll('.chk-item.checked').length;
  const pct=Math.round(checked/11*100);
  document.getElementById('execScore').textContent=checked;
  document.getElementById('discPreview').textContent=pct+'%';
}

function selectEmo(el, emo) {
  document.querySelectorAll('.emo-chip').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  selectedEmo=emo;
}

function switchTradeTab(tab, el) {
  ['basic','exec','psych'].forEach(t=>{const el2=document.getElementById('tt-'+t);if(el2)el2.style.display=t===tab?'':'none';});
  document.querySelectorAll('.tab-bar .tab').forEach(t=>t.classList.remove('active'));
  if(el) el.classList.add('active');
}

function updatePNLPreview() {
  const entry=parseFloat(document.getElementById('t-entry').value)||0;
  const exit=parseFloat(document.getElementById('t-exit').value)||0;
  const qty=parseFloat(document.getElementById('t-qty').value)||0;
  const side=document.getElementById('t-side').value||'LONG';
  const pnl=Math.round((side==='LONG'?exit-entry:entry-exit)*qty);
  const el=document.getElementById('pnlPreview');
  el.textContent='₹'+pnl.toLocaleString('en-IN');
  el.style.color=pnl>=0?'var(--g1)':'var(--red)';
}

function updateRange(key) {
  const v=document.getElementById('r-'+key).value;
  const sc=document.getElementById('sc-'+key);
  if(sc) sc.textContent=v;
}

async function saveTrade() {
  const date=document.getElementById('t-date').value;
  const symbol=document.getElementById('t-symbol').value.trim().toUpperCase();
  const entry=parseFloat(document.getElementById('t-entry').value);
  const exit=parseFloat(document.getElementById('t-exit').value);
  const qty=parseFloat(document.getElementById('t-qty').value);
  if(!date||!symbol||!entry||!exit||!qty) { showToast('❌ Required fields fill karo'); return; }
  if(!selectedEmo) { showToast('❌ Emotion select karo'); return; }
  const checked=Array.from(document.querySelectorAll('.chk-item.checked')).map(el=>el.dataset.id||el.textContent.trim().substring(0,20));
  if(document.querySelectorAll('.chk-item.checked').length<6) { showToast('❌ Min 6 execution checks required'); return; }
  const side=document.getElementById('t-side').value||'LONG';
  const pnl=Math.round((side==='LONG'?exit-entry:entry-exit)*qty);
  const discScore=Math.round(document.querySelectorAll('.chk-item.checked').length/11*100);
  const trade={date,symbol,setup:document.getElementById('t-setup').value,side,entry,exit,qty,sl:parseFloat(document.getElementById('t-sl').value)||0,target:parseFloat(document.getElementById('t-target').value)||0,pnl,session:document.getElementById('t-session').value,inst:document.getElementById('t-inst').value,notes:document.getElementById('t-notes').value,discScore,violated:[],execNotes:document.getElementById('t-execNotes').value,confidence:parseInt(document.getElementById('r-conf').value),focus:parseInt(document.getElementById('r-focus').value),patience:parseInt(document.getElementById('r-pat').value),calm:parseInt(document.getElementById('r-calm').value),emotion:selectedEmo,psychNotes:document.getElementById('t-psychNotes').value,lesson:document.getElementById('t-lesson').value};
  const btn=document.querySelector('.modal-ft .btn-p');
  if(btn){btn.disabled=true;btn.textContent='Saving...';}
  if(editTradeId2) {
    const{error}=await sb.from('trades').update(tradeToDb(CU.id,trade)).eq('id',editTradeId2);
    if(!error){CUD.trades=CUD.trades.map(t=>t.id===editTradeId2?{...trade,id:editTradeId2}:t);}
  } else {
    const{data,error}=await sb.from('trades').insert(tradeToDb(CU.id,trade)).select().single();
    if(!error&&data){CUD.trades.unshift(dbToTrade(data));}
  }
  if(btn){btn.disabled=false;btn.textContent='🐺 Save Trade';}
  closeModal('tradeModal');
  renderDashboard();
  renderTradeList();
  renderWolfEvolution();
  updateSidebar();
  showToast('✅ Trade saved! The wolf hunts again.');
  renderWolfInsights();
}

async function deleteTrade(id) {
  if(!confirm('Delete this trade?')) return;
  await sb.from('trades').delete().eq('id',id);
  CUD.trades=CUD.trades.filter(t=>t.id!==id);
  renderDashboard();
  renderTradeList();
  renderWolfEvolution();
  updateSidebar();
  showToast('Trade deleted');
}

// SIDEBAR
function updateSidebar() {
  if(!CU||!CUD) return;
  const avg=CUD.trades.length?Math.round(CUD.trades.reduce((a,t)=>a+t.discScore,0)/CUD.trades.length):0;
  const stage=getWolfStage(avg);
  document.getElementById('sbWolfEmoji').textContent=stage.emoji;
  document.getElementById('sbWolfRank').textContent=stage.rank;
  document.getElementById('sbWolfFill').style.width=avg+'%';
  document.getElementById('sbWolfPct').textContent=avg+'% discipline';
  const name=CU.full_name||'Wolf Trader';
  document.getElementById('sbWolfName')||null;
  const sbNameEl=document.querySelector('.sb-wolf-name');if(sbNameEl)sbNameEl.textContent=name;
  const sbAv=document.getElementById('sbAvatar');if(sbAv)sbAv.textContent=name[0].toUpperCase();
  const sbName=document.getElementById('sbName');if(sbName)sbName.textContent=name;
  const ddN=document.getElementById('ddName');if(ddN)ddN.textContent=name;
  const ddE=document.getElementById('ddEmail');if(ddE)ddE.textContent=CU.email||'';
}

// DASHBOARD
function renderDashboard() {
  if(!CUD) return;
  const trades=CUD.trades;
  const totalPnl=trades.reduce((a,t)=>a+t.pnl,0);
  const wins=trades.filter(t=>t.pnl>0);
  const wr=trades.length?Math.round(wins.length/trades.length*100):0;
  const avgDisc=trades.length?Math.round(trades.reduce((a,t)=>a+t.discScore,0)/trades.length):0;
  const month=new Date().toISOString().substring(0,7);
  const monthTrades=trades.filter(t=>t.date&&t.date.startsWith(month));
  const pnlEl=document.getElementById('db-pnl');
  if(pnlEl){pnlEl.textContent=(totalPnl>=0?'':'−')+'₹'+Math.abs(totalPnl).toLocaleString('en-IN');pnlEl.style.color=totalPnl>=0?'var(--g1)':'var(--red)';}
  const wrEl=document.getElementById('db-wr');if(wrEl)wrEl.textContent=wr+'%';
  const wsEl=document.getElementById('db-wr-sub');if(wsEl)wsEl.textContent=trades.length+' trades';
  const dEl=document.getElementById('db-disc');if(dEl)dEl.textContent=avgDisc+'%';
  const mEl=document.getElementById('db-month');if(mEl)mEl.textContent=monthTrades.length;
  renderRecentTrades();
  renderPerformance();
  renderEquityChart();
  renderHeatmap();
}

function renderRecentTrades() {
  const tbody=document.getElementById('recentTrades');
  if(!tbody||!CUD) return;
  const recent=CUD.trades.slice(0,8);
  tbody.innerHTML=recent.map(t=>`<tr><td class="bold">${t.symbol}</td><td>${t.date}</td><td style="color:${t.pnl>=0?'var(--g1)':'var(--red)'};font-weight:700;">${t.pnl>=0?'+':''}₹${Math.abs(t.pnl).toLocaleString('en-IN')}</td><td>${t.discScore}%</td><td><span class="badge ${t.pnl>=0?'badge-g':'badge-r'}">${t.pnl>=0?'WIN':'LOSS'}</span></td></tr>`).join('')||'<tr><td colspan="5" style="text-align:center;color:var(--muted);padding:20px;">No trades yet. Begin the hunt!</td></tr>';
}

function renderPerformance() {
  if(!CUD) return;
  const trades=CUD.trades;
  const wins=trades.filter(t=>t.pnl>0);
  const losses=trades.filter(t=>t.pnl<0);
  const totalWin=wins.reduce((a,t)=>a+t.pnl,0);
  const totalLoss=Math.abs(losses.reduce((a,t)=>a+t.pnl,0));
  const pf=totalLoss?Math.round(totalWin/totalLoss*100)/100:0;
  const avgWin=wins.length?Math.round(totalWin/wins.length):0;
  const avgLoss=losses.length?Math.round(totalLoss/losses.length):0;
  const best=trades.length?Math.max(...trades.map(t=>t.pnl)):0;
  const worst=trades.length?Math.min(...trades.map(t=>t.pnl)):0;
  const set=(id,val,color)=>{const el=document.getElementById(id);if(el){el.textContent=val;if(color)el.style.color=color;}};
  set('perf-pf',pf||'—');
  set('perf-aw',wins.length?'₹'+avgWin.toLocaleString('en-IN'):'—','var(--g1)');
  set('perf-al',losses.length?'₹'+avgLoss.toLocaleString('en-IN'):'—','var(--red)');
  set('perf-bt',trades.length?(best>=0?'+':'')+'₹'+Math.abs(best).toLocaleString('en-IN'):'—','var(--g1)');
  set('perf-wt',trades.length?'₹'+Math.abs(worst).toLocaleString('en-IN'):'—','var(--red)');
}

function renderEquityChart() {
  const canvas=document.getElementById('eqChart');
  if(!canvas||!CUD) return;
  const trades=[...CUD.trades].reverse();
  if(!trades.length){canvas.getContext('2d').clearRect(0,0,canvas.width,canvas.height);return;}
  let cum=0;const points=trades.map(t=>{cum+=t.pnl;return cum;});
  const ctx=canvas.getContext('2d');
  canvas.width=canvas.offsetWidth||400;
  const w=canvas.width,h=canvas.height||150;
  ctx.clearRect(0,0,w,h);
  const min=Math.min(0,...points),max=Math.max(0,...points);
  const range=max-min||1;
  const toY=v=>h-((v-min)/range*(h-20))-10;
  const step=w/(points.length-1||1);
  ctx.beginPath();
  ctx.strokeStyle='rgba(0,232,122,0.8)';
  ctx.lineWidth=2;
  points.forEach((p,i)=>{if(i===0)ctx.moveTo(0,toY(p));else ctx.lineTo(i*step,toY(p));});
  ctx.stroke();
  ctx.lineTo((points.length-1)*step,h);ctx.lineTo(0,h);ctx.closePath();
  ctx.fillStyle='rgba(0,232,122,0.08)';ctx.fill();
}

function renderHeatmap() {
  const grid=document.getElementById('hmGrid');
  if(!grid||!CUD) return;
  const dateMap={};
  CUD.trades.forEach(t=>{if(!dateMap[t.date])dateMap[t.date]=0;dateMap[t.date]+=t.pnl;});
  const days=[];
  for(let i=41;i>=0;i--){const d=new Date();d.setDate(d.getDate()-i);days.push(d.toISOString().split('T')[0]);}
  grid.innerHTML=days.map(d=>{
    const pnl=dateMap[d];
    let cls='';
    if(pnl!=null){if(pnl>5000)cls='l4';else if(pnl>2000)cls='l3';else if(pnl>0)cls='l2';else if(pnl>-2000)cls='n1';else cls='n2';}
    return `<div class="hm-c ${cls}" title="${d}: ${pnl!=null?'₹'+pnl:'No trades'}"></div>`;
  }).join('');
}

// WOLF EVOLUTION
function renderWolfEvolution() {
  if(!CUD) return;
  const trades=CUD.trades;
  const avg=trades.length?Math.round(trades.reduce((a,t)=>a+t.discScore,0)/trades.length):0;
  const stage=getWolfStage(avg);
  const nextStage=WOLF_STAGES.find(s=>s.min>avg);
  const d=(id,val)=>{const el=document.getElementById(id);if(el)el.textContent=val;};
  const s=(id,val)=>{const el=document.getElementById(id);if(el)el.style=val;};
  d('wd-rank','RANK · '+stage.rank);
  d('wd-title',stage.title);
  d('wd-sub',stage.sub);
  d('wd-pct',avg+'%');
  d('wolfBigEmoji',stage.emoji);
  const bar=document.getElementById('wdBar');if(bar)bar.style.width=avg+'%';
  // Streak
  let streak=0,best=0,curr=0;
  const sorted=[...trades].sort((a,b)=>a.date>b.date?1:-1);
  let prev='';
  sorted.forEach(t=>{
    if(t.discScore>=70){
      if(prev&&diffDays(prev,t.date)<=1)curr++;else curr=1;
      if(curr>best)best=curr;
    } else curr=0;
    prev=t.date;
  });
  streak=curr;
  d('streakNum',streak);d('bestStreakNum',best);
  d('dd-disc',avg+'%');d('dd-total',trades.length);d('dd-next',nextStage?(nextStage.min-avg)+'% to go':'MAX');
  renderWolfInsights();
  renderStagesRow(stage);
  renderChecklist();
  renderViolations();
}

function diffDays(a,b){return Math.abs((new Date(b)-new Date(a))/(1000*60*60*24));}

function renderStagesRow(current) {
  const container=document.getElementById('wolfStagesRow');
  if(!container) return;
  container.innerHTML=WOLF_STAGES.map(s=>{
    const cls=s.min<current.min?'wsp-done':s.name===current.name?'wsp-current':'wsp-next';
    return `<div class="wolf-stage-pill ${cls}">${s.emoji} ${s.name}</div>`;
  }).join('');
}

function renderWolfInsights() {
  const container=document.getElementById('wolfInsights');
  if(!container||!CUD) return;
  const insights=generateWolfInsights(CUD.trades);
  if(!insights.length){container.innerHTML='<div class="empty"><div class="empty-ic">🐺</div><div class="empty-txt">Log more trades to unlock wolf insights</div></div>';return;}
  container.innerHTML=insights.map(i=>`<div class="insight-card"><span class="insight-icon">${i.ic}</span><span class="insight-text">${i.text}</span></div>`).join('');
}

function renderChecklist() {
  const container=document.getElementById('checkPerf');
  if(!container||!CUD) return;
  const trades=CUD.trades;
  if(!trades.length){container.innerHTML='<div class="empty"><div class="empty-ic">✅</div><div class="empty-txt">No checklist data yet</div></div>';return;}
  // Count total possible vs checked across all trades  
  const total=trades.length*11;
  const done=trades.reduce((a,t)=>a+(11-((t.violated||[]).length)),0);
  const pct=Math.round(done/total*100);
  container.innerHTML=`<div style="margin-bottom:10px;"><div class="prog-hd"><span style="font-size:13px;color:var(--text2);">Overall Execution</span><span style="font-size:13px;color:var(--g1);font-weight:700;">${pct}%</span></div><div class="prog-track"><div class="prog-fill" style="width:${pct}%;background:var(--g1);"></div></div></div>`;
}

function renderViolations() {
  const container=document.getElementById('violTracker');
  if(!container||!CUD) return;
  const trades=CUD.trades.slice(0,20);
  const violCount={};
  trades.forEach(t=>(t.violated||[]).forEach(v=>{violCount[v]=(violCount[v]||0)+1;}));
  const entries=Object.entries(violCount).sort((a,b)=>b[1]-a[1]).slice(0,5);
  if(!entries.length){container.innerHTML='<div class="viol good">✅ No patterns of violations found. Wolf code is strong.</div>';return;}
  container.innerHTML=entries.map(([v,c])=>`<div class="viol bad">⚠️ <strong>${v.substring(0,30)}</strong> — violated ${c}x</div>`).join('');
}

// ANALYTICS
function renderAnalytics() {
  if(!CUD) return;
  const trades=CUD.trades;
  const avg=t=>trades.length?Math.round(trades.reduce((a,t2)=>a+t2[t],0)/trades.length):0;
  const set=(id,v,s)=>{const el=document.getElementById(id);if(el){el.textContent=v;if(s)el.style.color=s;}};
  set('an-disc',avg('discScore')+'%','var(--g1)');
  const avgExec=trades.length?Math.round(trades.reduce((a,t)=>a+(11-((t.violated||[]).length))/11*100,0)/trades.length):0;
  set('an-exec',avgExec+'%','var(--blue)');
  set('an-focus',avg('focus'),'var(--amber)');
  ['conf','focus','pat','calm'].forEach(k=>{const v=trades.length?Math.round(trades.reduce((a,t)=>a+(t[k]||5),0)/trades.length):5;const el=document.getElementById('fc-'+k);if(el)el.textContent=v;});
  renderSetupPerf();
  renderSessionPerf();
  renderEmoPerf();
  renderDiscChart();
}

function renderSetupPerf() {
  const c=document.getElementById('setupPerf');
  if(!c||!CUD) return;
  const map={};
  CUD.trades.forEach(t=>{if(!t.setup)return;if(!map[t.setup])map[t.setup]={pnl:0,count:0,wins:0};map[t.setup].pnl+=t.pnl;map[t.setup].count++;if(t.pnl>0)map[t.setup].wins++;});
  const entries=Object.entries(map).sort((a,b)=>b[1].pnl-a[1].pnl);
  if(!entries.length){c.innerHTML='<div class="empty"><div class="empty-ic">📊</div><div class="empty-txt">Log trades with setups</div></div>';return;}
  c.innerHTML=entries.map(([setup,d])=>{
    const wr=Math.round(d.wins/d.count*100);
    const pnl=d.pnl;
    return `<div class="kv-row"><span class="kv-key">${setup}</span><span class="kv-val" style="color:${pnl>=0?'var(--g1)':'var(--red);'};">${wr}% WR · ${pnl>=0?'+':''}₹${Math.abs(pnl).toLocaleString('en-IN')}</span></div>`;
  }).join('');
}

function renderSessionPerf() {
  const c=document.getElementById('sessionPerf');
  if(!c||!CUD) return;
  const map={};
  CUD.trades.forEach(t=>{const s=t.session||'Unknown';if(!map[s])map[s]={pnl:0,count:0};map[s].pnl+=t.pnl;map[s].count++;});
  c.innerHTML=Object.entries(map).map(([s,d])=>`<div class="kv-row"><span class="kv-key">${s}</span><span class="kv-val" style="color:${d.pnl>=0?'var(--g1)':'var(--red);'};">${d.count} trades · ${d.pnl>=0?'+':''}₹${Math.abs(d.pnl).toLocaleString('en-IN')}</span></div>`).join('')||'<div class="empty"><div class="empty-ic">⏰</div><div class="empty-txt">Log trades with session info</div></div>';
}

function renderEmoPerf() {
  const c=document.getElementById('emoPerf');
  if(!c||!CUD) return;
  const map={};
  CUD.trades.forEach(t=>{if(!t.emotion)return;if(!map[t.emotion])map[t.emotion]={pnl:0,count:0};map[t.emotion].pnl+=t.pnl;map[t.emotion].count++;});
  c.innerHTML=Object.entries(map).sort((a,b)=>b[1].pnl-a[1].pnl).map(([e,d])=>`<div class="kv-row"><span class="kv-key">${e}</span><span class="kv-val" style="color:${d.pnl>=0?'var(--g1)':'var(--red);'};">${d.count}x · ${d.pnl>=0?'+':''}₹${Math.abs(d.pnl).toLocaleString('en-IN')}</span></div>`).join('')||'<div class="empty"><div class="empty-ic">🧠</div><div class="empty-txt">Log trades with emotions</div></div>';
}

function renderDiscChart() {
  const canvas=document.getElementById('discChart');
  if(!canvas||!CUD) return;
  const trades=[...CUD.trades].reverse().slice(-20);
  if(!trades.length) return;
  const ctx=canvas.getContext('2d');
  canvas.width=canvas.offsetWidth||400;
  const w=canvas.width,h=canvas.height||150;
  ctx.clearRect(0,0,w,h);
  const points=trades.map(t=>t.discScore);
  const step=w/(points.length-1||1);
  ctx.beginPath();
  ctx.strokeStyle='rgba(61,155,255,0.8)';
  ctx.lineWidth=2;
  points.forEach((p,i)=>{const x=i*step,y=h-p/100*(h-20)-10;if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y);});
  ctx.stroke();
}

// TRADE LIST
function renderTradeList() {
  const tbody=document.getElementById('tradesList');
  if(!tbody||!CUD) return;
  tbody.innerHTML=CUD.trades.map(t=>`
    <tr>
      <td>${t.date}</td>
      <td class="bold">${t.symbol}</td>
      <td>${t.setup||'—'}</td>
      <td><span class="badge ${t.side==='LONG'?'badge-g':'badge-r'}">${t.side}</span></td>
      <td class="bold">₹${t.entry}</td>
      <td class="bold">₹${t.exit}</td>
      <td>${t.qty}</td>
      <td style="color:${t.pnl>=0?'var(--g1)':'var(--red)'};font-weight:700;">${t.pnl>=0?'+':''}₹${Math.abs(t.pnl).toLocaleString('en-IN')}</td>
      <td>${t.discScore}%</td>
      <td>${t.emotion||'—'}</td>
      <td>
        <button class="btn btn-sm btn-s" onclick="openTradeModal('${t.id}')">✏️</button>
        <button class="btn btn-sm btn-red" onclick="deleteTrade('${t.id}')">🗑</button>
      </td>
    </tr>`).join('')||'<tr><td colspan="11" style="text-align:center;color:var(--muted);padding:30px;">No trades logged. Begin the hunt!</td></tr>';
}

// JOURNAL
let journalFilter='all', journalSearch='', journalView='cards', journalMoodFilter='all';
function renderJournal() {
  if(!CUD) return;
  const all=CUD.journals;
  const total=document.getElementById('j-total-count');if(total)total.textContent=all.length;
  const week=document.getElementById('j-this-week');
  if(week){const wd=new Date();wd.setDate(wd.getDate()-7);week.textContent=all.filter(j=>new Date(j.date)>=wd).length;}
  renderJournalCalendar();
  filterJournal();
  renderJournalStreak();
}

function renderJournalStreak() {
  if(!CUD) return;
  let streak=0,prev='';
  const sorted=[...CUD.journals].sort((a,b)=>a.date>b.date?1:-1);
  sorted.forEach(j=>{
    if(!prev||diffDays(prev,j.date)<=1)streak++;else streak=1;
    prev=j.date;
  });
  const el=document.getElementById('jStreakCount');if(el)el.textContent=streak;
}

function filterJournal() {
  if(!CUD) return;
  const search=(document.getElementById('journalSearch')||{}).value||'';
  let filtered=CUD.journals.filter(j=>{
    if(journalMoodFilter!=='all'&&!j.mood.includes(journalMoodFilter))return false;
    if(search&&!((j.title||'').toLowerCase().includes(search.toLowerCase())||(j.body||'').toLowerCase().includes(search.toLowerCase())))return false;
    return true;
  });
  const list=document.getElementById('journalList');
  const empty=document.getElementById('journalEmpty');
  if(!filtered.length){if(list)list.innerHTML='';if(empty)empty.style.display='';return;}
  if(empty)empty.style.display='none';
  if(list)list.innerHTML=filtered.map(j=>{
    const mood=j.mood||'🟢 Confident';
    const moodKey=mood.includes('Confident')?'confident':mood.includes('Calm')?'calm':mood.includes('Neutral')?'neutral':mood.includes('Anxious')?'anxious':'frustrated';
    return `<div class="jrnl-card-deep">
      <div class="jrnl-card-header">
        <div class="jrnl-mood-orb ${moodKey}">${mood.split(' ')[0]}</div>
        <div class="jrnl-header-info">
          <div class="jrnl-entry-title">${j.title||'Untitled Entry'}</div>
          <div class="jrnl-meta">
            <span class="jrnl-date">${j.date}</span>
            <span class="jrnl-mood-badge ${moodKey}">${mood}</span>
          </div>
        </div>
        <div class="jrnl-card-actions">
          <button class="btn btn-sm btn-red" onclick="deleteJournal('${j.id}')">🗑</button>
        </div>
      </div>
      <div class="jrnl-card-body">
        <div class="jrnl-body-text jrnl-body-clamped">${(j.body||'').substring(0,300)}</div>
      </div>
    </div>`;
  }).join('');
}

function filterByMood(mood, el) {
  journalMoodFilter=mood;
  document.querySelectorAll('.jmood-btn').forEach(b=>b.classList.remove('active'));
  if(el)el.classList.add('active');
  filterJournal();
}

function setJournalView(view, el) {
  journalView=view;
  document.querySelectorAll('.jview-btn').forEach(b=>b.classList.remove('active'));
  if(el)el.classList.add('active');
}

function renderJournalCalendar() {
  const grid=document.getElementById('jCalGrid');
  if(!grid||!CUD) return;
  const dateMap={};
  CUD.journals.forEach(j=>dateMap[j.date]=j.mood||'🟢 Confident');
  const days=[];
  const today=new Date();
  for(let i=48;i>=0;i--){const d=new Date(today);d.setDate(d.getDate()-i);days.push(d.toISOString().split('T')[0]);}
  grid.innerHTML=days.map(d=>{
    const mood=dateMap[d];
    const moodCls=mood?mood.includes('Confident')?'jc-confident':mood.includes('Calm')?'jc-calm':mood.includes('Neutral')?'jc-neutral':mood.includes('Anxious')?'jc-anxious':'jc-frustrated':'';
    const isToday=d===today.toISOString().split('T')[0];
    return `<div class="jcal-cell ${moodCls} ${moodCls?'clickable':''} ${isToday?'today':''}" title="${d}"></div>`;
  }).join('');
}

function openJournalModal(id=null) {
  document.getElementById('j-date').value=new Date().toISOString().split('T')[0];
  document.getElementById('jAiHint').style.display='none';
  refreshAffirmation();
  openModal('journalModal');
}

function switchJournalTab(tab, el) {
  ['reflect','trade','mindset','tomorrow'].forEach(t=>{const el2=document.getElementById('jt-'+t);if(el2)el2.style.display=t===tab?'':'none';});
  document.querySelectorAll('#journalModal .tab-bar .tab').forEach(t=>t.classList.remove('active'));
  if(el)el.classList.add('active');
}

function selectJournalMood(el) {
  document.querySelectorAll('.jms-option').forEach(o=>{o.style.background='var(--bg2)';o.style.borderColor='var(--border2)';o.querySelector('span:last-child').style.color='var(--muted)';});
  el.style.background='var(--g4)';el.style.borderColor='rgba(0,232,122,.4)';
  const mood=el.dataset.mood;
  document.getElementById('j-mood').value=mood;
  const sp=el.querySelector('span:last-child');if(sp)sp.style.color='var(--g1)';
}

function toggleJRC(el) {
  el.classList.toggle('checked');
  el.querySelector('.jrc-box').textContent=el.classList.contains('checked')?'✓':'□';
}

function toggleTrigger(el) {
  el.classList.toggle('selected');
}

function updateJEnergy() {
  const v=document.getElementById('j-energy').value;
  const el=document.getElementById('jEnergyVal');if(el)el.textContent=v;
}

function updateJournalCharCount() {
  const body=document.getElementById('j-body').value;
  const chars=document.getElementById('jCharCount');const words=document.getElementById('jWordCount');
  if(chars)chars.textContent=body.length;
  if(words)words.textContent=body.trim().split(/\s+/).filter(Boolean).length;
}

const AFFIRMATIONS=['The wolf who journals daily evolves fastest.','Discipline today. Freedom forever.','Your mindset is your edge. Sharpen it daily.','Every session is data. Collect it.','The alpha does not trade from fear — only from edge.','Breathe. Plan. Execute. Review. Repeat.'];
function refreshAffirmation() {
  const el=document.getElementById('jAffirmationText');
  if(el)el.textContent=AFFIRMATIONS[Math.floor(Math.random()*AFFIRMATIONS.length)];
}

async function saveJournal() {
  const date=document.getElementById('j-date').value;
  const mood=document.getElementById('j-mood').value;
  const title=document.getElementById('j-title').value;
  const body=document.getElementById('j-body').value;
  if(!date||(!body&&!title)){showToast('❌ Date and entry required');return;}
  const ext={marketCondition:document.getElementById('j-market')?.value,pnlFeel:document.getElementById('j-pnl-feel')?.value,bestTrade:document.getElementById('j-best-trade')?.value,worstTrade:document.getElementById('j-worst-trade')?.value,mentalLesson:document.getElementById('j-mental-lesson')?.value,gratitude:document.getElementById('j-gratitude')?.value,intention:document.getElementById('j-intention')?.value,energy:document.getElementById('j-energy')?.value};
  const fullBody=body+(Object.values(ext).some(Boolean)?'\n<!-- ext:'+JSON.stringify(ext)+' -->':'');
  const{data,error}=await sb.from('journals').insert({user_id:CU.id,date,mood,title,body:fullBody}).select().single();
  if(!error&&data){CUD.journals.unshift(parseJournal(data));renderJournal();}
  closeModal('journalModal');
  showToast('📓 Journal entry saved. The wolf reflects.');
}

async function deleteJournal(id) {
  if(!confirm('Delete this entry?'))return;
  await sb.from('journals').delete().eq('id',id);
  CUD.journals=CUD.journals.filter(j=>j.id!==id);
  renderJournal();
}

async function openAIJournalCoach() {
  const card=document.getElementById('jAiInsightsCard');
  const output=document.getElementById('jAiInsightsOutput');
  if(!card||!output) return;
  card.style.display='';
  output.innerHTML='<span class="ai-spinner"></span> Wolf AI is reading your journal...';
  const recent=CUD.journals.slice(0,10).map(j=>`${j.date} (${j.mood}): ${j.title} - ${(j.body||'').substring(0,200)}`).join('\n');
  try {
    const resp=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:1000,messages:[{role:'user',content:`You are Wolf AI, a trading psychology coach for Indian traders. Analyse these journal entries and give insights in Hinglish (mix of Hindi and English). Be direct, motivating, and specific. Focus on patterns, emotions, and actionable advice.\n\nRecent entries:\n${recent}\n\nGive 3-4 key insights.`}]})});
    const data=await resp.json();
    const text=data.content?.map(c=>c.text||'').join('')||'No response';
    output.innerHTML=text.replace(/\n/g,'<br>');
  } catch(e) {
    output.innerHTML='❌ AI unavailable. Check network.';
  }
}

async function getAIJournalHint() {
  const hint=document.getElementById('jAiHint');
  const hintText=document.getElementById('jAiHintText');
  if(!hint||!hintText) return;
  hint.style.display='';
  hintText.innerHTML='<span class="ai-spinner"></span> Wolf AI thinking...';
  const body=document.getElementById('j-body').value;
  try {
    const resp=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:300,messages:[{role:'user',content:`You are Wolf AI. A trader wrote this journal entry: "${body}". Give a short, powerful coaching response in Hinglish (2-3 sentences). Be direct and insightful.`}]})});
    const data=await resp.json();
    hintText.innerHTML='🐺 '+data.content?.map(c=>c.text||'').join('')||'Keep going, wolf.';
  } catch(e) {
    hintText.innerHTML='🐺 Keep reflecting. Every word is growth.';
  }
}

// RULES
function openRuleModal() { openModal('ruleModal'); }

async function saveRule() {
  const rule=document.getElementById('r-rule').value.trim();
  const cat=document.getElementById('r-cat').value;
  if(!rule) return showToast('❌ Rule likhein');
  const{data,error}=await sb.from('rules').insert({user_id:CU.id,rule,category:cat}).select().single();
  if(!error&&data){CUD.rules.push({id:data.id,rule,cat});renderRules();}
  closeModal('ruleModal');
  document.getElementById('r-rule').value='';
  showToast('📌 Rule added to Wolf Code');
}

function renderRules() {
  const container=document.getElementById('rulesList');
  if(!container||!CUD) return;
  container.innerHTML=CUD.rules.map(r=>`<div class="rule-card"><div style="font-size:16px;">📌</div><div style="flex:1;"><div style="font-weight:700;font-size:13px;color:var(--text);">${r.rule}</div><div style="font-size:10px;color:var(--muted);margin-top:2px;">${r.cat}</div></div><button class="btn btn-sm btn-red" onclick="deleteRule('${r.id}')">🗑</button></div>`).join('')||'<div class="empty" style="padding:40px"><div class="empty-ic">📌</div><div class="empty-txt">No rules yet. Define your wolf code.</div><button class="btn btn-p" style="margin-top:16px;" onclick="openRuleModal()">+ Add First Rule</button></div>';
}

async function deleteRule(id) {
  await sb.from('rules').delete().eq('id',id);
  CUD.rules=CUD.rules.filter(r=>r.id!==id);
  renderRules();
}

// AI REPORTS
async function generateAIReport() {
  if(!CUD||CUD.trades.length<3){showToast('❌ Min 3 trades required');return;}
  const btn=document.getElementById('genReportBtn');
  btn.disabled=true;btn.innerHTML='<span class="ai-spinner"></span> Analysing...';
  const output=document.getElementById('aiReportOutput');
  output.innerHTML='<span class="ai-spinner"></span> Wolf AI is analysing your trading patterns...';
  const tradeData=CUD.trades.slice(0,30).map(t=>`${t.date} | ${t.symbol} | ${t.side} | ${t.setup||'?'} | P&L: ₹${t.pnl} | Disc: ${t.discScore}% | Emotion: ${t.emotion||'?'}`).join('\n');
  const wins=CUD.trades.filter(t=>t.pnl>0).length;
  const wr=Math.round(wins/CUD.trades.length*100);
  const avgDisc=Math.round(CUD.trades.reduce((a,t)=>a+t.discScore,0)/CUD.trades.length);
  try {
    const resp=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:1000,messages:[{role:'user',content:`You are Wolf AI, a trading coach for Indian traders. Analyse this trade data and give insights in Hinglish.\n\nStats: Win Rate ${wr}%, Avg Discipline ${avgDisc}%\n\nRecent trades:\n${tradeData}\n\nProvide: 1) Pattern analysis 2) Emotional triggers 3) Specific action items 4) Wolf mindset coaching. Use HTML formatting with <h3> tags for sections.`}]})});
    const data=await resp.json();
    const text=data.content?.map(c=>c.text||'').join('')||'Analysis unavailable';
    output.innerHTML=text;
    const report={id:Date.now(),date:new Date().toISOString().split('T')[0],output:text};
    CUD.aiReports=(CUD.aiReports||[]).concat(report);
    renderReports();
  } catch(e) {
    output.innerHTML='❌ AI unavailable. Check API connection.';
  }
  btn.disabled=false;btn.innerHTML='⚡ Analyse';
}

function clearReports() {
  const output=document.getElementById('aiReportOutput');
  if(output)output.innerHTML='<div class="ai-empty"><div style="font-size:36px;margin-bottom:10px;">🤖</div><div style="font-size:13px;font-weight:700;color:var(--muted);">No analysis yet</div></div>';
}

function renderReports() {
  const container=document.getElementById('reportHistory');
  const count=document.getElementById('reportHistCount');
  const reports=CUD?.aiReports||[];
  if(count)count.textContent=reports.length+' reports';
  if(!container) return;
  container.innerHTML=reports.slice(-5).reverse().map(r=>`<div class="insight-card" style="margin-bottom:8px;"><span class="insight-icon">📊</span><span class="insight-text">${r.date} — Report saved</span></div>`).join('')||'<div class="empty"><div class="empty-ic">📊</div><div class="empty-txt">No reports yet</div></div>';
}

// RISK CALCULATOR
function renderRiskCalc() { calcRisk(); }

function calcRisk() {
  const capital=parseFloat(document.getElementById('rc-capital')?.value)||0;
  const riskPct=parseFloat(document.getElementById('rc-riskpct')?.value)||1;
  const entry=parseFloat(document.getElementById('rc-entry')?.value)||0;
  const sl=parseFloat(document.getElementById('rc-sl')?.value)||0;
  const target=parseFloat(document.getElementById('rc-target')?.value)||0;
  const lotSize=parseFloat(document.getElementById('rc-inst')?.value)||1;
  if(!capital||!entry||!sl){['rr-amount','rr-qty','rr-ratio','rr-profit','rr-loss','rr-verdict','rr-daily','rr-weekly','rr-recover'].forEach(id=>{const el=document.getElementById(id);if(el)el.textContent='—';});return;}
  const riskAmount=Math.round(capital*riskPct/100);
  const slPoints=Math.abs(entry-sl);
  const qty=slPoints?Math.floor(riskAmount/(slPoints*lotSize)):0;
  const rr=target&&sl?Math.round((Math.abs(target-entry)/Math.abs(entry-sl))*10)/10:0;
  const profit=target?Math.round(qty*(target-entry)*lotSize*(entry>sl?1:-1)):0;
  const loss=Math.round(qty*slPoints*lotSize);
  const verdict=rr>=2?'🟢 HUNT':rr>=1.5?'🟡 CONSIDER':'🔴 SKIP';
  const set=(id,v)=>{const el=document.getElementById(id);if(el)el.textContent=v;};
  set('rr-amount','₹'+riskAmount.toLocaleString('en-IN'));
  set('rr-qty',qty);
  set('rr-ratio',rr||'—');
  set('rr-profit',profit?'₹'+profit.toLocaleString('en-IN'):'—');
  set('rr-loss','₹'+loss.toLocaleString('en-IN'));
  set('rr-verdict',rr>=2?'🟢 HUNT':rr>=1.5?'🟡 CONSIDER':'🔴 SKIP');
  set('rr-daily','₹'+Math.round(capital*2/100).toLocaleString('en-IN'));
  set('rr-weekly','₹'+Math.round(capital*5/100).toLocaleString('en-IN'));
  set('rr-recover',loss?Math.ceil(loss/riskAmount)+' trades':'—');
}

// PRE-TRADE
function renderPreTrade() {
  const container=document.getElementById('setupWinRates');
  if(!container||!CUD) return;
  const map={};
  CUD.trades.forEach(t=>{if(!t.setup)return;if(!map[t.setup])map[t.setup]={count:0,wins:0};map[t.setup].count++;if(t.pnl>0)map[t.setup].wins++;});
  container.innerHTML=Object.entries(map).map(([s,d])=>`<div class="kv-row"><span class="kv-key">${s}</span><span class="kv-val">${Math.round(d.wins/d.count*100)}% WR (${d.count} trades)</span></div>`).join('')||'<div class="empty"><div class="empty-ic">📈</div><div class="empty-txt">Log trades with setup types to see win rates</div></div>';
}

async function runPreTradeAI() {
  const symbol=document.getElementById('pt-symbol').value||'Unknown';
  const setup=document.getElementById('pt-setup').value;
  const entry=document.getElementById('pt-entry').value;
  const sl=document.getElementById('pt-sl').value;
  const target=document.getElementById('pt-target').value;
  const emotion=document.getElementById('pt-emotion').value;
  const market=document.getElementById('pt-market').value;
  const result=document.getElementById('preTradeResult');
  result.style.display='';
  result.innerHTML='<div style="padding:12px;text-align:center;"><span class="ai-spinner"></span> Wolf AI analysing...</div>';
  const history=CUD.trades.filter(t=>t.setup===setup).slice(0,10);
  const wr=history.length?Math.round(history.filter(t=>t.pnl>0).length/history.length*100):50;
  try {
    const resp=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:400,messages:[{role:'user',content:`You are Wolf AI pre-trade coach. Analyse this trade setup for an Indian trader. Respond in Hinglish.\n\nSetup: ${symbol} ${setup}\nEntry: ${entry}, SL: ${sl}, Target: ${target}\nEmotion: ${emotion}, Market: ${market}\nHistory: ${wr}% win rate on ${setup} setups (${history.length} trades)\n\nGive: GO/WAIT/NO verdict with brief 2-3 line reasoning. Start with verdict in caps.`}]})});
    const data=await resp.json();
    const text=data.content?.map(c=>c.text||'').join('')||'No verdict';
    const cls=text.startsWith('GO')?'pretrade-go':text.startsWith('NO')?'pretrade-no':'pretrade-wait';
    result.innerHTML=`<div class="pretrade-verdict ${cls}">${text.replace(/\n/g,'<br>')}</div>`;
  } catch(e) {
    const rr=target&&sl&&entry?Math.round(Math.abs(target-entry)/Math.abs(entry-sl)*10)/10:0;
    const auto=emotion.includes('FOMO')||emotion.includes('Revenge')?'pretrade-no':rr>=2?'pretrade-go':'pretrade-wait';
    result.innerHTML=`<div class="pretrade-verdict ${auto}">${auto==='pretrade-go'?'✅ GO — Setup looks valid':'⚠️ WAIT — '+(emotion.includes('FOMO')?'FOMO detected. Wolf hunts from edge, not fear.':'R:R below minimum. Wait for better setup.')}</div>`;
  }
}

function clearPreTrade() {
  ['pt-symbol','pt-entry','pt-sl','pt-target'].forEach(id=>{const el=document.getElementById(id);if(el)el.value='';});
  const r=document.getElementById('preTradeResult');if(r)r.style.display='none';
}

// CHALLENGES
function renderChallenges() {
  if(!CUD) return;
  const container=document.getElementById('challengeList');
  const dateEl=document.getElementById('challengeDate');
  if(dateEl)dateEl.textContent=new Date().toLocaleDateString('en-IN');
  if(!container) return;
  const totalXP=CUD.journals.length*30+CUD.trades.length*50+CUD.rules.length*40;
  const xpEl=document.getElementById('xpDisplay');if(xpEl)xpEl.textContent=totalXP+' XP';
  const xpBar=document.getElementById('xpBar');if(xpBar)xpBar.style.width=Math.min(totalXP/1000*100,100)+'%';
  container.innerHTML=DAILY_CHALLENGES.map(c=>{
    const done=c.check(CUD);
    return `<div class="challenge-card ${done?'done':''}">
      <div class="challenge-ic">${c.ic}</div>
      <div class="challenge-info"><div class="challenge-title">${c.title}</div><div class="challenge-sub">${c.sub}</div></div>
      <div class="challenge-xp">+${c.xp} XP</div>
      ${done?'<div class="challenge-done-ic">✅</div>':''}
    </div>`;
  }).join('');
}

// SETTINGS
function renderSettings() {
  if(!CU||!CUD) return;
  const d=(id,val)=>{const el=document.getElementById(id);if(el)el.textContent=val;};
  d('set-name',CU.full_name||'Wolf');
  d('set-email',CU.email||'');
  d('set-trades',CUD.trades.length);
  const wr=CUD.trades.length?Math.round(CUD.trades.filter(t=>t.pnl>0).length/CUD.trades.length*100):0;
  d('set-wr',wr+'%');
  const pnl=CUD.trades.reduce((a,t)=>a+t.pnl,0);
  d('set-pnl',(pnl>=0?'+':'')+'₹'+Math.abs(pnl).toLocaleString('en-IN'));
  d('set-reports',(CUD.aiReports||[]).length);
  const avg=CUD.trades.length?Math.round(CUD.trades.reduce((a,t)=>a+t.discScore,0)/CUD.trades.length):0;
  const stage=getWolfStage(avg);
  d('set-rank',stage.rank+' '+stage.emoji);
}

async function clearAllTrades() {
  if(!confirm('ALL trades delete ho jayenge. Sure?')) return;
  await sb.from('trades').delete().eq('user_id',CU.id);
  CUD.trades=[];
  renderDashboard();renderTradeList();renderWolfEvolution();renderAnalytics();
  showToast('🗑 All trades cleared');
}

function renderLeaderboard() {} // Placeholder

// WOLF QUOTE
function renderWolfQuote() {
  const q=WOLF_QUOTES[Math.floor(Math.random()*WOLF_QUOTES.length)];
  const el=document.getElementById('wolfQuote');if(el)el.textContent=q;
  const jel=document.getElementById('journalWolfQuote');if(jel)jel.textContent=q;
}

// PWA
let deferredPrompt;
window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();deferredPrompt=e;showPWABanner();});
function showPWABanner(){if(deferredPrompt){const b=document.getElementById('pwaBanner');if(b)b.classList.remove('hidden');}}
function installPWA(){if(deferredPrompt){deferredPrompt.prompt();deferredPrompt.userChoice.then(()=>{deferredPrompt=null;dismissPWA();});}}
function dismissPWA(){const b=document.getElementById('pwaBanner');if(b)b.classList.add('hidden');}

// VOICE ENTRY (basic)
function startVoiceEntry() {
  const btn=document.getElementById('voiceEntryBtn');
  if(!('webkitSpeechRecognition' in window)){showToast('❌ Voice not supported in this browser');return;}
  const rec=new webkitSpeechRecognition();
  rec.lang='hi-IN';rec.interimResults=false;
  btn.classList.add('listening');btn.textContent='🎤 Listening... (speak now)';
  rec.start();
  rec.onresult=e=>{
    const text=e.results[0][0].transcript;
    const notes=document.getElementById('t-notes');if(notes)notes.value+=text+' ';
    btn.classList.remove('listening');btn.textContent='🎤 Voice Entry — बोलूनस trade log करा (Beta)';
  };
  rec.onerror=()=>{btn.classList.remove('listening');btn.textContent='🎤 Voice Entry — बोलूनस trade log करा (Beta)';};
}

// Service Worker (PWA)
if('serviceWorker' in navigator) {
  window.addEventListener('load',()=>navigator.serviceWorker.register('/sw.js').catch(()=>{}));
}
</script>
</body>
</html>